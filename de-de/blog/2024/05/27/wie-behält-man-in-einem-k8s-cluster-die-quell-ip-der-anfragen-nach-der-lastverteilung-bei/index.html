<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=de-de class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei? | jqknono Blogs</title><meta name=description content="Einleitung Anwendungsdeployments sind nicht immer einfach nur Installieren und Ausführen, manchmal muss man auch Netzwerk-Probleme berücksichtigen. Dieser Artikel erklärt, wie man in einem K8s-Cluster dafür sorgt, dass Dienste die Quell-IP der Anfrage erhalten können.
Anwendungen, die Dienste bereitstellen, basieren in der Regel auf Eingabeinformationen. Wenn diese Eingabeinformationen nicht auf der fünfzeiligen Gruppe (Quell-IP, Quellport, Ziel-IP, Zielport, Protokoll) angewiesen sind, hat der Dienst eine geringe Netzwerkkopplung und muss sich nicht um Netzwerkdetails kümmern."><meta property="og:url" content="https://blog.jqknono.com/de-de/blog/2024/05/27/wie-beh%C3%A4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei/"><meta property="og:site_name" content="jqknono Blogs"><meta property="og:title" content="Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?"><meta property="og:description" content="Einleitung Anwendungsdeployments sind nicht immer einfach nur Installieren und Ausführen, manchmal muss man auch Netzwerk-Probleme berücksichtigen. Dieser Artikel erklärt, wie man in einem K8s-Cluster dafür sorgt, dass Dienste die Quell-IP der Anfrage erhalten können.
Anwendungen, die Dienste bereitstellen, basieren in der Regel auf Eingabeinformationen. Wenn diese Eingabeinformationen nicht auf der fünfzeiligen Gruppe (Quell-IP, Quellport, Ziel-IP, Zielport, Protokoll) angewiesen sind, hat der Dienst eine geringe Netzwerkkopplung und muss sich nicht um Netzwerkdetails kümmern."><meta property="og:locale" content="de_de"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-05-27T11:52:22+08:00"><meta property="article:modified_time" content="2024-05-27T11:52:22+08:00"><meta property="article:tag" content="Netzwerk"><meta property="article:tag" content="Blog"><meta itemprop=name content="Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?"><meta itemprop=description content="Einleitung Anwendungsdeployments sind nicht immer einfach nur Installieren und Ausführen, manchmal muss man auch Netzwerk-Probleme berücksichtigen. Dieser Artikel erklärt, wie man in einem K8s-Cluster dafür sorgt, dass Dienste die Quell-IP der Anfrage erhalten können.
Anwendungen, die Dienste bereitstellen, basieren in der Regel auf Eingabeinformationen. Wenn diese Eingabeinformationen nicht auf der fünfzeiligen Gruppe (Quell-IP, Quellport, Ziel-IP, Zielport, Protokoll) angewiesen sind, hat der Dienst eine geringe Netzwerkkopplung und muss sich nicht um Netzwerkdetails kümmern."><meta itemprop=datePublished content="2024-05-27T11:52:22+08:00"><meta itemprop=dateModified content="2024-05-27T11:52:22+08:00"><meta itemprop=wordCount content="1382"><meta itemprop=keywords content="Netzwerk,Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?"><meta name=twitter:description content="Einleitung Anwendungsdeployments sind nicht immer einfach nur Installieren und Ausführen, manchmal muss man auch Netzwerk-Probleme berücksichtigen. Dieser Artikel erklärt, wie man in einem K8s-Cluster dafür sorgt, dass Dienste die Quell-IP der Anfrage erhalten können.
Anwendungen, die Dienste bereitstellen, basieren in der Regel auf Eingabeinformationen. Wenn diese Eingabeinformationen nicht auf der fünfzeiligen Gruppe (Quell-IP, Quellport, Ziel-IP, Zielport, Protokoll) angewiesen sind, hat der Dienst eine geringe Netzwerkkopplung und muss sich nicht um Netzwerkdetails kümmern."><link rel=preload href=/scss/main.min.19deb9bb49a16bab1391617801cf2d75f58ded83cae46516f211ba8fc3e9f6f9.css as=style integrity="sha256-Gd65u0mha6sTkWF4Ac8tdfWN7YPK5GUW8hG6j8Pp9vk=" crossorigin=anonymous><link href=/scss/main.min.19deb9bb49a16bab1391617801cf2d75f58ded83cae46516f211ba8fc3e9f6f9.css rel=stylesheet integrity="sha256-Gd65u0mha6sTkWF4Ac8tdfWN7YPK5GUW8hG6j8Pp9vk=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F3FFTG72NE"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F3FFTG72NE")}</script></head><body class="td-page td-blog"><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/de-de/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>jqknono Blogs</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://jqknono.com target=_blank rel=noopener><span>About</span><sup><i class="ps-1 fa-solid fa-up-right-from-square fa-xs" aria-hidden=true></i></sup></a></li><li class=nav-item><a class=nav-link href=https://github.com/jqknono target=_blank rel=noopener><i class="fab fa-github" aria-hidden=true></i><span>GitHub</span><sup><i class="ps-1 fa-solid fa-up-right-from-square fa-xs" aria-hidden=true></i></sup></a></li><li class="nav-item td-navbar__lang-menu"><div class="td-lang-menu dropdown"><a class="nav-link dropdown-toggle td-lang-menu__title" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><span class=td-lang-menu__title-text>Deutsch</span>
<span class=td-lang-menu__title-code>DE-DE</span></a><ul class=dropdown-menu><li><a class=dropdown-item href=/blog/2024/05/27/how-to-preserve-the-source-ip-of-requests-after-load-balancing-in-a-k8s-cluster/>English</a></li><li><a class=dropdown-item href=/zh-tw/blog/2024/05/27/k8s%E5%8F%A2%E9%9B%86%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BF%9D%E7%95%99%E8%B2%A0%E8%BC%89%E5%9D%87%E8%A1%A1%E5%BE%8C%E7%9A%84%E8%AB%8B%E6%B1%82%E6%BA%90ip/>繁體中文</a></li><li><a class=dropdown-item href=/ja-jp/blog/1/01/01/>日本語</a></li><li><a class=dropdown-item href=/ko-kr/blog/2024/05/27/k8s-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0%EC%97%90%EC%84%9C-%EB%A1%9C%EB%93%9C-%EB%B0%B8%EB%9F%B0%EC%8B%B1-%ED%9B%84-%EC%9A%94%EC%B2%AD-%EC%9B%90%EB%B3%B8-ip%EB%A5%BC-%EB%B3%B4%EC%A1%B4%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95/>한국어</a></li><li><a class=dropdown-item href=/ar-sa/blog/1/01/01/>العربية</a></li><li><span class="dropdown-item active">Deutsch</span></li><li><a class=dropdown-item href=/fr-fr/blog/2024/05/27/comment-conserver-lip-source-des-requ%C3%AAtes-apr%C3%A8s-%C3%A9quilibrage-de-charge-dans-un-cluster-k8s/>Français</a></li><li><a class=dropdown-item href=/hi-in/blog/2024/05/27/k8s-%E0%A4%95%E0%A5%8D%E0%A4%B2%E0%A4%B8%E0%A5%8D%E0%A4%9F%E0%A4%B0-%E0%A4%AE%E0%A5%87%E0%A4%82-%E0%A4%B2%E0%A5%8B%E0%A4%A1-%E0%A4%AC%E0%A5%88%E0%A4%B2%E0%A5%87%E0%A4%82%E0%A4%B8%E0%A4%B0-%E0%A4%95%E0%A5%87-%E0%A4%AC%E0%A4%BE%E0%A4%A6-%E0%A4%95%E0%A5%87-%E0%A4%85%E0%A4%A8%E0%A5%81%E0%A4%B0%E0%A5%8B%E0%A4%A7-%E0%A4%B8%E0%A5%8D%E0%A4%B0%E0%A5%8B%E0%A4%A4-ip-%E0%A4%95%E0%A5%8B-%E0%A4%95%E0%A5%88%E0%A4%B8%E0%A5%87-%E0%A4%AC%E0%A4%A8%E0%A4%BE%E0%A4%8F-%E0%A4%B0%E0%A4%96%E0%A5%87%E0%A4%82/>हिंदी</a></li><li><a class=dropdown-item href=/es-es/blog/2024/05/27/c%C3%B3mo-conservar-la-ip-de-origen-de-las-solicitudes-despu%C3%A9s-de-la-equilibraci%C3%B3n-de-carga-en-un-cl%C3%BAster-de-k8s/>Español</a></li><li><a class=dropdown-item href=/pt-br/blog/2024/05/27/como-preservar-o-ip-de-origem-da-solicita%C3%A7%C3%A3o-ap%C3%B3s-o-balanceamento-de-carga-em-um-cluster-k8s/>Português</a></li><li><a class=dropdown-item href=/ru-ru/blog/2024/05/27/%D0%BA%D0%B0%D0%BA-%D1%81%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B8%D1%82%D1%8C-%D0%B8%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D0%B9-ip-%D0%B0%D0%B4%D1%80%D0%B5%D1%81-%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D0%B0-%D0%BF%D0%BE%D1%81%D0%BB%D0%B5-%D0%B1%D0%B0%D0%BB%D0%B0%D0%BD%D1%81%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B8-%D0%BD%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8-%D0%B2-%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B5-k8s/>Русский</a></li><li><a class=dropdown-item href=/it-it/blog/2024/05/27/come-preservare-lip-sorgente-delle-richieste-dopo-il-bilanciamento-del-carico-in-un-cluster-k8s/>Italiano</a></li><li><span class="dropdown-item disabled">Bahasa Indonesia</span></li><li><a class=dropdown-item href=/tr-tr/blog/2024/05/27/k8s-k%C3%BCmesinde-y%C3%BCk-dengeleme-sonras%C4%B1-istek-kaynak-ipsini-nas%C4%B1l-koruyabiliriz/>Türkçe</a></li><li><a class=dropdown-item href=/nl-nl/blog/2024/05/27/hoe-behoud-je-het-bron-ip-van-verzoeken-na-load-balancing-in-een-k8s-cluster/>Nederlands</a></li><li><a class=dropdown-item href=/pl-pl/blog/2024/05/27/jak-zachowa%C4%87-oryginalny-ip-%C5%BAr%C3%B3d%C5%82a-%C5%BC%C4%85dania-po-r%C3%B3wnowa%C5%BCeniu-obci%C4%85%C5%BCenia-w-klastrze-k8s/>Polski</a></li><li><a class=dropdown-item href=/ar-ae/blog/1/01/01/>العربية</a></li><li><a class=dropdown-item href=/zh-cn/blog/2024/05/27/k8s%E9%9B%86%E7%BE%A4%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BF%9D%E7%95%99%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%90%8E%E7%9A%84%E8%AF%B7%E6%B1%82%E6%BA%90ip/>简体中文</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Diese Seite durchsuchen…" aria-label="Diese Seite durchsuchen…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.321c42609f2819a595ec79e206244e21.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Diese Seite durchsuchen…" aria-label="Diese Seite durchsuchen…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.321c42609f2819a595ec79e206244e21.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-de-deblog-li><a href=/de-de/blog/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-de-deblog><span>Blogs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251205spot-server-sind-ein-groc39fartiges-geschaeft-li><input type=checkbox id=m-de-deblog20251205spot-server-sind-ein-groc39fartiges-geschaeft-check>
<label for=m-de-deblog20251205spot-server-sind-ein-groc39fartiges-geschaeft-check><a href=/de-de/blog/2025/12/05/spot-server-sind-ein-gro%C3%9Fartiges-geschaeft/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251205spot-server-sind-ein-groc39fartiges-geschaeft><span>Spot-Server sind ein großartiges Geschäft</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251203es-wird-empfohlen-die-funktion-esa-pages-von-alibaba-cloud-vorerst-nicht-zu-verwenden-li><input type=checkbox id=m-de-deblog20251203es-wird-empfohlen-die-funktion-esa-pages-von-alibaba-cloud-vorerst-nicht-zu-verwenden-check>
<label for=m-de-deblog20251203es-wird-empfohlen-die-funktion-esa-pages-von-alibaba-cloud-vorerst-nicht-zu-verwenden-check><a href=/de-de/blog/2025/12/03/es-wird-empfohlen-die-funktion-esa-pages-von-alibaba-cloud-vorerst-nicht-zu-verwenden/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251203es-wird-empfohlen-die-funktion-esa-pages-von-alibaba-cloud-vorerst-nicht-zu-verwenden><span>Es wird empfohlen, die Funktion ESA Pages von Alibaba Cloud vorerst nicht zu verwenden</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251202die-fallstricke-von-alibaba-esa-und-oss-li><input type=checkbox id=m-de-deblog20251202die-fallstricke-von-alibaba-esa-und-oss-check>
<label for=m-de-deblog20251202die-fallstricke-von-alibaba-esa-und-oss-check><a href=/de-de/blog/2025/12/02/die-fallstricke-von-alibaba-esa-und-oss/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251202die-fallstricke-von-alibaba-esa-und-oss><span>Die Fallstricke von Alibaba ESA und OSS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251202ist-cloudflare-vollstc3a4ndig-vertrauenswc3bcrdig-li><input type=checkbox id=m-de-deblog20251202ist-cloudflare-vollstc3a4ndig-vertrauenswc3bcrdig-check>
<label for=m-de-deblog20251202ist-cloudflare-vollstc3a4ndig-vertrauenswc3bcrdig-check><a href=/de-de/blog/2025/12/02/ist-cloudflare-vollst%C3%A4ndig-vertrauensw%C3%BCrdig/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251202ist-cloudflare-vollstc3a4ndig-vertrauenswc3bcrdig><span>Ist Cloudflare vollständig vertrauenswürdig?</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251201das-rc3a4tsel-der-verbesserten-sehkraft-li><input type=checkbox id=m-de-deblog20251201das-rc3a4tsel-der-verbesserten-sehkraft-check>
<label for=m-de-deblog20251201das-rc3a4tsel-der-verbesserten-sehkraft-check><a href=/de-de/blog/2025/12/01/das-r%C3%A4tsel-der-verbesserten-sehkraft/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251201das-rc3a4tsel-der-verbesserten-sehkraft><span>Das Rätsel der verbesserten Sehkraft</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-li><input type=checkbox id=m-de-deblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-check>
<label for=m-de-deblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-check><a href=/de-de/blog/2025/11/29/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%9E%E5%85%B8%E5%9E%8B%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5><span>Aufzeichnung einer untypischen Fehlersuche im häuslichen Netzwerk</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20251127kostenlose-vorteile-die-man-mit-einem-domainnamen-erhalten-kann-li><input type=checkbox id=m-de-deblog20251127kostenlose-vorteile-die-man-mit-einem-domainnamen-erhalten-kann-check>
<label for=m-de-deblog20251127kostenlose-vorteile-die-man-mit-einem-domainnamen-erhalten-kann-check><a href=/de-de/blog/2025/11/27/kostenlose-vorteile-die-man-mit-einem-domainnamen-erhalten-kann/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20251127kostenlose-vorteile-die-man-mit-einem-domainnamen-erhalten-kann><span>Kostenlose Vorteile, die man mit einem Domainnamen erhalten kann</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20240527windows-systeminstallation-und-aktivierung-li><input type=checkbox id=m-de-deblog20240527windows-systeminstallation-und-aktivierung-check>
<label for=m-de-deblog20240527windows-systeminstallation-und-aktivierung-check><a href=/de-de/blog/2024/05/27/windows-systeminstallation-und-aktivierung/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240527windows-systeminstallation-und-aktivierung><span>Windows-Systeminstallation und -Aktivierung</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-de-deblog20240527wie-behc3a4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei-li><input type=checkbox id=m-de-deblog20240527wie-behc3a4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei-check checked>
<label for=m-de-deblog20240527wie-behc3a4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei-check><a href=/de-de/blog/2024/05/27/wie-beh%C3%A4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240527wie-behc3a4lt-man-in-einem-k8s-cluster-die-quell-ip-der-anfragen-nach-der-lastverteilung-bei><span class=td-sidebar-nav-active-item>Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20240521wireguard-gegen-isp-udp-qos-die-vollstc3a4ndige-lc3b6sung-li><input type=checkbox id=m-de-deblog20240521wireguard-gegen-isp-udp-qos-die-vollstc3a4ndige-lc3b6sung-check>
<label for=m-de-deblog20240521wireguard-gegen-isp-udp-qos-die-vollstc3a4ndige-lc3b6sung-check><a href=/de-de/blog/2024/05/21/wireguard-gegen-isp-udp-qos-die-vollst%C3%A4ndige-l%C3%B6sung/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240521wireguard-gegen-isp-udp-qos-die-vollstc3a4ndige-lc3b6sung><span>WireGuard gegen ISP-UDP-QoS: Die vollständige Lösung</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20240520neuling-beie5b091e695b0e6b4be-meldet-sich-li><input type=checkbox id=m-de-deblog20240520neuling-beie5b091e695b0e6b4be-meldet-sich-check>
<label for=m-de-deblog20240520neuling-beie5b091e695b0e6b4be-meldet-sich-check><a href=/de-de/blog/2024/05/20/neuling-bei%E5%B0%91%E6%95%B0%E6%B4%BE-meldet-sich/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240520neuling-beie5b091e695b0e6b4be-meldet-sich><span>Neuling bei少数派 meldet sich</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20240509personalisierte-empfehlungen-bequemlichkeitsgott-oder-kognitive-falle-li><input type=checkbox id=m-de-deblog20240509personalisierte-empfehlungen-bequemlichkeitsgott-oder-kognitive-falle-check>
<label for=m-de-deblog20240509personalisierte-empfehlungen-bequemlichkeitsgott-oder-kognitive-falle-check><a href=/de-de/blog/2024/05/09/personalisierte-empfehlungen-bequemlichkeitsgott-oder-kognitive-falle/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240509personalisierte-empfehlungen-bequemlichkeitsgott-oder-kognitive-falle><span>Personalisierte Empfehlungen: Bequemlichkeitsgott oder kognitive Falle?</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog20240509erfahrungen-beim-erstellen-in-der-tencent-cloud-developer-community-li><input type=checkbox id=m-de-deblog20240509erfahrungen-beim-erstellen-in-der-tencent-cloud-developer-community-check>
<label for=m-de-deblog20240509erfahrungen-beim-erstellen-in-der-tencent-cloud-developer-community-check><a href=/de-de/blog/2024/05/09/erfahrungen-beim-erstellen-in-der-tencent-cloud-developer-community/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog20240509erfahrungen-beim-erstellen-in-der-tencent-cloud-developer-community><span>Erfahrungen beim Erstellen in der Tencent Cloud Developer Community</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-de-deblog10101-li><input type=checkbox id=m-de-deblog10101-check>
<label for=m-de-deblog10101-check><a href=/de-de/blog/1/01/01/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-de-deblog10101><span></span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text></span>
<a class=td-toc-title__link title href=#></a></div><nav id=TableOfContents><ul><li><a href=#einleitung>Einleitung</a></li><li><a href=#warum-geht-die-quell-ip-information-verloren>Warum geht die Quell-IP-Information verloren?</a></li><li><a href=#wie-behält-man-die-quell-ip-bei>Wie behält man die Quell-IP bei?</a></li><li><a href=#k8s-bedienungsanleitung>K8S-Bedienungsanleitung</a><ul><li><a href=#deployment-erstellen>Deployment erstellen</a></li><li><a href=#service-erstellen>Service erstellen</a></li><li><a href=#ingress-erstellen>Ingress erstellen</a></li></ul></li><li><a href=#zusammenfassung>Zusammenfassung</a></li><li><a href=#referenzen>Referenzen</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Taxonomy Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/2025/ data-taxonomy-term=2025><span class=taxonomy-label>2025</span><span class=taxonomy-count>7</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/anleitungen/ data-taxonomy-term=anleitungen><span class=taxonomy-label>Anleitungen</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/betrieb/ data-taxonomy-term=betrieb><span class=taxonomy-label>Betrieb</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/blog/ data-taxonomy-term=blog><span class=taxonomy-label>Blog</span><span class=taxonomy-count>4</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/creator-plattform/ data-taxonomy-term=creator-plattform><span class=taxonomy-label>Creator-Plattform</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/essays/ data-taxonomy-term=essays><span class=taxonomy-label>Essays</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/netzwerk/ data-taxonomy-term=netzwerk><span class=taxonomy-label>Netzwerk</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/netzwerkoptimierung/ data-taxonomy-term=netzwerkoptimierung><span class=taxonomy-label>Netzwerkoptimierung</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/nicht-kategorisiert/ data-taxonomy-term=nicht-kategorisiert><span class=taxonomy-label>Nicht Kategorisiert</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/rezension/ data-taxonomy-term=rezension><span class=taxonomy-label>Rezension</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/spieltheorie/ data-taxonomy-term=spieltheorie><span class=taxonomy-label>Spieltheorie</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/udp-qos/ data-taxonomy-term=udp-qos><span class=taxonomy-label>UDP QoS</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/unklassifiziert/ data-taxonomy-term=unklassifiziert><span class=taxonomy-label>Unklassifiziert</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/vpn/ data-taxonomy-term=vpn><span class=taxonomy-label>VPN</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/wireguard/ data-taxonomy-term=wireguard><span class=taxonomy-label>WireGuard</span><span class=taxonomy-count>1</span></a></li></ul></div><div class="taxonomy taxonomy-terms-cloud taxo-categories"><h5 class=taxonomy-title>Categories</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/anleitungen/ data-taxonomy-term=anleitungen><span class=taxonomy-label>Anleitungen</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/betrieb/ data-taxonomy-term=betrieb><span class=taxonomy-label>Betrieb</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/essays/ data-taxonomy-term=essays><span class=taxonomy-label>Essays</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/netzwerk/ data-taxonomy-term=netzwerk><span class=taxonomy-label>Netzwerk</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/netzwerktechnik/ data-taxonomy-term=netzwerktechnik><span class=taxonomy-label>Netzwerktechnik</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/nicht-kategorisiert/ data-taxonomy-term=nicht-kategorisiert><span class=taxonomy-label>Nicht Kategorisiert</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/rezension/ data-taxonomy-term=rezension><span class=taxonomy-label>Rezension</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/spieltheorie/ data-taxonomy-term=spieltheorie><span class=taxonomy-label>Spieltheorie</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/unklassifiziert/ data-taxonomy-term=unklassifiziert><span class=taxonomy-label>Unklassifiziert</span><span class=taxonomy-count>1</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role=main><a class=td-rss-button title=RSS href=/de-de/blog/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss" aria-hidden=true></i></a><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/de-de/blog/>Blogs</a></li><li class="breadcrumb-item active" aria-current=page>Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?</li></ol></nav><div class=td-content><h1>Wie behält man in einem K8s-Cluster die Quell-IP der Anfragen nach der Lastverteilung bei?</h1><div class="td-byline mb-4"><time datetime=2024-05-27 class=text-body-secondary>Monday, May 27, 2024</time></div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/netzwerk/ data-taxonomy-term=netzwerk><span class=taxonomy-label>Netzwerk</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/tags/blog/ data-taxonomy-term=blog><span class=taxonomy-label>Blog</span></a></li></ul></div><div class="taxonomy taxonomy-terms-article taxo-categories"><h5 class=taxonomy-title>Categories:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/de-de/categories/netzwerk/ data-taxonomy-term=netzwerk><span class=taxonomy-label>Netzwerk</span></a></li></ul></div></header><h2 id=einleitung>Einleitung</h2><p><strong>Anwendungsdeployments</strong> sind nicht immer einfach nur <strong>Installieren</strong> und <strong>Ausführen</strong>, manchmal muss man auch <strong>Netzwerk</strong>-Probleme berücksichtigen. Dieser Artikel erklärt, wie man in einem <strong>K8s-Cluster</strong> dafür sorgt, dass Dienste die <strong>Quell-IP</strong> der Anfrage erhalten können.</p><p>Anwendungen, die Dienste bereitstellen, basieren in der Regel auf Eingabeinformationen. Wenn diese Eingabeinformationen nicht auf der <strong>fünfzeiligen Gruppe</strong> (Quell-IP, Quellport, Ziel-IP, Zielport, Protokoll) angewiesen sind, hat der Dienst eine <strong>geringe Netzwerkkopplung</strong> und muss sich nicht um Netzwerkdetails kümmern.</p><p>Daher ist es für die meisten Menschen nicht notwendig, diesen Artikel zu lesen. Wenn Sie sich für Netzwerke interessieren oder Ihre Sichtweise erweitern möchten, können Sie den Rest lesen, um mehr über Dienstenszenarien zu erfahren.</p><p>Dieser Artikel basiert auf K8s <code>v1.29.4</code>. Einige Beschreibungen verwenden Pod und Endpoint durcheinander; in diesem Szenario können sie als äquivalent betrachtet werden.</p><p><strong>Falls Fehler vorliegen, freue ich mich über Korrekturen, ich werde sie zeitnah beheben.</strong></p><h2 id=warum-geht-die-quell-ip-information-verloren>Warum geht die Quell-IP-Information verloren?</h2><p>Zuerst klären wir, was die Quell-IP ist: Wenn A eine Anfrage an B sendet und B diese an C weiterleitet, sieht C zwar in der IP-Protokoll-Quell-IP die IP von B, aber in diesem Artikel betrachten wir die <strong>IP von A</strong> als Quell-IP.</p><p>Es gibt hauptsächlich zwei Verhaltensweisen, die zum Verlust der Quellinformation führen:</p><ol><li><strong>Netzwerkadressübersetzung (NAT)</strong>, deren Zweck die Einsparung öffentlicher IPv4-Adressen, Lastverteilung usw. ist. Dadurch sieht der Server die Quell-IP des <strong>NAT</strong>-Geräts statt der echten Quell-IP.</li><li><strong>Proxy</strong>, <strong>Reverse Proxy (RP)</strong> und <strong>Load Balancer (LB)</strong> gehören zu dieser Kategorie, im Folgenden als <strong>Proxy-Server</strong> bezeichnet. Diese Proxy-Dienste leiten Anfragen an Backend-Dienste weiter, ersetzen aber die Quell-IP durch ihre eigene IP.</li></ol><ul><li>NAT ist im Wesentlichen <strong>Port-Raum gegen IP-Raum austauschen</strong>. IPv4-Adressen sind begrenzt; eine IP-Adresse kann 65535 Ports abbilden. In den meisten Fällen werden diese Ports nicht ausgeschöpft, sodass mehrere Subnetz-IPs eine öffentliche IP teilen können, unterteilt durch Ports. Die Form lautet: <code>public IP:public port -> private IP_1:private port</code>. Weitere Informationen finden Sie unter <a href="https://www.google.com/search?q=%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2">Netzwerkadressübersetzung</a>.</li><li>Proxy-Dienste dienen zum <strong>Verstecken oder Exponieren</strong>. Proxy-Dienste leiten Anfragen an Backend-Dienste weiter und ersetzen die Quell-IP durch ihre eigene, um die echte IP des Backend-Diensts zu schützen. Die Form lautet: <code>client IP -> proxy IP -> server IP</code>. Weitere Informationen finden Sie unter <a href="https://www.google.com/search?q=%E4%BB%A3%E7%90%86">Proxy</a>.</li></ul><p><strong>NAT</strong> und <strong>Proxy-Server</strong> sind sehr häufig; die meisten Dienste können die Quell-IP der Anfrage nicht erhalten.</p><p><em>Das sind die zwei gängigen Wege, die Quell-IP zu ändern. Ergänzungen sind willkommen.</em></p><h2 id=wie-behält-man-die-quell-ip-bei>Wie behält man die Quell-IP bei?</h2><p>Hier ein Beispiel für eine <code>HTTP-Anfrage</code>:</p><table><thead><tr><th>Feld</th><th>Länge (Bytes)</th><th>Bit-Offset</th><th>Beschreibung</th></tr></thead><tbody><tr><td><strong>IP-Kopf</strong></td><td></td><td></td><td></td></tr><tr><td><code>Quell-IP</code></td><td>4</td><td>0-31</td><td>IP-Adresse des Senders</td></tr><tr><td>Ziel-IP</td><td>4</td><td>32-63</td><td>IP-Adresse des Empfängers</td></tr><tr><td><strong>TCP-Kopf</strong></td><td></td><td></td><td></td></tr><tr><td>Quellport</td><td>2</td><td>0-15</td><td>Sender-Portnummer</td></tr><tr><td>Zielport</td><td>2</td><td>16-31</td><td>Empfänger-Portnummer</td></tr><tr><td>Sequenznummer</td><td>4</td><td>32-63</td><td>Identifiziert den Byte-Stream des Senders</td></tr><tr><td>Bestätigungsnummer</td><td>4</td><td>64-95</td><td>Bei gesetztem ACK-Flag die nächste erwartete Sequenznummer</td></tr><tr><td>Datenoffset</td><td>4</td><td>96-103</td><td>Bytes vom TCP-Kopf bis zum Datenstart</td></tr><tr><td>Reserviert</td><td>4</td><td>104-111</td><td>Reserviertes Feld, auf 0 setzen</td></tr><tr><td>Flag-Bits</td><td>2</td><td>112-127</td><td>Steuerflags wie SYN, ACK, FIN usw.</td></tr><tr><td>Fenstergröße</td><td>2</td><td>128-143</td><td>Empfänger-Datenmenge</td></tr><tr><td>Prüfsumme</td><td>2</td><td>144-159</td><td>Fehlererkennung während der Übertragung</td></tr><tr><td>Dringendkeitszeiger</td><td>2</td><td>160-175</td><td>Position dringender Daten</td></tr><tr><td>Optionen</td><td>Variabel</td><td>176-&mldr;</td><td>Kann Zeitstempel, maximale Segmentlänge usw. enthalten</td></tr><tr><td><strong>HTTP-Kopf</strong></td><td></td><td></td><td></td></tr><tr><td>Anfragerzeile</td><td>Variabel</td><td>&mldr;-&mldr;</td><td>Enthält Anfrage-Methode, URI und HTTP-Version</td></tr><tr><td><code>Kopf-Felder</code></td><td>Variabel</td><td>&mldr;-&mldr;</td><td>Verschiedene Kopf-Felder wie Host, User-Agent usw.</td></tr><tr><td>Leere Zeile</td><td>2</td><td>&mldr;-&mldr;</td><td>Trennt Kopf und Body</td></tr><tr><td>Body</td><td>Variabel</td><td>&mldr;-&mldr;</td><td>Optionaler Anfrage- oder Antwortkörper</td></tr></tbody></table><p>Bei der Betrachtung der HTTP-Anfragenstruktur fällt auf, dass <strong>TCP-Optionen</strong>, <strong>Anfragerzeile</strong>, <strong>Kopf-Felder</strong> und <strong>Body</strong> variabel sind. <strong>TCP-Optionen</strong> haben begrenzten Platz und werden normalerweise nicht für Quell-IPs verwendet. Die <strong>Anfragerzeile</strong> hat feste Informationen, die nicht erweitert werden können. Der <strong>HTTP-Body</strong> kann nach Verschlüsselung nicht geändert werden. Nur die <code>HTTP-Kopf-Felder</code> eignen sich zur Erweiterung für die Quell-IP-Übertragung.</p><p>Im HTTP-Header kann das Feld <code>X-REAL-IP</code> hinzugefügt werden, um die Quell-IP zu übertragen. Diese Operation erfolgt normalerweise auf dem Proxy-Server, der die Anfrage dann an den Backend-Dienst sendet, der die Quell-IP über dieses Feld abrufen kann.</p><p>Achten Sie darauf, dass der <strong>Proxy-Server</strong> vor dem <strong>NAT</strong>-Gerät stehen muss, um die echte Quell-IP zu erhalten. In Produkten von Aliyun gibt es die Kategorie <a href=https://slb.console.aliyun.com/overview><strong>Load Balancer</strong></a>, deren Position im Netzwerk sich von normalen App-Servern unterscheidet.</p><h2 id=k8s-bedienungsanleitung>K8S-Bedienungsanleitung</h2><p>Am Beispiel des <a href=https://github.com/traefik/whoami>whoami</a>-Projekts.</p><h3 id=deployment-erstellen>Deployment erstellen</h3><p>Zuerst den Dienst erstellen:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami-deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>whoami</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>whoami</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/traefik/whoami:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></div><p>Dieser Schritt erstellt ein <strong>Deployment</strong> mit 3 <strong>Pods</strong>, wobei jeder Pod einen Container enthält, der den <strong>whoami</strong>-Dienst ausführt.</p><h3 id=service-erstellen>Service erstellen</h3><p>Man kann einen <strong>NodePort</strong>- oder <strong>LoadBalancer</strong>-Dienst für externen Zugriff erstellen oder einen <strong>ClusterIP</strong>-Dienst für internen Zugriff und dann einen <strong>Ingress</strong>-Dienst hinzufügen, um externen Zugriff freizugeben.</p><p><strong>NodePort</strong> kann über <strong>NodeIP:NodePort</strong> oder über <strong>Ingress</strong>Dienst zugänglich sein, was Tests erleichtert. Dieser Abschnitt verwendet <strong>NodePort</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>whoami</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30002</span><span class=w>
</span></span></span></code></pre></div><p>Nach der Erstellung des Diensts, z. B. mit <code>curl whoami.example.com:30002</code>, sieht man, dass die zurückgegebene IP die <strong>NodeIP</strong> ist, nicht die Quell-IP der Anfrage.</p><blockquote><p>Bitte beachten Sie, dass dies nicht die korrekte Client-IP ist; es handelt sich um interne Cluster-IPs. So läuft es ab:</p><ul><li>Client sendet Paket an node2:nodePort</li><li>node2 ersetzt die Quell-IP des Pakets durch seine eigene IP (SNAT)</li><li>node2 ersetzt die Ziel-IP des Pakets durch die Pod-IP</li><li>Paket wird an node1 und dann zum Endpoint geroutet</li><li>Pod-Antwort wird zurück an node2 geroutet</li><li>Pod-Antwort wird an den Client gesendet</li></ul></blockquote><p>Als Diagramm:</p><p><img src=https://s2.loli.net/2024/05/27/fDg2tBx5FIcGMZN.png alt></p><h4 id=externaltrafficpolicy-local-konfigurieren>externalTrafficPolicy: Local konfigurieren</h4><blockquote><p>Um das zu vermeiden, hat Kubernetes eine Funktion, um die Client-Quell-IP zu erhalten. Wenn service.spec.externalTrafficPolicy auf Local gesetzt wird, leitet kube-proxy Anfragen nur an lokale Endpoints weiter, ohne Traffic zu anderen Nodes weiterzuleiten.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>externalTrafficPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>whoami</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30002</span><span class=w>
</span></span></span></code></pre></div><p>Testen Sie mit <code>curl whoami.example.com:30002</code>. Wenn <strong>whoami.example.com</strong> auf IPs mehrerer Cluster-Nodes zeigt, gibt es eine gewisse Wahrscheinlichkeit, dass der Zugriff fehlschlägt. Stellen Sie sicher, dass der DNS-Eintrag nur die IP des Nodes mit dem Endpoint (Pod) enthält.</p><p>Diese Konfiguration hat ihren <strong>Preis</strong>: Der Verlust der Lastverteilung im Cluster. Clients erhalten nur Antworten, wenn sie den Node mit dem Endpoint ansprechen.</p><p><img src=https://s2.loli.net/2024/05/27/PCgiTLF28XE4RKx.png alt=Zugriffsweg-Einschränkung></p><p>Beim Zugriff auf Node 2 gibt es keine Antwort.</p><h3 id=ingress-erstellen>Ingress erstellen</h3><p>Die meisten Dienste werden über <strong>HTTP/HTTPS</strong> bereitgestellt; <strong>https://ip:port</strong> wirkt fremd für Benutzer. Normalerweise verwendet man <strong>Ingress</strong>, um den oben erstellten <strong>NodePort</strong>-Dienst auf Port <strong>80/443</strong> eines Domains zu laden.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami-ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ingressClassName</span><span class=p>:</span><span class=w> </span><span class=l>external-lb-default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>whoami.example.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class=l>Prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>whoami-service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span></code></pre></div><p>Nach Anwenden testen Sie mit <code>curl whoami.example.com</code>; ClientIP ist immer die Pod-IP des <code>Ingress Controller</code> auf dem Endpoint-Node.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@client:~# curl whoami.example.com
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>RemoteAddr: 10.42.1.10:56482
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>root@worker:~# kubectl get -n ingress-nginx pod -o wide
</span></span><span class=line><span class=cl>NAME                                       READY   STATUS    RESTARTS   AGE    IP           NODE          NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>ingress-nginx-controller-c8f499cfc-xdrg7   1/1     Running   <span class=m>0</span>          3d2h   10.42.1.10   k3s-agent-1   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><p><strong>Ingress</strong> als Reverse Proxy für <strong>NodePort</strong>-Dienst bedeutet zwei Service-Schichten vor dem Endpoint. Das Diagramm zeigt den Unterschied.</p><pre class=mermaid>graph LR
    A[Client] --&gt;|whoami.example.com:80| B(Ingress)
    B --&gt;|10.43.38.129:32123| C[Service]
    C --&gt;|10.42.1.1:8080| D[Endpoint]</pre><pre class=mermaid>graph LR
    A[Client] --&gt;|whoami.example.com:30001| B(Service)
    B --&gt;|10.42.1.1:8080| C[Endpoint]</pre><p>Im Pfad 1 erreicht externer Traffic zuerst den <code>Ingress Controller</code>-Endpoint, dann den <strong>whoami</strong>-Endpoint.<br>Der <strong>Ingress Controller</strong> ist im Wesentlichen ein <strong>LoadBalancer</strong>-Dienst.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>kubectl -n ingress-nginx get svc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAMESPACE   NAME             CLASS   HOSTS                       ADDRESS                                              PORTS   AGE
</span></span><span class=line><span class=cl>default     echoip-ingress   nginx   ip.example.com       172.16.0.57,2408:4005:3de:8500:4da1:169e:dc47:1707   <span class=m>80</span>      18h
</span></span><span class=line><span class=cl>default     whoami-ingress   nginx   whoami.example.com   172.16.0.57,2408:4005:3de:8500:4da1:169e:dc47:1707   <span class=m>80</span>      16h
</span></span></code></pre></div><p>Daher kann man <code>externalTrafficPolicy</code> auf dem Ingress Controller setzen, um die Quell-IP zu erhalten.</p><p>Zusätzlich <code>use-forwarded-headers</code> im <code>configmap</code> des <code>ingress-nginx-controller</code> auf <code>true</code> setzen, damit der <strong>Ingress Controller</strong> <code>X-Forwarded-For</code> oder <code>X-REAL-IP</code> erkennt.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>data</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>allow-snippet-annotations</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>compute-full-forwarded-for</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>use-forwarded-headers</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>enable-real-ip</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>forwarded-for-header</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;X-Real-IP&#34;</span><span class=w> </span><span class=c># X-Real-IP or X-Forwarded-For</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ConfigMap</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/component</span><span class=p>:</span><span class=w> </span><span class=l>controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/instance</span><span class=p>:</span><span class=w> </span><span class=l>ingress-nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/part-of</span><span class=p>:</span><span class=w> </span><span class=l>ingress-nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/version</span><span class=p>:</span><span class=w> </span><span class=m>1.10.1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ingress-nginx-controller</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>ingress-nginx</span><span class=w>
</span></span></span></code></pre></div><p>Der Unterschied zwischen <strong>NodePort</strong>-Dienst und <strong>ingress-nginx-controller</strong>-Dienst liegt darin, dass <strong>NodePort</strong>-Backends normalerweise nicht auf jedem Node deployt sind, während <strong>ingress-nginx-controller</strong>-Backends auf jedem extern exponierten Node deployt sind.</p><p>Im Gegensatz zu <strong>NodePort</strong>, wo <code>externalTrafficPolicy</code> Anfragen über Nodes blockiert, kann <strong>Ingress</strong> zuerst den HEADER setzen und dann weiterleiten, was <strong>Quell-IP-Erhaltung</strong> und <strong>Lastverteilung</strong> kombiniert.</p><h2 id=zusammenfassung>Zusammenfassung</h2><ul><li><strong>Adressübersetzung (NAT)</strong>, <strong>Proxy</strong>, <strong>Reverse Proxy</strong>, <strong>Load Balancing</strong> führen zum Verlust der Quell-IP.</li><li>Um Verlust zu verhindern, kann der Proxy-Server die echte IP im HTTP-Header-Feld <code>X-REAL-IP</code> setzen. Bei Mehrschicht-Proxys <code>X-Forwarded-For</code> verwenden, das eine <strong>IP-Liste</strong> als <strong>Stapel</strong> mit Quell-IP und Proxy-Pfad speichert.</li><li><strong>NodePort</strong>-Dienste im Cluster mit <code>externalTrafficPolicy: Local</code> erhalten Quell-IP, verlieren aber Lastverteilung.</li><li><strong>ingress-nginx-controller</strong> als <strong>DaemonSet</strong> auf allen <strong>LoadBalancer</strong>-Rollen-Nodes mit <code>externalTrafficPolicy: Local</code> erhält Quell-IP und behält Lastverteilung.</li></ul><h2 id=referenzen>Referenzen</h2><ul><li><a href=https://kubernetes.io/zh-cn/docs/tutorials/services/source-ip/>Kubernetes Quell-IP verwenden</a></li><li><a href=https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/>Ingress-Nginx Controller:ConfigMap</a></li><li><a href=https://kubernetes.io/zh-cn/docs/concepts/services-networking/ingress-controllers/>Ingress Controller</a></li></ul><br><script src=https://giscus.app/client.js data-repo=jqknono/blog data-repo-id=R_kgDONOhENQ data-category=Announcements data-category-id=DIC_kwDONOhENc4CkQDB data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script><br><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/de-de/blog/2024/05/21/wireguard-gegen-isp-udp-qos-die-vollst%C3%A4ndige-l%C3%B6sung/ aria-label="Zurück - WireGuard gegen ISP-UDP-QoS: Die vollständige Lösung" class="btn btn-primary"><span class=me-1>←</span>Zurück</a></li><li><a href=/de-de/blog/2024/05/27/windows-systeminstallation-und-aktivierung/ aria-label="Weiter - Windows-Systeminstallation und -Aktivierung" class="btn btn-primary">Weiter<span class=ms-1>→</span></a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/jqknono aria-label="User mailing list"><i class=envelope></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/jqknono aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/jqknono aria-label="User mailing list"><i class=envelope></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2015&ndash;2025
<span class=td-footer__authors>jqknono</span></span><span class=td-footer__all_rights_reserved>Alle Rechte vorbehalten</span></div></div></div></footer></div><script type=module async>
  import mermaid from "https:\/\/cdn.jsdelivr.net\/npm\/mermaid@latest\/dist\/mermaid.esm.min.mjs";

  (function ($) {
    if ($('.mermaid').length == 0) {
      mermaid.initialize({ startOnLoad: false });
      return;
    }

    var params = {"theme":"default","version":"latest"};

    
    
    var norm = function (defaultConfig, params) {
      var result = {};
      for (const key in defaultConfig) {
        const keyLower = key.toLowerCase();
        if (defaultConfig.hasOwnProperty(key) && params.hasOwnProperty(keyLower)) {
          if (typeof defaultConfig[key] === "object") {
            result[key] = norm(defaultConfig[key], params[keyLower]);
          } else {
            result[key] = params[keyLower];
          }
        }
      }
      return result;
    };

    var settings = norm(mermaid.mermaidAPI.defaultConfig, params);
    settings.startOnLoad = true;
    if ($('html[data-bs-theme="dark"]').length) {
      settings.theme = 'dark';
    }
    mermaid.initialize(settings);

    
    const lightDarkModeThemeChangeHandler = function (mutationsList, observer) {
      for (const mutation of mutationsList) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'data-bs-theme') {
          
          
          
          location.reload();
        }
      }
    };

    const observer = new MutationObserver(lightDarkModeThemeChangeHandler);
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-bs-theme']
    });
    

  })(jQuery);
</script><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>