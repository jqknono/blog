<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>DoT on jqknono Blogs</title><link>https://blog.jqknono.com/tags/dot/</link><description>Recent content in DoT on jqknono Blogs</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Thu, 09 Oct 2025 13:16:16 +0800</lastBuildDate><atom:link href="https://blog.jqknono.com/tags/dot/index.xml" rel="self" type="application/rss+xml"/><item><title>Comparison of DNS Encryption Protocols: DoT, DoH, DoQ</title><link>https://blog.jqknono.com/blog/2025/10/09/comparison-of-dns-encryption-protocols-dot-doh-doq/</link><pubDate>Thu, 09 Oct 2025 13:16:16 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/10/09/comparison-of-dns-encryption-protocols-dot-doh-doq/</guid><description>&lt;h2 id="quick-glossary"&gt;Quick Glossary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS: Cleartext DNS, typically uses UDP/53, switching to TCP/53 when necessary (e.g., for truncated responses, zone transfers).&lt;/li&gt;
&lt;li&gt;DoT: DNS over TLS, uses TCP over TLS, default port 853 (RFC 7858/8310).&lt;/li&gt;
&lt;li&gt;DoH: DNS over HTTPS, based on HTTPS (HTTP/2 or HTTP/3), default port 443 (RFC 8484).&lt;/li&gt;
&lt;li&gt;DoQ: DNS over QUIC, based on QUIC + TLS 1.3, default port UDP/853 (RFC 9250, IANA assigned to 853/udp).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="layered-relationship-simplified-tcpip-model"&gt;Layered Relationship (Simplified TCP/IP Model)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Application Layer: HTTP, HTTPS, DNS (DoH is encapsulated within the HTTPS application layer)&lt;/li&gt;
&lt;li&gt;Security Layer: TLS (provides encryption for TCP or QUIC)&lt;/li&gt;
&lt;li&gt;Transport Layer: TCP, UDP, QUIC&lt;/li&gt;
&lt;li&gt;Network Layer: IP&lt;/li&gt;
&lt;li&gt;Link Layer: Ethernet, etc.&lt;/li&gt;
&lt;li&gt;Physical Layer: Twisted pair/Fiber optic/Wireless, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="key-points"&gt;Key Points&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS operates over UDP/TCP, unencrypted.&lt;/li&gt;
&lt;li&gt;DoT = TCP + TLS + DNS (dedicated port 853).&lt;/li&gt;
&lt;li&gt;DoH = TCP/QUIC + TLS + HTTP(S) + DNS (uses port 443, shared with regular HTTPS).&lt;/li&gt;
&lt;li&gt;DoQ = QUIC + TLS 1.3 + DNS (dedicated port UDP/853).&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TB
subgraph Application Layer
A[HTTP]
A2[HTTPS]
C[DNS]
D[DoH DNS over HTTPS]
end
subgraph Security Layer
E[TLS]
end
subgraph Transport Layer
F[TCP]
G[UDP]
H[QUIC]
end
subgraph Network Layer
I[IP]
end
subgraph Link Layer
J[Ethernet]
end
subgraph Physical Layer
K[Twisted Pair/Fiber/Wireless]
end
A2 --&amp;gt; F
A2 --&amp;gt; H
A --&amp;gt; F
C --&amp;gt; F
C --&amp;gt; G
D --&amp;gt; A2
E --&amp;gt; F
E --&amp;gt; H
F --&amp;gt; I
G --&amp;gt; I
H --&amp;gt; I
I --&amp;gt; J
J --&amp;gt; K
style D fill:#e1f5fe
style E fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="basics-and-corrections"&gt;Basics and Corrections&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS defaults to UDP/53, switching to TCP/53 for truncated responses (TC bit) or when reliable transport is needed.&lt;/li&gt;
&lt;li&gt;DoT establishes a TLS tunnel over TCP to transmit DNS messages, default port 853; long-lived connections can be reused to reduce handshake overhead.&lt;/li&gt;
&lt;li&gt;DoH treats DNS as a resource within HTTPS (&lt;code&gt;application/dns-message&lt;/code&gt;), typically using HTTP/2 or HTTP/3, port 443, easily mixed with regular HTTPS traffic.&lt;/li&gt;
&lt;li&gt;DoQ directly uses QUIC (based on UDP) to carry DNS, offering low latency and head-of-line blocking avoidance, but ecosystem adoption is still growing.&lt;/li&gt;
&lt;li&gt;Broad statements like &amp;ldquo;QUIC is always X% faster than TCP&amp;rdquo; are inaccurate; actual performance depends on network conditions (packet loss, jitter, RTT), connection reuse capabilities, implementation details, and server deployment.&lt;/li&gt;
&lt;li&gt;DoH is not inherently &amp;ldquo;slower/faster just because DNS is placed in HTTP&amp;rdquo;; performance depends on connection reuse, network quality, and implementation; in many cases, DoH/3 performance is comparable to or even better than DoT.&lt;/li&gt;
&lt;li&gt;DoT can use SNI for certificate hostname verification; DoH relies on standard HTTPS certificate validation and hostname matching.&lt;/li&gt;
&lt;li&gt;Encrypted DNS only prevents eavesdropping and tampering on the link; it does not equal &amp;ldquo;complete anonymity.&amp;rdquo; The resolver may still log queries; choose a trustworthy provider and review their privacy policy.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TD
subgraph DNS Family
A[Plain DNS UDP/TCP &amp;#43; DNS]
subgraph Encrypted DNS
B[DoT TCP &amp;#43; TLS &amp;#43; DNS]
C[DoH HTTP/2,3 &amp;#43; TLS &amp;#43; DNS]
D[DoQ QUIC &amp;#43; TLS 1.3 &amp;#43; DNS]
end
subgraph Transport Base
E[TCP]
F[UDP]
G[QUIC]
end
end
A --&amp;gt; B
A --&amp;gt; C
A --&amp;gt; D
B --&amp;gt; E
C --&amp;gt; E
C --&amp;gt; G
D --&amp;gt; G
A --&amp;gt; F
style A fill:#f3e5f5
style B fill:#e8f5e8
style C fill:#e3f2fd
style D fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="comparison-overview"&gt;Comparison Overview&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Protocol&lt;/th&gt;
&lt;th&gt;Transport Layer&lt;/th&gt;
&lt;th&gt;Encryption&lt;/th&gt;
&lt;th&gt;Encapsulation&lt;/th&gt;
&lt;th&gt;Default Port&lt;/th&gt;
&lt;th&gt;Typical Characteristics&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Plain DNS&lt;/td&gt;
&lt;td&gt;UDP/TCP&lt;/td&gt;
&lt;td&gt;None&lt;/td&gt;
&lt;td&gt;Native DNS&lt;/td&gt;
&lt;td&gt;53&lt;/td&gt;
&lt;td&gt;Simple, efficient, plaintext visible, easily tampered/monitored&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DoT&lt;/td&gt;
&lt;td&gt;TCP&lt;/td&gt;
&lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
&lt;td&gt;DNS&lt;/td&gt;
&lt;td&gt;853&lt;/td&gt;
&lt;td&gt;Dedicated port, easily blocked by port, good system-level support&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DoH&lt;/td&gt;
&lt;td&gt;TCP/QUIC&lt;/td&gt;
&lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
&lt;td&gt;HTTP/2-3 + DNS&lt;/td&gt;
&lt;td&gt;443&lt;/td&gt;
&lt;td&gt;Shares port with HTTPS, strong penetration, browser priority support&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DoQ&lt;/td&gt;
&lt;td&gt;QUIC&lt;/td&gt;
&lt;td&gt;TLS 1.3&lt;/td&gt;
&lt;td&gt;DNS&lt;/td&gt;
&lt;td&gt;853/UDP&lt;/td&gt;
&lt;td&gt;Low latency, avoids head-of-line blocking, ecosystem developing&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="performance-and-latency"&gt;Performance and Latency&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Connection Reuse: DoT/DoH/DoQ can all reuse long-lived connections to reduce handshake costs; DoH/2, DoH/3, and DoQ can also multiplex requests within a single connection.&lt;/li&gt;
&lt;li&gt;Head-of-Line Blocking: TCP suffers from application-layer head-of-line blocking; HTTP/2 mitigates this over TCP with multiplexing but is still affected by TCP packet loss. QUIC (DoH/3, DoQ) avoids head-of-line blocking at the transport layer, making it more friendly to high packet loss/mobile networks.&lt;/li&gt;
&lt;li&gt;First Packet Latency: On initial connection, DoT requires TCP+TLS handshake; DoH/2 is similar; DoH/3/DoQ, based on QUIC, offer faster reconnection and migration. Under sustained load, differences depend more on implementation and network conditions.&lt;/li&gt;
&lt;li&gt;Reachability: DoH uses port 443, least likely to be blocked by simple port filtering; DoT uses port 853, often subject to indiscriminate blocking; DoQ uses UDP/853, which may currently be blocked or not permitted.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="client-and-system-support"&gt;Client and System Support&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Browsers: Chromium family and Firefox have built-in DoH by default (can automatically upgrade to DoH-capable resolvers or use built-in provider lists).&lt;/li&gt;
&lt;li&gt;Windows: Windows 11 has native DoH support.&lt;/li&gt;
&lt;li&gt;Android: Android 9+ provides &amp;ldquo;Private DNS&amp;rdquo; (system-level DoT). System-level DoH support depends on version/manufacturer.&lt;/li&gt;
&lt;li&gt;Apple Platforms: iOS 14+/macOS 11+ support DoT and DoH via configuration profiles or NetworkExtension.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="deployment-and-selection-recommendations"&gt;Deployment and Selection Recommendations&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;General/Restricted Networks (e.g., public Wi-Fi, need to bypass simple blocking): Prioritize DoH (port 443), enable HTTP/3 if available.&lt;/li&gt;
&lt;li&gt;System-Wide Outbound (router, gateway, Android Private DNS): Prioritize DoT (853), optionally configure DoH as a fallback if the network allows.&lt;/li&gt;
&lt;li&gt;High Packet Loss/Mobile Networks: Prioritize DoH/3 with QUIC or DoQ (depending on resolver and client support).&lt;/li&gt;
&lt;li&gt;Enterprise/Compliance Scenarios: Choose based on policy (DoH can integrate with existing HTTPS infrastructure; DoT facilitates separation from DNS control plane).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="summary"&gt;Summary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;First choice: DoH (port 443, strong penetration), enable HTTP/3 if available.&lt;/li&gt;
&lt;li&gt;If system-wide unification is needed: Prioritize DoT (853) + persistent connections, fall back to DoH (443) if necessary.&lt;/li&gt;
&lt;li&gt;If your resolver and clients both support it: Try DoQ (often provides better mobile network experience).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="reference-standards"&gt;Reference Standards&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RFC 7858, RFC 8310 (DNS over TLS)&lt;/li&gt;
&lt;li&gt;RFC 8484 (DNS over HTTPS)&lt;/li&gt;
&lt;li&gt;RFC 9250 (DNS over QUIC)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="recommended-dns-services"&gt;Recommended DNS Services&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;NullPrivate DNS: &lt;a href="https://www.nullprivate.com"&gt;https://www.nullprivate.com&lt;/a&gt; supports DoT, DoH (supports HTTP3), natively supports ad-blocking and traffic splitting.&lt;/li&gt;
&lt;li&gt;Self-hosted version: &lt;a href="https://github.com/NullPrivate/NullPrivate"&gt;https://github.com/NullPrivate/NullPrivate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item></channel></rss>