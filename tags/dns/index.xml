<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>DNS on Nono Blogs</title><link>https://blog.jqknono.com/tags/dns/</link><description>Recent content in DNS on Nono Blogs</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Thu, 09 Oct 2025 13:16:16 +0800</lastBuildDate><atom:link href="https://blog.jqknono.com/tags/dns/index.xml" rel="self" type="application/rss+xml"/><item><title>DNS 加密协议对比：DoT、DoH、DoQ</title><link>https://blog.jqknono.com/blog/2025/10/09/dns-%E5%8A%A0%E5%AF%86%E5%8D%8F%E8%AE%AE%E5%AF%B9%E6%AF%94dotdohdoq/</link><pubDate>Thu, 09 Oct 2025 13:16:16 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/10/09/dns-%E5%8A%A0%E5%AF%86%E5%8D%8F%E8%AE%AE%E5%AF%B9%E6%AF%94dotdohdoq/</guid><description>&lt;h2 id="名词速览"&gt;名词速览&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS：明文 DNS，默认使用 UDP/53，必要时用 TCP/53（如响应被截断、区域传送等）。&lt;/li&gt;
&lt;li&gt;DoT：DNS over TLS，使用 TLS 之上的 TCP，默认端口 853（RFC 7858/8310）。&lt;/li&gt;
&lt;li&gt;DoH：DNS over HTTPS，基于 HTTPS（HTTP/2 或 HTTP/3），默认端口 443（RFC 8484）。&lt;/li&gt;
&lt;li&gt;DoQ：DNS over QUIC，基于 QUIC + TLS 1.3，默认端口 UDP/853（RFC 9250，IANA 已分配在 853/udp）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="分层关系简化-tcpip-模型"&gt;分层关系（简化 TCP/IP 模型）&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;应用层：HTTP、HTTPS、DNS（DoH 属于 HTTPS 应用层封装）&lt;/li&gt;
&lt;li&gt;安全层：TLS（为 TCP 或 QUIC 提供加密）&lt;/li&gt;
&lt;li&gt;传输层：TCP、UDP、QUIC&lt;/li&gt;
&lt;li&gt;网络层：IP&lt;/li&gt;
&lt;li&gt;链路层：以太网等&lt;/li&gt;
&lt;li&gt;物理层：双绞线/光纤/无线等&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="要点"&gt;要点&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS 工作在 UDP/TCP 之上，不加密。&lt;/li&gt;
&lt;li&gt;DoT = TCP + TLS + DNS（专用端口 853）。&lt;/li&gt;
&lt;li&gt;DoH = TCP/QUIC + TLS + HTTP(S) + DNS（走 443，与普通 HTTPS 共端口）。&lt;/li&gt;
&lt;li&gt;DoQ = QUIC + TLS 1.3 + DNS（专用端口 UDP/853）。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TB
 subgraph 应用层
 A[HTTP]
 A2[HTTPS]
 C[DNS]
 D[DoH DNS over HTTPS]
 end

 subgraph 安全层
 E[TLS]
 end

 subgraph 传输层
 F[TCP]
 G[UDP]
 H[QUIC]
 end

 subgraph 网络层
 I[IP]
 end

 subgraph 链路层
 J[Ethernet]
 end

 subgraph 物理层
 K[双绞线/光纤/无线]
 end

 A2 --&amp;gt; F
 A2 --&amp;gt; H
 A --&amp;gt; F
 C --&amp;gt; F
 C --&amp;gt; G
 D --&amp;gt; A2
 E --&amp;gt; F
 E --&amp;gt; H
 F --&amp;gt; I
 G --&amp;gt; I
 H --&amp;gt; I
 I --&amp;gt; J
 J --&amp;gt; K

 style D fill:#e1f5fe
 style E fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="基础知识与勘误"&gt;基础知识与勘误&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS 默认走 UDP/53，遇到响应截断（TC 位）或需要可靠传输时会改用 TCP/53。&lt;/li&gt;
&lt;li&gt;DoT 在 TCP 之上建立 TLS 隧道传输 DNS 报文，默认端口 853；可以复用长连接以降低握手开销。&lt;/li&gt;
&lt;li&gt;DoH 把 DNS 作为 HTTPS 的一种资源（&lt;code&gt;application/dns-message&lt;/code&gt;），通常使用 HTTP/2 或 HTTP/3，端口 443，易与普通 HTTPS 混同。&lt;/li&gt;
&lt;li&gt;DoQ 直接使用 QUIC（基于 UDP）承载 DNS，具备低时延与避免队头阻塞的优势，但当前生态覆盖仍在增长中。&lt;/li&gt;
&lt;li&gt;“QUIC 就一定比 TCP 快 X%”这类笼统结论并不准确；实际表现与网络状况（丢包、抖动、RTT）、连接是否可复用、实现细节和服务端部署有关。&lt;/li&gt;
&lt;li&gt;DoH 并非“把 DNS 放进 HTTP 就一定更慢/更快”，性能取决于连接复用、网络质量与实现；很多情况下 DoH/3 与 DoT 体验相近甚至更好。&lt;/li&gt;
&lt;li&gt;DoT 可以使用 SNI 验证证书主机名；DoH 则依赖 HTTPS 的常规证书校验与主机名匹配。&lt;/li&gt;
&lt;li&gt;加密 DNS 只能防止链路上的窃听与篡改，不等于“完全匿名”。解析器仍可能记录查询；请选可信提供商并查看隐私政策。&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TD
 subgraph DNS 家族
 A[Plain DNS UDP/TCP &amp;#43; DNS]

 subgraph 加密的 DNS
 B[DoT TCP &amp;#43; TLS &amp;#43; DNS]
 C[DoH HTTP/2,3 &amp;#43; TLS &amp;#43; DNS]
 D[DoQ QUIC &amp;#43; TLS 1.3 &amp;#43; DNS]
 end

 subgraph 传输基座
 E[TCP]
 F[UDP]
 G[QUIC]
 end
 end

 A --&amp;gt; B
 A --&amp;gt; C
 A --&amp;gt; D

 B --&amp;gt; E
 C --&amp;gt; E
 C --&amp;gt; G
 D --&amp;gt; G
 A --&amp;gt; F

 style A fill:#f3e5f5
 style B fill:#e8f5e8
 style C fill:#e3f2fd
 style D fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="对比总览"&gt;对比总览&lt;/h2&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;协议&lt;/th&gt;
 &lt;th&gt;传输层&lt;/th&gt;
 &lt;th&gt;加密&lt;/th&gt;
 &lt;th&gt;封装&lt;/th&gt;
 &lt;th&gt;默认端口&lt;/th&gt;
 &lt;th&gt;典型特点&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Plain DNS&lt;/td&gt;
 &lt;td&gt;UDP/TCP&lt;/td&gt;
 &lt;td&gt;无&lt;/td&gt;
 &lt;td&gt;DNS 原生&lt;/td&gt;
 &lt;td&gt;53&lt;/td&gt;
 &lt;td&gt;简单高效，明文可见，易被篡改/审计&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoT&lt;/td&gt;
 &lt;td&gt;TCP&lt;/td&gt;
 &lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
 &lt;td&gt;DNS&lt;/td&gt;
 &lt;td&gt;853&lt;/td&gt;
 &lt;td&gt;专用端口，易被端口封锁，系统级支持较好&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoH&lt;/td&gt;
 &lt;td&gt;TCP/QUIC&lt;/td&gt;
 &lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
 &lt;td&gt;HTTP/2-3 + DNS&lt;/td&gt;
 &lt;td&gt;443&lt;/td&gt;
 &lt;td&gt;与 HTTPS 共端口，穿透性强，浏览器优先支持&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoQ&lt;/td&gt;
 &lt;td&gt;QUIC&lt;/td&gt;
 &lt;td&gt;TLS 1.3&lt;/td&gt;
 &lt;td&gt;DNS&lt;/td&gt;
 &lt;td&gt;853/UDP&lt;/td&gt;
 &lt;td&gt;低时延、避免队头阻塞，生态在发展&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="性能与时延"&gt;性能与时延&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;连接复用：DoT/DoH/DoQ 均可复用长连接以降低握手成本；DoH/2、DoH/3 和 DoQ 还能在单连接内多路复用请求。&lt;/li&gt;
&lt;li&gt;队头阻塞：TCP 存在应用层“队头阻塞”问题；HTTP/2 在 TCP 上通过多路复用缓解但仍受 TCP 的丢包影响，QUIC（DoH/3、DoQ）在传输层避免了队头阻塞，对高丢包/移动网络更友好。&lt;/li&gt;
&lt;li&gt;首包时延：首连时 DoT 需要 TCP+TLS 握手；DoH/2 类似；DoH/3/DoQ 基于 QUIC，重连和迁移更快。长期负载下差异更多取决于实现与网络条件。&lt;/li&gt;
&lt;li&gt;可达性：DoH 使用 443 端口，最不易被简单端口封锁；DoT 使用 853，常被一刀切阻断；DoQ 使用 853/UDP，现阶段也可能被阻断或未放行。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="客户端与系统支持"&gt;客户端与系统支持&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;浏览器：Chromium 家族与 Firefox 默认内置 DoH（可自动升级到支持 DoH 的解析器或使用内置名单提供商）。&lt;/li&gt;
&lt;li&gt;Windows：Windows 11 原生支持 DoH。&lt;/li&gt;
&lt;li&gt;Android：Android 9+ 提供“私有 DNS”（系统级 DoT）。系统级 DoH 的覆盖取决于版本/厂商。&lt;/li&gt;
&lt;li&gt;Apple 平台：iOS 14+/macOS 11+ 通过描述文件或 NetworkExtension 支持 DoT 与 DoH。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="部署与选型建议"&gt;部署与选型建议&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;常规/受限网络（如公共 Wi‑Fi、需要穿透简单封锁）：优先 DoH（端口 443），可启用 HTTP/3。&lt;/li&gt;
&lt;li&gt;系统级统一出口（路由器、网关、Android 私有 DNS）：优先 DoT（853），若网络允许可加配 DoH 作为回退。&lt;/li&gt;
&lt;li&gt;高丢包/移动网络：优先具备 QUIC 的 DoH/3 或 DoQ（取决于解析器与客户端支持）。&lt;/li&gt;
&lt;li&gt;企业/合规场景：按策略选择（DoH 可与现有 HTTPS 基础设施融合；DoT 便于与 DNS 控制面分离）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="小结"&gt;小结&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;首选 DoH（443，穿透性强），若可用则启用 HTTP/3。&lt;/li&gt;
&lt;li&gt;如果需要系统级统一：优先 DoT（853）+ 持久连接，必要时回退 DoH（443）。&lt;/li&gt;
&lt;li&gt;若你的解析器与客户端均支持：尝试 DoQ（移动网络体验常更佳）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="参考标准"&gt;参考标准&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RFC 7858, RFC 8310（DNS over TLS）&lt;/li&gt;
&lt;li&gt;RFC 8484（DNS over HTTPS）&lt;/li&gt;
&lt;li&gt;RFC 9250（DNS over QUIC）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="dns-服务推荐"&gt;DNS 服务推荐&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;宁屏 DNS: &lt;a href="https://www.nullprivate.com"&gt;https://www.nullprivate.com&lt;/a&gt; 支持 DoT, DoH(支持 HTTP3), 原生支持去广告与分流.&lt;/li&gt;
&lt;li&gt;自部署版本: &lt;a href="https://github.com/NullPrivate/NullPrivate"&gt;https://github.com/NullPrivate/NullPrivate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>是否必须有域名才能使用DDNS?</title><link>https://blog.jqknono.com/blog/2025/08/27/%E6%98%AF%E5%90%A6%E5%BF%85%E9%A1%BB%E6%9C%89%E5%9F%9F%E5%90%8D%E6%89%8D%E8%83%BD%E4%BD%BF%E7%94%A8ddns/</link><pubDate>Wed, 27 Aug 2025 18:39:29 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/08/27/%E6%98%AF%E5%90%A6%E5%BF%85%E9%A1%BB%E6%9C%89%E5%9F%9F%E5%90%8D%E6%89%8D%E8%83%BD%E4%BD%BF%E7%94%A8ddns/</guid><description>&lt;h2 id="引言"&gt;引言&lt;/h2&gt;
&lt;p&gt;动态DNS（DDNS）通常需要购买域名，但现在有一种更简单的方法：无需域名即可实现DDNS。本文将介绍如何使用NullPrivate或AdGuardHome等服务来实现这一功能。&lt;/p&gt;
&lt;h2 id="核心概念"&gt;核心概念&lt;/h2&gt;
&lt;p&gt;无需域名DDNS是指不购买传统公共域名，而是利用私有DNS服务来实现动态域名解析。这种方法具有以下特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;无需购买域名&lt;/strong&gt;：使用私有域名或伪域名&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;隐私保护&lt;/strong&gt;：只有连接到私有DNS服务的用户才能解析&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;立即生效&lt;/strong&gt;：更改无缓存时间，无需等待DNS传播&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="支持的服务"&gt;支持的服务&lt;/h2&gt;
&lt;h3 id="nullprivate"&gt;NullPrivate&lt;/h3&gt;
&lt;p&gt;NullPrivate是一个私有DNS服务，提供基础的DNS重写功能。通过其DNS重写功能，可以实现DDNS。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自部署或SaaS服务都可&lt;/li&gt;
&lt;li&gt;直接从服务界面下载DDNS脚本运行&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://share.jqknono.com/image/blog/202508271902578.webp" alt="NullPrivate"&gt;&lt;/p&gt;
&lt;h3 id="adguardhome"&gt;AdGuardHome&lt;/h3&gt;
&lt;p&gt;AdGuardHome是一个开源的DNS服务器，也可以实现类似功能。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;需要自部署AdGuardHome实例&lt;/li&gt;
&lt;li&gt;支持通过脚本配置DDNS&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src="https://share.jqknono.com/image/blog/202508271904602.webp" alt="AdGuardHome"&gt;&lt;/p&gt;
&lt;h2 id="设置步骤"&gt;设置步骤&lt;/h2&gt;
&lt;h3 id="使用nullprivate"&gt;使用NullPrivate&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;确保已部署并运行NullPrivate&lt;/li&gt;
&lt;li&gt;导航到&lt;strong&gt;DNS重写&lt;/strong&gt;页面&lt;/li&gt;
&lt;li&gt;下载DDNS脚本&lt;/li&gt;
&lt;li&gt;运行脚本：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Windows&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;Set-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;Bypass&lt;/span&gt; &lt;span class="n"&gt;-Scope&lt;/span&gt; &lt;span class="k"&gt;Process&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;.\&lt;/span&gt;&lt;span class="nb"&gt;ddns-script&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;ps1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Linux/macOS&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;chmod +x ddns-script.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;./ddns-script.sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="使用adguardhome"&gt;使用AdGuardHome&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;确保已部署并运行AdGuardHome&lt;/li&gt;
&lt;li&gt;从&lt;a href="https://github.com/NullPrivate/nullprivate-ddns/releases"&gt;Release页面&lt;/a&gt;下载脚本&lt;/li&gt;
&lt;li&gt;运行脚本：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Windows&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-powershell" data-lang="powershell"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;Set-ExecutionPolicy&lt;/span&gt; &lt;span class="n"&gt;Bypass&lt;/span&gt; &lt;span class="n"&gt;-Scope&lt;/span&gt; &lt;span class="k"&gt;Process&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;.\&lt;/span&gt;&lt;span class="n"&gt;ddns&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="py"&gt;ps1&lt;/span&gt; &lt;span class="n"&gt;-BaseUrl&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;base_url&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;-Username&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;-Password&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;-Domain&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Linux/macOS&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;chmod +x ddns.sh
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;./ddns.sh -b &amp;lt;base_url&amp;gt; -u &amp;lt;username&amp;gt; -p &amp;lt;password&amp;gt; -d &amp;lt;domain&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="优势对比"&gt;优势对比&lt;/h2&gt;
&lt;p&gt;与传统DDNS相比，此方案具有以下优势：&lt;/p&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;特性&lt;/th&gt;
 &lt;th&gt;传统DDNS&lt;/th&gt;
 &lt;th&gt;无需域名DDNS&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;域名费用&lt;/td&gt;
 &lt;td&gt;需要购买&lt;/td&gt;
 &lt;td&gt;无需购买&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DNS缓存&lt;/td&gt;
 &lt;td&gt;有缓存时间&lt;/td&gt;
 &lt;td&gt;立即生效&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DNS传播&lt;/td&gt;
 &lt;td&gt;需要等待&lt;/td&gt;
 &lt;td&gt;立即可用&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;隐私保护&lt;/td&gt;
 &lt;td&gt;公开解析&lt;/td&gt;
 &lt;td&gt;私有解析&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;设置复杂度&lt;/td&gt;
 &lt;td&gt;相对复杂&lt;/td&gt;
 &lt;td&gt;简单快速&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="工作流程图"&gt;工作流程图&lt;/h2&gt;
&lt;pre class="mermaid"&gt;graph TD
 A[用户拥有动态IP] --&amp;gt; B[部署NullPrivate或AdGuardHome]
 B --&amp;gt; C[下载DDNS脚本]
 C --&amp;gt; D[运行脚本配置DDNS]
 D --&amp;gt; E[脚本定期更新DNS记录]
 E --&amp;gt; F[客户端使用私有域名访问]
 F --&amp;gt; G[DNS解析到当前IP]

 style A fill:#e1f5fe
 style B fill:#f3e5f5
 style C fill:#e8f5e8
 style D fill:#fff3e0
 style E fill:#fce4ec
 style F fill:#e0f2f1
 style G fill:#f3e5f5&lt;/pre&gt;
&lt;h2 id="功能特性"&gt;功能特性&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;快速设置&lt;/strong&gt;：利用现有服务，无需额外配置&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;跨平台支持&lt;/strong&gt;：支持Windows和Unix-like系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;多种认证方式&lt;/strong&gt;：支持cookies或用户名密码认证&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;完全兼容&lt;/strong&gt;：与AdGuardHome无缝集成&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="参考链接"&gt;参考链接&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/NullPrivate/nullprivate-ddns"&gt;GitHub仓库&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.nullprivate.com"&gt;NullPrivate官网&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.nullprivate.com/blog/2025/07/21/%E5%A2%9E%E5%8A%A0%E4%BA%86ddns%E5%8A%9F%E8%83%BD/"&gt;相关博客文章&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>为AdguardHome增加分流能力</title><link>https://blog.jqknono.com/blog/2025/07/10/%E4%B8%BAadguardhome%E5%A2%9E%E5%8A%A0%E5%88%86%E6%B5%81%E8%83%BD%E5%8A%9B/</link><pubDate>Thu, 10 Jul 2025 16:30:07 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/07/10/%E4%B8%BAadguardhome%E5%A2%9E%E5%8A%A0%E5%88%86%E6%B5%81%E8%83%BD%E5%8A%9B/</guid><description>&lt;p&gt;开源地址: &lt;a href="https://github.com/AdGuardPrivate/AdGuardPrivate"&gt;https://github.com/AdGuardPrivate/AdGuardPrivate&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;AdGuardHome 不带分流规则, 只能手写, 或则配置一个 upstream-file, 算是其痛点之一.&lt;/p&gt;
&lt;p&gt;开发支持分流规则这个特性花了不少时间, 也测试了比较久, 总算稳定了.&lt;/p&gt;
&lt;p&gt;有了分流规则, 就不再需要在 AdguardHome 前置 SmartDNS, 一个 AdguardPrivate 就齐活.&lt;/p&gt;
&lt;p&gt;当然现在分流能力仅&lt;strong&gt;支持分 AB 两路&lt;/strong&gt;, 即一部分走 A 上游群, 一部分走 B 上游群. 如果要做更灵活的分流支持, 开发难度会大一些, 实际的分流代码逻辑一部分在 adguardhome 中, 另外一部分在 dnsproxy 中. 两路不能满足需求的话, 可以 fork 了自己尝试做做.&lt;/p&gt;
&lt;p&gt;有使用问题或建议可以提 issue, 目前主要针对特定地区的使用做一些改良.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://i.imgur.com/jhEZB52.png" alt=""&gt;&lt;/p&gt;</description></item><item><title>DNS 入门：互联网的地址簿</title><link>https://blog.jqknono.com/docs/private-service/dns/</link><pubDate>Sat, 24 May 2025 20:04:34 +0800</pubDate><guid>https://blog.jqknono.com/docs/private-service/dns/</guid><description>&lt;h2 id="dns-是什么"&gt;DNS 是什么？&lt;/h2&gt;
&lt;p&gt;欢迎来到我们的 DNS 系列文章！在我们深入探讨技术细节之前，让我们先从一个简单的问题开始：什么是 DNS？&lt;/p&gt;
&lt;p&gt;想象一下，你的手机通讯录。你不需要记住每个朋友的电话号码，只需要记住他们的名字。当你想要打电话给朋友“张三”时，你只需在通讯录里找到他的名字，然后点击拨号。你的手机会自动查找“张三”对应的电话号码并拨打出去。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;DNS（Domain Name System，域名系统）&lt;/strong&gt; 就扮演着类似“互联网通讯录”的角色。它负责将我们容易记忆的网站域名（比如 &lt;code&gt;www.google.com&lt;/code&gt;）“翻译”成计算机能够理解的 IP 地址（比如 &lt;code&gt;172.217.160.78&lt;/code&gt;）。没有 DNS，我们就必须记住一长串毫无规律的数字才能访问网站，这几乎是不可能的。&lt;/p&gt;
&lt;h2 id="dns-如何工作"&gt;DNS 如何工作？&lt;/h2&gt;
&lt;p&gt;这个“翻译”过程通常在幕后飞快地完成。当你-在浏览器中输入一个网址时，大致会发生以下几个步骤：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;请求&lt;/strong&gt;：你的电脑或手机会向一个 DNS 解析器（Resolver）发送请求：“&lt;code&gt;www.example.com&lt;/code&gt; 的 IP 地址是什么？”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;查询&lt;/strong&gt;：DNS 解析器会像一个侦探一样，通过层层查询（从根服务器到顶级域名服务器，再到权威域名服务器）来找到答案。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;响应&lt;/strong&gt;：一旦找到，解析器就会将 IP 地址返回给你的电脑。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;连接&lt;/strong&gt;：你的浏览器使用这个 IP 地址与网站的服务器建立连接，最终将网页内容呈现在你面前。&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="本系列我们将探讨什么"&gt;本系列我们将探讨什么？&lt;/h2&gt;
&lt;p&gt;DNS 的世界远比这个简单的比喻要丰富和复杂。在本系列文章中，我们将带你深入了解 DNS 的方方面面，包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心概念&lt;/strong&gt;：深入理解域名、IP 地址、以及它们之间的关系。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;记录类型&lt;/strong&gt;：学习 A 记录、CNAME 记录、MX 记录等不同 DNS 记录的用途。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;服务器类型&lt;/strong&gt;：了解递归服务器和权威服务器等不同角色的 DNS 服务器。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DNS 查询过程&lt;/strong&gt;：详细拆解一次完整的 DNS 查询是如何进行的。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;DNS 缓存&lt;/strong&gt;：探索 DNS 缓存如何提高网站访问速度。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;私有 DNS&lt;/strong&gt;：如何搭建和使用私有 DNS 服务来增强网络安全和隐私。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;无论你是刚刚接触网络知识的新手，还是希望巩固基础知识的开发者，本系列都将为你提供清晰、易懂的指引。&lt;/p&gt;
&lt;p&gt;让我们开始 DNS 的探索之旅吧！&lt;/p&gt;</description></item><item><title>广告拦截新选择--AdGuardPrivate</title><link>https://blog.jqknono.com/blog/2025/02/20/%E5%B9%BF%E5%91%8A%E6%8B%A6%E6%88%AA%E6%96%B0%E9%80%89%E6%8B%A9--adguardprivate/</link><pubDate>Thu, 20 Feb 2025 19:10:12 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/02/20/%E5%B9%BF%E5%91%8A%E6%8B%A6%E6%88%AA%E6%96%B0%E9%80%89%E6%8B%A9--adguardprivate/</guid><description>&lt;p&gt;&lt;a href="https://www.adguardprivate.com"&gt;AdGuardPrivate&lt;/a&gt; 是一款专注于网络隐私保护与广告拦截的 DNS 服务工具，基于开源项目 &lt;a href="https://github.com/AdguardTeam/AdGuardHome"&gt;AdGuard Home&lt;/a&gt; 二次开发，通过智能流量分析和过滤技术，为用户提供安全、高效的上网环境。以下是其主要功能与特点：&lt;/p&gt;
&lt;h2 id="核心功能广告拦截与隐私保护"&gt;核心功能：广告拦截与隐私保护&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;广告拦截：通过 DNS 层面拦截网页广告（如横幅、弹窗、视频广告等）及移动应用内广告，提升浏览速度和设备性能。&lt;/li&gt;
&lt;li&gt;隐私防护：阻止跟踪器、社交网络插件和隐私窃取请求，防止用户行为数据被收集，同时拦截恶意网站、钓鱼链接和恶意软件。&lt;/li&gt;
&lt;li&gt;DNS 防污染：通过加密 DNS（支持 DoT、DoH、HTTP/3）防止流量劫持，确保域名解析的准确性和安全性。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="进阶特性定制化与优化"&gt;进阶特性：定制化与优化&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;自定义规则：支持用户添加第三方黑白名单或自定义过滤规则，灵活控制特定应用、网站或游戏的访问权限。&lt;/li&gt;
&lt;li&gt;智能解析：可配置局域网设备的友好域名解析（如 NAS 或企业服务器），简化网络管理。&lt;/li&gt;
&lt;li&gt;统计分析：提供详细的请求日志、拦截统计和 72 小时查询记录，帮助用户监控网络使用情况。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="家庭与企业场景支持"&gt;家庭与企业场景支持&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;家长控制：可屏蔽成人网站和游戏，管理家庭成员的上网时间，保护未成年人。&lt;/li&gt;
&lt;li&gt;企业级部署：支持分布式服务器负载均衡，优化大陆地区的访问体验，并通过阿里云节点提供稳定服务。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="平台兼容性与服务模式"&gt;平台兼容性与服务模式&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;跨平台支持：兼容多种操作系统，无需额外软件，仅需配置加密 DNS 即可使用。&lt;/li&gt;
&lt;li&gt;服务模式：&lt;/li&gt;
&lt;li&gt;免费公共服务：提供基础广告拦截与安全规则，但可能存在误拦截问题。&lt;/li&gt;
&lt;li&gt;付费私有服务：增强功能包括自定义解析、权威解析、设备分 ID 记录上网行为等，适合个性化需求。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="技术优势与局限性"&gt;技术优势与局限性&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;优势：全设备覆盖、零额外功耗，降低无效数据加载，适合移动设备续航优化。&lt;/li&gt;
&lt;li&gt;局限性：拦截精度低于浏览器插件，无法实现 HTTPS 内容的深度过滤（如 MITM 方案）。&lt;/li&gt;
&lt;li&gt;应用场景示例
&lt;ul&gt;
&lt;li&gt;个人用户：通过 AdGuardPrivate 阻止移动应用内广告，提升应用体验。&lt;/li&gt;
&lt;li&gt;家庭用户：通过路由器部署 AdGuardPrivate，拦截全家设备的广告，并限制儿童访问不当内容。&lt;/li&gt;
&lt;li&gt;企业网络：结合自定义规则屏蔽娱乐类网站，提升员工工作效率，同时保护内部数据安全。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>使用 curl 获取 DNS 结果</title><link>https://blog.jqknono.com/blog/2025/02/20/%E4%BD%BF%E7%94%A8-curl-%E8%8E%B7%E5%8F%96-dns-%E7%BB%93%E6%9E%9C/</link><pubDate>Thu, 20 Feb 2025 17:08:34 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/02/20/%E4%BD%BF%E7%94%A8-curl-%E8%8E%B7%E5%8F%96-dns-%E7%BB%93%E6%9E%9C/</guid><description>&lt;p&gt;本文介绍两种利用 curl 获取 DNS 查询结果的方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;DNS JSON 格式&lt;/li&gt;
&lt;li&gt;DNS Wire Format 格式&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="1-dns-json-格式查询"&gt;1. DNS JSON 格式查询&lt;/h2&gt;
&lt;p&gt;返回 JSON 格式的 DNS 响应，便于解析。&lt;/p&gt;
&lt;h3 id="google"&gt;Google&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-json&amp;#39;&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;https://dns.google/resolve?name=baidu.com&amp;amp;type=A&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; jq .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="cloudflare"&gt;Cloudflare&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-json&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://cloudflare-dns.com/dns-query?name=baidu.com&amp;amp;type=A&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; jq .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="aliyun"&gt;Aliyun&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s2"&gt;&amp;#34;accept: application/dns-json&amp;#34;&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;https://223.5.5.5/resolve?name=baidu.com&amp;amp;type=1&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; jq .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="dnspub"&gt;dns.pub&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-json&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://doh.dns.pub/dns-query?name=baidu.com&amp;amp;type=A&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; jq .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="adguard-private-dns"&gt;AdGuard Private DNS&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 暂不受支持&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="2-dns-wire-format-格式查询"&gt;2. DNS Wire Format 格式查询&lt;/h2&gt;
&lt;p&gt;返回二进制格式的 DNS 响应，需要进一步解析。&lt;/p&gt;
&lt;h3 id="google-1"&gt;Google&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-message&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://dns.google/dns-query?dns=q80BAAABAAAAAAAAA3d3dwdleGFtcGxlA2NvbQAAAQAB&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; hexdump -c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="cloudflare-1"&gt;Cloudflare&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-message&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://cloudflare-dns.com/dns-query?dns=q80BAAABAAAAAAAAA3d3dwdleGFtcGxlA2NvbQAAAQAB&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; hexdump -c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="aliyun-1"&gt;Aliyun&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-message&amp;#39;&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;https://dns.alidns.com/dns-query?dns=P8QBAAABAAAAAAAABWJhaWR1A2NvbQAAAQAB&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; hexdump -c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="dnspub-1"&gt;dns.pub&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-message&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://doh.dns.pub/dns-query?dns=q80BAAABAAAAAAAAA3d3dwdleGFtcGxlA2NvbQAAAQAB&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; hexdump -c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="adguard-private-dns-1"&gt;AdGuard Private DNS&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;curl -H &lt;span class="s1"&gt;&amp;#39;accept: application/dns-message&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;https://public0.adguardprivate.com/dns-query?dns=q80BAAABAAAAAAAAA3d3dwdleGFtcGxlA2NvbQAAAQAB&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; hexdump -c
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="使用-python-解析-dns-响应"&gt;使用 Python 解析 DNS 响应&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# pip install dnspython&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# pip install requests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 解析 JSON 格式响应&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;query_dns_json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;example.com&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;使用 JSON 格式查询 DNS&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;https://dns.google/resolve&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;accept&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;application/dns-json&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;indent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 解析 Wire Format 响应&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;query_dns_wire&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;example.com&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;使用 Wire Format 格式查询 DNS&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;dns.message&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 创建DNS查询消息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;domain&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;A&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;wire_format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_wire&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dns_query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;base64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b64encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wire_format&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 发送请求&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;https://dns.google/dns-query&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;dns&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;dns_query&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;accept&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;application/dns-message&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="n"&gt;dns_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_wire&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dns_response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;__main__&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;JSON格式查询结果:&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query_dns_json&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;Wire Format查询结果:&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query_dns_wire&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="生成-dns-wire-format-base64-编码的数据"&gt;生成 DNS Wire Format Base64 编码的数据&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# pip install dnspython&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;dns.message&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;dns.rdatatype&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 创建一个DNS查询消息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_query&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;example.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dns&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rdatatype&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 将消息转换为Wire Format&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;wire_format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_wire&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 转为base64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="n"&gt;wire_format_base64&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;base64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b64encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wire_format&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 打印&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wire_format_base64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>如何使用必应国际版</title><link>https://blog.jqknono.com/blog/2025/02/20/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BF%85%E5%BA%94%E5%9B%BD%E9%99%85%E7%89%88/</link><pubDate>Thu, 20 Feb 2025 15:03:04 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/02/20/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BF%85%E5%BA%94%E5%9B%BD%E9%99%85%E7%89%88/</guid><description>&lt;p&gt;有些搜索引擎不思进取，能搜到的有价值的内容越来越少，广告却越来越多。相信不少人都已逐渐放弃这类搜索引擎，转而使用必应（bing.com)。&lt;/p&gt;
&lt;p&gt;但必应有多个版本：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://cn.bing.com"&gt;cn.bing.com&lt;/a&gt; 是中国版，搜索结果经过审查。
&lt;ul&gt;
&lt;li&gt;国内版：主要搜索中文内容。
&lt;img src="https://img1.techfetch.dev/blog/202502201527190.png" alt=""&gt;&lt;/li&gt;
&lt;li&gt;国际版：同时支持搜索中文和英文内容。
&lt;img src="https://img1.techfetch.dev/blog/202502201530275.png" alt=""&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.bing.com"&gt;www.bing.com&lt;/a&gt; 这是真正的国际版，搜索结果没有中国大陆的审查，可以搜索到更多“你懂的”内容。
&lt;img src="https://img1.techfetch.dev/blog/202502201535693.png" alt=""&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这三个版本的搜索结果会有所区别。对于具备英文阅读能力的用户，强烈推荐使用国际版，能获取到更有价值的资料。&lt;/p&gt;
&lt;p&gt;我就不详细展开真国际版搜索内容的差异了，有兴趣的朋友可以自行尝试。&lt;/p&gt;
&lt;p&gt;真国际版还提供 &lt;code&gt;Microsoft Copilot&lt;/code&gt; 的入口，类似于 &lt;code&gt;ChatGPT&lt;/code&gt; 的功能，可以帮你总结搜索结果。虽然有使用频次限制，但正常使用是足够的。&lt;/p&gt;
&lt;p&gt;国内版和国际版的切换没有难度，这里主要介绍如何使用必应真正的国际版。&lt;/p&gt;
&lt;p&gt;相信不少人在设置里折腾了很久，但还是无法使用国际版，这可能是方向错了。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://img1.techfetch.dev/blog/202502201533833.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;真正的限制在于 DNS。DNS 可以根据请求者的所在地域，给出不同的解析结果。例如，山东和河南请求 &lt;code&gt;qq.com&lt;/code&gt; 的 IP 地址可能不一样。通常，DNS 会返回在地理位置上更靠近的服务器 IP。&lt;/p&gt;
&lt;p&gt;因此，如果你想使用国际版，可以尝试将 DNS 更换为 Google 的 &lt;code&gt;tls://dns.google&lt;/code&gt; 或者 Cloudflare 的 &lt;code&gt;tls://one.one.one.one&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;这里只提供了两个 DNS 服务商的加密 DNS 地址，没有提供纯 IP 的 DNS，因为纯 IP 的海外 DNS 很容易被劫持，分享 &lt;code&gt;8.8.8.8&lt;/code&gt; 和 &lt;code&gt;1.1.1.1&lt;/code&gt; 毫无意义。&lt;/p&gt;
&lt;p&gt;DNS 的设置方法可以参考 &lt;a href="https://www.adguardprivate.com/docs/startup/free/android/"&gt;如何配置 DNS 加密&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;注意，最简单的使用国际版必应的方法是使用加密 DNS，也有其他方法，本文不展开。&lt;/p&gt;
&lt;p&gt;如果一个 DNS 不可用，可以依次尝试以下几个设置：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;tls://dns.google&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls://one.one.one.one&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls://8.8.8.8&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls://8.8.4.4&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls://1.1.1.1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls://1.0.0.1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;通常会有两个能连接成功。如果全部无法连接，那只能寻找其他方法了。&lt;/p&gt;</description></item><item><title>工具</title><link>https://blog.jqknono.com/blog/tools/dns/</link><pubDate>Thu, 20 Feb 2025 15:02:33 +0800</pubDate><guid>https://blog.jqknono.com/blog/tools/dns/</guid><description/></item><item><title>DoT vs DoH vs DoQ</title><link>https://blog.jqknono.com/docs/private-service/dns/dot-vs-doh-vs-doq/</link><pubDate>Wed, 13 Nov 2024 11:35:36 +0800</pubDate><guid>https://blog.jqknono.com/docs/private-service/dns/dot-vs-doh-vs-doq/</guid><description>&lt;h2 id="dot"&gt;DoT&lt;/h2&gt;
&lt;p&gt;DNS over TLS（DoT）是一种基于 TLS 的 DNS 加密协议。TLS 1.2 至少需要四次往返，TLS 1.3 则至少需要三次往返，而 DNS 请求仅需一次往返。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;时间轴
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ↓
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ┌───────────────────────────────────────────────────────────────────────┐
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端 服务器
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送 SYN 段 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ SYN = 1, Seq = x │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器响应 SYN-ACK 段 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ SYN = 1, ACK = 1, Seq = y, Ack = x + 1 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送 ACK 段 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ACK = 1, Seq = x + 1, Ack = y + 1 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ TCP 连接建立 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送 ClientHello │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器响应 ServerHello │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器发送证书链 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送密钥交换消息 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器发送密钥交换消息 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送 Finished │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器发送 Finished │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ TLS 握手完成 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 客户端发送 DNS 查询 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ 服务器响应 DNS 查询 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; └───────────────────────────────────────────────────────────────────────┘
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;TLS 1.2 的握手过程需要至少两个往返（RTT），即客户端发送 ClientHello，服务器回复 ServerHello 和证书，然后客户端发送 ClientKeyExchange 和 ChangeCipherSpec，最后服务器发送 Finished。TLS 1.3 将握手过程简化为一个往返（1-RTT）。客户端在发送 ClientHello 时可以包含密钥共享信息（ClientKeyShare），服务器在回复 ServerHello 时也包含密钥共享信息，从而在第一个往返内完成密钥协商和握手。&lt;/p&gt;</description></item><item><title>最快的DNS</title><link>https://blog.jqknono.com/docs/private-service/dns/fastest-dns/</link><pubDate>Sun, 10 Nov 2024 19:12:42 +0800</pubDate><guid>https://blog.jqknono.com/docs/private-service/dns/fastest-dns/</guid><description>&lt;p&gt;普通用户通常测量的是明文 DNS 的 IP 的 ping 相应速度，但这很难保证是否是真正到达对应服务器的速度。现代 DNS 至少需要使用加密 DNS 才能确保服务未被劫持。&lt;/p&gt;
&lt;p&gt;从客户端到终端通常会经过 5 到 8 个网络设备，在其中任意一个设备上都可以劫持 UDP:53 请求，这种劫持命令非常简单。因此，不要对明文 DNS 抱有任何侥幸的期待，特别是企业用户，基本上都会遭遇劫持。&lt;/p&gt;
&lt;p&gt;以下是劫持命令示例：
&lt;code&gt;sudo iptables -t nat -A PREROUTING -p udp --dport 53 -j DNAT --to-destination 1.1.1.1:53&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;设置劫持非常简单，许多企业内网用户的 DNS 速度都在个位数毫秒范围内，而在家庭网络中通常小于 1 毫秒。无论配置什么明文 DNS，最终都是自建的 DNS 服务在响应。&lt;/p&gt;
&lt;p&gt;接下来讨论加密 DNS 的速度。在讨论之前，先介绍三种常见的加密 DNS 协议：DNS over TLS (DoT)、DNS over HTTP (DoH) 和 DNS over QUIC (DoQ)。&lt;/p&gt;
&lt;p&gt;理论上，三种加密协议和未加密 DNS 的简化实现方式:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;最快的是 DoQ。QUIC 基于 UDP，建立连接需要一次往返，DNS 请求只需一次往返。&lt;/li&gt;
&lt;li&gt;DoT 建立连接, tls1.2 需要至少四次往返, tls1.3 需要三次往返，略慢于 DoQ，DNS 请求一次往返。&lt;/li&gt;
&lt;li&gt;DoH 基于 HTTPS，建立连接需要至少四次往返, 由于 HTTP 协议较重, 导致服务会略慢于 DoT。&lt;/li&gt;
&lt;li&gt;传统的 UDP:53 不需要建立连接，只有一次往返。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;也就是说，从零开始的 DNS 请求，加密 DNS 的耗时是未加密 DNS 的 2~4 倍左右，但在建立连接后，耗时与未加密 DNS 相同（未考虑连接强制关闭的情况）。&lt;/p&gt;</description></item></channel></rss>