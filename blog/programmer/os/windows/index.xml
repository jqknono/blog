<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>windows on Nono Blogs</title><link>https://blog.jqknono.com/blog/programmer/os/windows/</link><description>Recent content in windows on Nono Blogs</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Mon, 26 May 2025 11:42:26 +0800</lastBuildDate><atom:link href="https://blog.jqknono.com/blog/programmer/os/windows/index.xml" rel="self" type="application/rss+xml"/><item><title>Windows SSH Remote Login</title><link>https://blog.jqknono.com/blog/2025/05/26/windows-ssh-remote-login/</link><pubDate>Mon, 26 May 2025 11:42:26 +0800</pubDate><guid>https://blog.jqknono.com/blog/2025/05/26/windows-ssh-remote-login/</guid><description>&lt;p>Enabling SSH remote access on Windows typically requires Windows&amp;rsquo; built-in OpenSSH feature. Below are step-by-step instructions:&lt;/p>
&lt;h2 id="check-and-install-openssh">Check and Install OpenSSH&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Check whether OpenSSH is already installed&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>Open &lt;strong>Settings&lt;/strong> &amp;gt; &lt;strong>Apps&lt;/strong> &amp;gt; &lt;strong>Apps &amp;amp; features&lt;/strong> &amp;gt; &lt;strong>Manage optional features&lt;/strong>.&lt;/li>
&lt;li>Look for &lt;strong>OpenSSH Server&lt;/strong> in the list. If found, it is already installed.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Install OpenSSH&lt;/strong>:&lt;/p>
&lt;ul>
&lt;li>If &lt;strong>OpenSSH Server&lt;/strong> is not listed, click &lt;strong>Add a feature&lt;/strong>, locate &lt;strong>OpenSSH Server&lt;/strong> in the list, click it, then click &lt;strong>Install&lt;/strong>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="start-and-configure-the-openssh-service">Start and Configure the OpenSSH Service&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Start the OpenSSH service&lt;/strong>:&lt;/p></description></item><item><title>Understanding Windows Networking_WFP</title><link>https://blog.jqknono.com/blog/2024/06/28/understanding-windows-networking_wfp/</link><pubDate>Fri, 28 Jun 2024 17:16:15 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/understanding-windows-networking_wfp/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Understanding Windows Networking_WFP&lt;/li>
&lt;/ul>
&lt;h1 id="understanding-windows-networking">Understanding Windows Networking&lt;/h1>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Understanding Windows Networking&lt;/li>
&lt;/ul>
&lt;h2 id="wfp">WFP&lt;/h2>
&lt;h3 id="terminology">Terminology&lt;/h3>
&lt;p>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/fwp/object-model">https://learn.microsoft.com/en-us/windows/win32/fwp/object-model&lt;/a>&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows/win32/fwp/basic-operation">https://learn.microsoft.com/en-us/windows/win32/fwp/basic-operation&lt;/a>&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network">https://learn.microsoft.com/en-us/windows-hardware/drivers/network&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/callout">callout&lt;/a>: A callout provides functionality that extends the capabilities of the Windows Filtering Platform. A callout consists of a set of callout functions and a GUID key that uniquely identifies the callout.&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/callout-driver">callout driver&lt;/a>: A callout driver is a driver that registers callouts with the Windows Filtering Platform. A callout driver is a type of filter driver.&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/callout-function">callout function&lt;/a>: A callout function is a function that is called by the Windows Filtering Platform to perform a specific task. A callout function is associated with a callout.&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/filter">filter&lt;/a>: A filter is a set of functions that are called by the Windows Filtering Platform to perform filtering operations. A filter consists of a set of filter functions and a GUID key that uniquely identifies the filter.&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/filter-engine">filter engine&lt;/a>: The filter engine is the component of the Windows Filtering Platform that performs filtering operations. The filter engine is responsible for calling the filter functions that are registered with the Windows Filtering Platform.&lt;br>
&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/network/filter-layer">filter layer&lt;/a>: A filter layer is a set of functions that are called by the Windows Filtering Platform to perform filtering operations. A filter layer consists of a set of filter layer functions and a GUID key that uniquely identifies the filter layer.&lt;/p></description></item><item><title>Understanding Windows Event Tracing (ETW)</title><link>https://blog.jqknono.com/blog/2024/06/28/understanding-windows-event-tracing-etw/</link><pubDate>Fri, 28 Jun 2024 17:12:21 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/understanding-windows-event-tracing-etw/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Understanding Windows Event Tracing (ETW)&lt;/li>
&lt;/ul>
&lt;h1 id="understanding-etw">Understanding ETW&lt;/h1>
&lt;p>Some unnecessary information has been filtered out; see the complete documentation at: &lt;a href="https://docs.microsoft.com/en-us/windows/win32/etw/event-tracing-portal">https://docs.microsoft.com/en-us/windows/win32/etw/event-tracing-portal&lt;/a>&lt;/p>
&lt;h2 id="understanding-the-basics">Understanding the Basics&lt;/h2>
&lt;p>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/about-event-tracing">https://learn.microsoft.com/en-us/windows/win32/etw/about-event-tracing&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://learn.microsoft.com/en-us/windows/win32/etw/images/etdiag2.png" alt="Architecture">&lt;/p>
&lt;h2 id="session">Session&lt;/h2>
&lt;p>There are four kinds of sessions:&lt;/p>
&lt;table>
 &lt;thead>
 &lt;tr>
 &lt;th>Session Type&lt;/th>
 &lt;th>Usage&lt;/th>
 &lt;th>Limitations&lt;/th>
 &lt;th>Characteristics&lt;/th>
 &lt;/tr>
 &lt;/thead>
 &lt;tbody>
 &lt;tr>
 &lt;td>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-an-event-tracing-session">Event Tracing Session&lt;/a>(Standard ETW)&lt;/td>
 &lt;td>1. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/ns-evntrace-event_trace_properties">EVENT_TRACE_PROPERTIES&lt;/a>&lt;br>2. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-starttracea">StartTrace&lt;/a>: create a session&lt;br>3. EnableTrace&lt;br> 1. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-enabletrace">EnableTrace&lt;/a> for classic providers&lt;br> 2. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-enabletraceex">EnableTraceEx&lt;/a> for manifest-based providers&lt;br>4. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-controltracea">ControlTrace&lt;/a> stop the session&lt;/td>
 &lt;td>- A manifest-based provider can deliver events to at most 8 sessions.&lt;br>- A classic provider can only serve one session.&lt;br>- The last session to enable a provider supersedes any earlier sessions.&lt;/td>
 &lt;td>Standard ETW.&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-a-systemtraceprovider-session">SystemTraceProvider Session&lt;/a>&lt;/td>
 &lt;td>1. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/ns-evntrace-event_trace_properties">EVENT_TRACE_PROPERTIES&lt;/a> → &lt;strong>EnableFlags&lt;/strong>&lt;br>2. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-starttracea">StartTrace&lt;/a>&lt;br>3. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-controltracea">ControlTrace&lt;/a> to stop the session&lt;/td>
 &lt;td>- &lt;strong>SystemTraceProvider&lt;/strong> is a kernel-mode provider that supplies a set of &lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/nt-kernel-logger-constants">predefined kernel events&lt;/a>.&lt;br>- The &lt;strong>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-the-nt-kernel-logger-session">NT Kernel Logger session&lt;/a>&lt;/strong> is a predefined system session that records a specified set of kernel events.&lt;br>- &lt;strong>Windows 7/Windows Server 2008 R2&lt;/strong> only the NT Kernel Logger session may use SystemTraceProvider.&lt;br>- &lt;strong>Windows 8/Windows Server 2012&lt;/strong> SystemTraceProvider can feed &lt;strong>8 logger sessions&lt;/strong>, two of which are reserved for NT Kernel Logger and Circular Kernel Context Logger.&lt;br>- &lt;strong>Windows 10 20348 and later&lt;/strong>, individual System providers can be controlled separately.&lt;/td>
 &lt;td>Obtain kernel predefined events.&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-an-autologger-session">AutoLogger Session&lt;/a>&lt;/td>
 &lt;td>1. Edit the registry&lt;br>2. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-enabletraceex">EnableTraceEx&lt;/a>&lt;br>3. &lt;a href="https://learn.microsoft.com/en-us/windows/win32/api/evntrace/nf-evntrace-controltracea">ControlTrace&lt;/a> to stop the session&lt;/td>
 &lt;td>- The &lt;strong>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-the-global-logger-session">Global Logger Session&lt;/a>&lt;/strong> is a special, standalone session that records events during system boot.&lt;br>- Ordinary AutoLogger sessions must explicitly enable providers; Global Logger does not.&lt;br>- AutoLogger does not support NT Kernel Logger events; only Global Logger does.&lt;br>- Impacts boot time—use sparingly.&lt;/td>
 &lt;td>Record OS boot-time events.&lt;/td>
 &lt;/tr>
 &lt;tr>
 &lt;td>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-a-private-logger-session">Private Logger Session&lt;/a>&lt;/td>
 &lt;td>—&lt;/td>
 &lt;td>- User-mode ETW&lt;br>- Used only within a process&lt;br>- Not counted toward the 64-session concurrency limit.&lt;/td>
 &lt;td>Per-process only.&lt;/td>
 &lt;/tr>
 &lt;/tbody>
&lt;/table>
&lt;h2 id="tools">Tools&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/logman">logman&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/wevtutil">wevtutil&lt;/a>
&lt;ul>
&lt;li>XPath query example: &lt;code>wevtutil qe Security /c:2 /q:&amp;quot;*[System[EventID=5157]]&amp;quot; /f:text&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/tracelog">tracelog&lt;/a>
&lt;ul>
&lt;li>To use the Visual Studio &lt;code>tracelog&lt;/code> tool, you can dynamically add and remove ETW Providers and ETW Sessions at runtime.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/wes/message-compiler--mc-exe-">mc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/repnz/etw-providers-docs">etw-providers-docs&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>wireguard configuration</title><link>https://blog.jqknono.com/blog/2024/06/28/wireguard-configuration/</link><pubDate>Fri, 28 Jun 2024 17:11:32 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/wireguard-configuration/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> wireguard configuration&lt;/li>
&lt;/ul>
&lt;h1 id="wireguard-configuration">wireguard Configuration&lt;/h1>
&lt;h2 id="firewall-configuration">Firewall Configuration&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">wireguard&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">installtunnelservice&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">wg_conf_path&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wg&lt;/span> &lt;span class="n">show&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-NetConnectionProfile&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-NetAdapter&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Get-NetFirewallProfile&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Set-NetFirewallProfile&lt;/span> &lt;span class="n">-Profile&lt;/span> &lt;span class="n">domain&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">public&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">private&lt;/span> &lt;span class="n">-DisabledInterfaceAliases&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">wg_config_name&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">Set-NetIPInterface&lt;/span> &lt;span class="n">-ifindex&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="n">interface&lt;/span> &lt;span class="n">index&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="n">-Forwarding&lt;/span> &lt;span class="n">Enabled&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">New-NetFirewallRule&lt;/span> &lt;span class="n">-DisplayName&lt;/span> &lt;span class="s2">&amp;#34;@wg1&amp;#34;&lt;/span> &lt;span class="n">-Direction&lt;/span> &lt;span class="n">Inbound&lt;/span> &lt;span class="n">-RemoteAddress&lt;/span> &lt;span class="mf">10.66&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">66&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mf">1&lt;/span>&lt;span class="p">/&lt;/span>&lt;span class="mf">24&lt;/span> &lt;span class="n">-Action&lt;/span> &lt;span class="n">Allow&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">New-NetFirewallRule&lt;/span> &lt;span class="n">-DisplayName&lt;/span> &lt;span class="s2">&amp;#34;@wg1&amp;#34;&lt;/span> &lt;span class="n">-Direction&lt;/span> &lt;span class="n">Outbound&lt;/span> &lt;span class="n">-RemoteAddress&lt;/span> &lt;span class="mf">10.66&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">66&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="mf">1&lt;/span>&lt;span class="p">/&lt;/span>&lt;span class="mf">24&lt;/span> &lt;span class="n">-Action&lt;/span> &lt;span class="n">Allow&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Locate the blocking cause&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">auditpol&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="nb">set &lt;/span>&lt;span class="p">/&lt;/span>&lt;span class="n">subcategory&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="s2">&amp;#34;{0CCE9225-69AE-11D9-BED3-505054503030}&amp;#34;&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">success&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="n">disable&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">failure&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="n">enable&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">wevtutil&lt;/span> &lt;span class="n">qe&lt;/span> &lt;span class="n">Security&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">q:&lt;/span>&lt;span class="s2">&amp;#34;*[System/EventID=5152]&amp;#34;&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">c:&lt;/span>&lt;span class="mf">5&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">rd&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="n">true&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">f:text&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">auditpol&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="nb">set &lt;/span>&lt;span class="p">/&lt;/span>&lt;span class="n">subcategory&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="s2">&amp;#34;{0CCE9225-69AE-11D9-BED3-505054503030}&amp;#34;&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">success&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="n">disable&lt;/span> &lt;span class="p">/&lt;/span>&lt;span class="n">failure&lt;/span>&lt;span class="err">:&lt;/span>&lt;span class="n">disable&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Windows Blocking Network Traffic Capture</title><link>https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/</link><pubDate>Fri, 28 Jun 2024 17:10:46 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Windows Blocking Network Traffic Capture&lt;/li>
&lt;/ul>
&lt;h1 id="windows-blocking-network-traffic-capture">Windows Blocking Network Traffic Capture&lt;/h1>
&lt;!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
&lt;!-- code_chunk_output -->
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-windows-blocking-network-traffic-capture-">Windows Blocking Network Traffic Capture&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-setting-up-a-test-project-">Setting Up a Test Project&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-capturing-block-events-via-auditing-">Capturing Block Events via Auditing&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-obtaining-provider-information-">Obtaining Provider Information&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-triggering-a-block-event-">Triggering a Block Event&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-monitoring-network-eventsnet_event-">Monitoring Network Events (NET_EVENT)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-monitoring-network-connectionsnetconnection-">Monitoring Network Connections (NetConnection)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-application-layer-enforcementale-introduction-">Application Layer Enforcement (ALE) Introduction&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-coding-">Coding&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-conclusion-">Conclusion&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-appendix-">Appendix&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-wfp-architecture-">WFP Architecture&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-data-flow-">Data Flow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-blocking-network-traffic-capture/#-reference-links-">Reference Links&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;!-- /code_chunk_output -->
&lt;ul>
&lt;li>Need to identify blocked traffic, including outbound and inbound.&lt;/li>
&lt;li>Two ways of blocking: by connection or by packet. Packet drops occur frequently and the reason must be audited; connection‐oriented blocks align better with real-world monitoring.&lt;/li>
&lt;li>Many normally processed packets may also be dropped, so we must distinguish drops from actual blocks—we focus on blocks.&lt;/li>
&lt;/ul>
&lt;h2 id="setting-up-a-test-project">Setting Up a Test Project&lt;/h2>
&lt;p>WFP mainly runs in user mode and partly in kernel mode, exposed as drivers. The test setup is complex.&lt;br>
Recommended: run a separate physical machine for testing, compile on the dev box, then copy and remotely debug on the test machine.&lt;br>
For those with limited resources, local debugging on the same machine is also possible.&lt;/p></description></item><item><title>Windows Firewall Management – netsh</title><link>https://blog.jqknono.com/blog/2024/06/28/windows-firewall-management-netsh/</link><pubDate>Fri, 28 Jun 2024 17:10:36 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/windows-firewall-management-netsh/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Windows Firewall Management – netsh&lt;/li>
&lt;/ul>
&lt;h1 id="windows-firewall-management--netsh">Windows Firewall Management – netsh&lt;/h1>
&lt;h2 id="management-tools">Management Tools&lt;/h2>
&lt;h2 id="netsh-advfirewall">netsh advfirewall&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ps1" data-lang="ps1">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Export firewall rules&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">export&lt;/span> &lt;span class="n">advfirewallpolicy&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">wfw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Import firewall rules&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">import&lt;/span> &lt;span class="n">advfirewallpolicy&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">wfw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># View firewall state&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">allprofiles&lt;/span> &lt;span class="n">state&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># View firewall default policy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">allprofiles&lt;/span> &lt;span class="n">firewallpolicy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># netsh advfirewall set allprofiles firewallpolicy blockinbound,allowoutbound&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># netsh advfirewall set allprofiles firewallpolicy blockinbound,blockoutbound&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># View firewall settings&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">allprofiles&lt;/span> &lt;span class="n">settings&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Enable firewall&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="nb">set &lt;/span>&lt;span class="n">allprofiles&lt;/span> &lt;span class="n">state&lt;/span> &lt;span class="n">on&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Disable firewall&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="nb">set &lt;/span>&lt;span class="n">allprofiles&lt;/span> &lt;span class="n">state&lt;/span> &lt;span class="n">off&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Display firewall rules&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">firewall&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">rule&lt;/span> &lt;span class="n">name&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="n">all&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># View firewall status&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">advfirewall&lt;/span> &lt;span class="n">monitor&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">firewall&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="netsh-firewall-deprecated">netsh firewall (deprecated)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ps1" data-lang="ps1">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Display firewall state&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">firewall&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">state&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="netsh-mbn-mobile-broadband-network">netsh mbn (Mobile Broadband network)&lt;/h2>
&lt;h2 id="netsh-wfp">netsh wfp&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ps1" data-lang="ps1">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Display firewall state&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">wfp&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="n">state&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Display firewall filters&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">wfp&lt;/span> &lt;span class="n">show&lt;/span> &lt;span class="kd">filter&lt;/span>&lt;span class="nb">s&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Windows Resources</title><link>https://blog.jqknono.com/blog/2024/06/28/windows-resources/</link><pubDate>Fri, 28 Jun 2024 17:10:07 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/windows-resources/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Windows Resources&lt;/li>
&lt;/ul>
&lt;h1 id="windows-resources-collection">Windows Resources Collection&lt;/h1>
&lt;!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
&lt;!-- code_chunk_output -->
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#windows-resources-collection">Windows Resources Collection&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#tools">Tools&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#monitoring--analysis">Monitoring &amp;amp; Analysis&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#antirootkit-tools">AntiRootkit Tools&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#pe-tools">PE Tools&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#reverse--debug">Reverse &amp;amp; Debug&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#injection-tools">Injection Tools&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#network">Network&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#stress-testing-tools">Stress Testing Tools&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#others">Others&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#code">Code&lt;/a>
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#operating-system">Operating System&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#kernel-examples">Kernel Examples&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#vt-technology">VT Technology&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#miscellaneous">Miscellaneous&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#ctf-resources">CTF Resources&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#penetration-testing">Penetration Testing&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/windows-resources/#free-patent-search">Free Patent Search&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;!-- /code_chunk_output -->
&lt;p>This section lists only some common Windows tools for debugging, troubleshooting, and testing. Tools for packing/unpacking, encryption/decryption, file editors, and programming tools are omitted for brevity.&lt;/p></description></item><item><title>Windows Guide</title><link>https://blog.jqknono.com/blog/2024/06/28/windows-guide/</link><pubDate>Fri, 28 Jun 2024 17:09:22 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/windows-guide/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> Windows Guide&lt;/li>
&lt;/ul>
&lt;h1 id="windows">Windows&lt;/h1>
&lt;ul>
&lt;li>[&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/" title="Win-to-go">Win-to-go&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="%E7%90%86%E8%A7%A3Windows%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F" title="Understanding Windows File System">Understanding Windows File System&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="%E7%90%86%E8%A7%A3Windows%E8%BF%9B%E7%A8%8B" title="Understanding Windows Processes">Understanding Windows Processes&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="Windows%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90" title="Windows Related Resources">Windows Related Resources&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="Windows%E7%AE%A1%E7%90%86%E8%BF%9B%E9%98%B6" title="Advanced Windows Management">Advanced Windows Management&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="Windows%E9%98%B2%E7%81%AB%E5%A2%99%E7%AE%A1%E7%90%86-netsh" title="Windows Firewall Management - netsh">Windows Firewall Management - netsh&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="Windows%E9%98%BB%E6%96%AD%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E8%8E%B7%E5%8F%96" title="Blocking Windows Network Traffic Acquisition">Blocking Windows Network Traffic Acquisition&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="../../../%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/Windows%E9%BA%BB%E7%83%A6%E9%97%AE%E9%A2%98" title="Windows Troublesome Issues">Windows Troublesome Issues&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="%E7%90%86%E8%A7%A3Windows%E4%BA%8B%E4%BB%B6%E8%B7%9F%E8%B8%AA_ETW" title="Understanding Windows Event Tracing (ETW)">Understanding Windows Event Tracing (ETW)&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="%E7%90%86%E8%A7%A3Windows%E7%BD%91%E7%BB%9C_WFP" title="Understanding Windows Networking (WFP)">Understanding Windows Networking (WFP)&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="windows-ipv6%E7%AE%A1%E7%90%86" title="windows-ipv6-management">windows-ipv6-management&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="../../../%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/Windows%E6%A1%A5%E6%8E%A5%E6%97%B6%E7%9A%84IPv6%E9%97%AE%E9%A2%98" title="IPv6 Issues When Bridging Windows">IPv6 Issues When Bridging Windows&lt;/a>]&lt;/li>
&lt;li>[&lt;a href="wireguard%E9%85%8D%E7%BD%AE" title="wireguard configuration">wireguard configuration&lt;/a>]&lt;/li>
&lt;/ul></description></item><item><title>window-message</title><link>https://blog.jqknono.com/blog/2024/06/28/window-message/</link><pubDate>Fri, 28 Jun 2024 17:07:51 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/window-message/</guid><description>&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> window-message&lt;/li>
&lt;/ul>
&lt;h1 id="windows-message">windows-message&lt;/h1>
&lt;ul>
&lt;li>&lt;a href="https://gist.github.com/amgine/2395987">All windows messages as C# enum (github.com)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://wiki.winehq.org/List_Of_Windows_Messages">List Of Windows Messages - WineHQ Wiki&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.pinvoke.net/default.aspx/Constants/WM.html">pinvoke.net: WM (Constants)&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.pinvoke.net/default.aspx/Enums/WindowsMessages">pinvoke.net: WindowsMessages (Enums)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://learn.microsoft.com/en-us/windows/win32/winmsg/window-notifications">Window Notifications&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Win-to-go</title><link>https://blog.jqknono.com/blog/2024/06/28/win-to-go/</link><pubDate>Fri, 28 Jun 2024 17:07:10 +0800</pubDate><guid>https://blog.jqknono.com/blog/2024/06/28/win-to-go/</guid><description>&lt;p>===&lt;/p>
&lt;p>Windows To Go is convenient for portability, but several traditional Windows features are restricted.&lt;/p>
&lt;!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->
&lt;!-- code_chunk_output -->
&lt;ul>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#preface">Preface&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#windows-to-go-overview">Windows To Go Overview&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#differences-between-windows-to-go-and-traditional-windows-installation">Differences between Windows To Go and traditional Windows installation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#using-windows-to-go-for-mobile-work">Using Windows To Go for mobile work&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#preparing-to-install-windows-to-go">Preparing to install Windows To Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#hardware-requirements">Hardware requirements&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#usb-hard-drive-or-flash-drive">USB hard drive or flash drive&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#host-computer">Host computer&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#checking-architecture-compatibility-between-host-pc-and-windows-to-go-drive">Checking architecture compatibility between host PC and Windows To Go drive&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.jqknono.com/blog/2024/06/28/win-to-go/#common-windows-to-go-questions">Common Windows To Go questions&lt;/a>&lt;/li>
&lt;/ul>
&lt;!-- /code_chunk_output -->
&lt;h2 id="preface">Preface&lt;/h2>
&lt;p>Windows To Go has existed for many years, yet there are so few Chinese-language resources on it—one can’t help but worry about the state of domestic IT documentation. The author has limited experience but is exposed to plenty of English development docs and hopes to lay some groundwork for future readers; any mistakes pointed out will be welcomed. For those comfortable reading English, comprehensive official documentation is available at the links below:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/windows-to-go-overview">Windows To Go Overview&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/best-practice-recommendations-for-windows-to-go">Best practice recommendations for Windows To Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/deployment-considerations-for-windows-to-go">Deployment considerations for Windows To Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/prepare-your-organization-for-windows-to-go">Prepare your organization for Windows To Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/security-and-data-protection-considerations-for-windows-to-go">Security and data protection considerations for Windows To Go&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/windows/deployment/planning/windows-to-go-frequently-asked-questions">Windows To Go: frequently asked questions&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>This post covers the overview and some common questions—mostly translations with the occasional author note (indicated by [J] until the next full stop) to prevent misinformation.&lt;/p></description></item></channel></rss>