<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=ar-ae class=no-js data-theme-init><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=color-scheme content="light dark"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#000000"><style>html{background:Canvas;color:CanvasText}@media(prefers-color-scheme:dark){html{background:#0b0d12;color:#e6e6e6}}html[data-theme-init] *{transition:none!important}</style><script>(function(){const t="td-color-theme",n=localStorage.getItem(t);let e=n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");e==="auto"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-bs-theme",e)})()</script><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة | jqknono Blogs</title><meta name=description content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة يُعرف WireGuard ببساطته وكفاءته، لكن طريقة الاتصال القائمة على UDP تجعله عرضة لقيود QoS من قبل مزودي الخدمة. سيقوم هذا المقال بتحليل عميق لآليات تقييد UDP لدى مزودي الخدمة، ويقدم حلولاً متعددة تم التحقق منها.
تحليل آليات QoS لـ UDP لدى مزودي الخدمة يطبق مزودو الخدمة عادةً سياسات QoS بناءً على خماسي التي (IP المصدر، IP الوجهة، المنفذ المصدر، المنفذ الوجهة، نوع البروتوكول):"><meta property="og:url" content="https://blog.jqknono.com/ar-ae/blog/2024/05/21/%D8%AF%D9%84%D9%8A%D9%84-wireguard-%D8%A7%D9%84%D9%83%D8%A7%D9%85%D9%84-%D9%84%D9%85%D9%88%D8%A7%D8%AC%D9%87%D8%A9-%D9%82%D9%8A%D9%88%D8%AF-qos-%D9%84%D9%80-udp-%D9%84%D8%AF%D9%89-%D9%85%D8%B2%D9%88%D8%AF%D9%8A-%D8%A7%D9%84%D8%AE%D8%AF%D9%85%D8%A9/"><meta property="og:site_name" content="jqknono Blogs"><meta property="og:title" content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة"><meta property="og:description" content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة يُعرف WireGuard ببساطته وكفاءته، لكن طريقة الاتصال القائمة على UDP تجعله عرضة لقيود QoS من قبل مزودي الخدمة. سيقوم هذا المقال بتحليل عميق لآليات تقييد UDP لدى مزودي الخدمة، ويقدم حلولاً متعددة تم التحقق منها.
تحليل آليات QoS لـ UDP لدى مزودي الخدمة يطبق مزودو الخدمة عادةً سياسات QoS بناءً على خماسي التي (IP المصدر، IP الوجهة، المنفذ المصدر، المنفذ الوجهة، نوع البروتوكول):"><meta property="og:locale" content="ar_ae"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-05-21T10:15:21+08:00"><meta property="article:modified_time" content="2024-05-21T10:15:21+08:00"><meta property="article:tag" content="WireGuard"><meta property="article:tag" content="VPN"><meta property="article:tag" content="UDP QoS"><meta property="article:tag" content="تحسين الشبكة"><meta itemprop=name content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة"><meta itemprop=description content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة يُعرف WireGuard ببساطته وكفاءته، لكن طريقة الاتصال القائمة على UDP تجعله عرضة لقيود QoS من قبل مزودي الخدمة. سيقوم هذا المقال بتحليل عميق لآليات تقييد UDP لدى مزودي الخدمة، ويقدم حلولاً متعددة تم التحقق منها.
تحليل آليات QoS لـ UDP لدى مزودي الخدمة يطبق مزودو الخدمة عادةً سياسات QoS بناءً على خماسي التي (IP المصدر، IP الوجهة، المنفذ المصدر، المنفذ الوجهة، نوع البروتوكول):"><meta itemprop=datePublished content="2024-05-21T10:15:21+08:00"><meta itemprop=dateModified content="2024-05-21T10:15:21+08:00"><meta itemprop=wordCount content="863"><meta itemprop=keywords content="WireGuard,VPN,UDP QoS,تحسين الشبكة"><meta name=twitter:card content="summary"><meta name=twitter:title content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة"><meta name=twitter:description content="دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة يُعرف WireGuard ببساطته وكفاءته، لكن طريقة الاتصال القائمة على UDP تجعله عرضة لقيود QoS من قبل مزودي الخدمة. سيقوم هذا المقال بتحليل عميق لآليات تقييد UDP لدى مزودي الخدمة، ويقدم حلولاً متعددة تم التحقق منها.
تحليل آليات QoS لـ UDP لدى مزودي الخدمة يطبق مزودو الخدمة عادةً سياسات QoS بناءً على خماسي التي (IP المصدر، IP الوجهة، المنفذ المصدر، المنفذ الوجهة، نوع البروتوكول):"><link rel=preload href=/scss/main.min.19deb9bb49a16bab1391617801cf2d75f58ded83cae46516f211ba8fc3e9f6f9.css as=style integrity="sha256-Gd65u0mha6sTkWF4Ac8tdfWN7YPK5GUW8hG6j8Pp9vk=" crossorigin=anonymous><link href=/scss/main.min.19deb9bb49a16bab1391617801cf2d75f58ded83cae46516f211ba8fc3e9f6f9.css rel=stylesheet integrity="sha256-Gd65u0mha6sTkWF4Ac8tdfWN7YPK5GUW8hG6j8Pp9vk=" crossorigin=anonymous><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F3FFTG72NE"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-F3FFTG72NE")}</script></head><body class="td-page td-blog"><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="td-navbar-container container-fluid flex-column flex-md-row"><a class=navbar-brand href=/ar-ae/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>jqknono Blogs</span></a><div class="td-navbar-nav-scroll td-navbar-nav-scroll--indicator" id=main_navbar><div class="scroll-indicator scroll-left"></div><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://jqknono.com target=_blank rel=noopener><span>About</span><sup><i class="ps-1 fa-solid fa-up-right-from-square fa-xs" aria-hidden=true></i></sup></a></li><li class=nav-item><a class=nav-link href=https://github.com/jqknono target=_blank rel=noopener><i class="fab fa-github" aria-hidden=true></i><span>GitHub</span><sup><i class="ps-1 fa-solid fa-up-right-from-square fa-xs" aria-hidden=true></i></sup></a></li><li class="nav-item td-navbar__lang-menu"><div class="td-lang-menu dropdown"><a class="nav-link dropdown-toggle td-lang-menu__title" href=# role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><span class=td-lang-menu__title-text>العربية</span>
<span class=td-lang-menu__title-code>AR-AE</span></a><ul class=dropdown-menu><li><a class=dropdown-item href=/blog/2024/05/21/complete-solution-for-wireguard-against-isp-udp-qos/>English</a></li><li><a class=dropdown-item href=/zh-tw/blog/2024/05/21/wireguard%E5%B0%8D%E6%8A%97%E9%81%8B%E7%87%9F%E5%95%86udp-qos%E7%9A%84%E5%AE%8C%E6%95%B4%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88/>繁體中文</a></li><li><a class=dropdown-item href=/ja-jp/blog/2024/05/21/wireguard%E3%81%8Cisp%E3%81%AEudp-qos%E3%81%AB%E5%AF%BE%E6%8A%97%E3%81%99%E3%82%8B%E5%AE%8C%E5%85%A8%E3%82%BD%E3%83%AA%E3%83%A5%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/>日本語</a></li><li><a class=dropdown-item href=/ko-kr/blog/2024/05/21/wireguard%EA%B0%80-%ED%86%B5%EC%8B%A0%EC%82%AC-udp-qos%EC%97%90-%EB%8C%80%ED%95%AD%ED%95%98%EB%8A%94-%EC%99%84%EC%A0%84%ED%95%9C-%EC%86%94%EB%A3%A8%EC%85%98/>한국어</a></li><li><a class=dropdown-item href=/ar-sa/blog/2024/05/21/%D8%A7%D9%84%D8%AD%D9%84-%D8%A7%D9%84%D9%83%D8%A7%D9%85%D9%84-%D9%84%D9%80-wireguard-%D8%B6%D8%AF-qos-udp-%D9%84%D9%84%D9%85%D8%B4%D8%BA%D9%84%D9%8A%D9%86/>العربية</a></li><li><a class=dropdown-item href=/de-de/blog/2024/05/21/wireguard-gegen-isp-udp-qos-die-vollst%C3%A4ndige-l%C3%B6sung/>Deutsch</a></li><li><a class=dropdown-item href=/fr-fr/blog/2024/05/21/wireguard-solution-compl%C3%A8te-contre-la-qos-udp-des-op%C3%A9rateurs/>Français</a></li><li><a class=dropdown-item href=/hi-in/blog/2024/05/21/wireguard-%E0%A4%91%E0%A4%AA%E0%A4%B0%E0%A5%87%E0%A4%9F%E0%A4%B0-udp-qos-%E0%A4%95%E0%A5%87-%E0%A4%96%E0%A4%BF%E0%A4%B2%E0%A4%BE%E0%A4%AB-%E0%A4%AA%E0%A5%82%E0%A4%B0%E0%A5%8D%E0%A4%A3-%E0%A4%B8%E0%A4%AE%E0%A4%BE%E0%A4%A7%E0%A4%BE%E0%A4%A8/>हिंदी</a></li><li><a class=dropdown-item href=/es-es/blog/2024/05/21/soluci%C3%B3n-completa-de-wireguard-contra-la-qos-udp-de-los-operadores/>Español</a></li><li><a class=dropdown-item href=/pt-br/blog/2024/05/21/solu%C3%A7%C3%A3o-completa-do-wireguard-contra-qos-udp-dos-operadores/>Português</a></li><li><a class=dropdown-item href=/ru-ru/blog/2024/05/21/%D0%BF%D0%BE%D0%BB%D0%BD%D0%BE%D0%B5-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-wireguard-%D0%BF%D1%80%D0%BE%D1%82%D0%B8%D0%B2-udp-qos-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%BE%D0%B2/>Русский</a></li><li><a class=dropdown-item href=/it-it/blog/2024/05/21/soluzione-completa-di-wireguard-contro-il-qos-udp-degli-operatori/>Italiano</a></li><li><span class="dropdown-item disabled">Bahasa Indonesia</span></li><li><a class=dropdown-item href=/tr-tr/blog/2024/05/21/wireguardin-operat%C3%B6r-udp-qossine-kar%C5%9F%C4%B1-tam-%C3%A7%C3%B6z%C3%BCm%C3%BC/>Türkçe</a></li><li><a class=dropdown-item href=/nl-nl/blog/2024/05/21/wireguard-volledige-oplossing-tegen-provider-udp-qos/>Nederlands</a></li><li><a class=dropdown-item href=/pl-pl/blog/2024/05/21/pe%C5%82ne-rozwi%C4%85zanie-wireguard-do-walki-z-limitem-qos-udp-operatora/>Polski</a></li><li><span class="dropdown-item active">العربية</span></li><li><a class=dropdown-item href=/zh-cn/blog/2024/05/21/wireguard%E5%AF%B9%E6%8A%97%E8%BF%90%E8%90%A5%E5%95%86udp-qos%E7%9A%84%E5%AE%8C%E6%95%B4%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/>简体中文</a></li></ul></div></li><li class="nav-item td-navbar__light-dark-menu"><div class="td-light-dark-menu dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown aria-label="Toggle theme (auto)">
<svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class=dropdown-menu aria-labelledby=bd-theme><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto
<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></div></li></ul><div class="scroll-indicator scroll-right"></div></div><div class="d-none d-lg-block td-navbar__search"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="ابحث في هذا الموقع…" aria-label="ابحث في هذا الموقع…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.cc8256ce9df3b0ba01ec0c0a9666d270.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main data-bs-spy=scroll data-bs-target=.td-toc data-bs-root-margin="0px 0px -10%"><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="ابحث في هذا الموقع…" aria-label="ابحث في هذا الموقع…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.cc8256ce9df3b0ba01ec0c0a9666d270.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="td-sidebar-nav collapse td-sidebar-nav--search-disabled foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-ar-aeblog-li><a href=/ar-ae/blog/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-ar-aeblog><span>Blogs</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20251203d98ad98fd981d8b6d984-d8b9d8afd985-d8a7d8b3d8aad8aed8afd8a7d985-d985d98ad8b2d8a9-esa_page-d981d98a-d8b9d984d98a-d8a8d8a7d8a8d8a7-d983d984d8a7d988d8af-d981d98a-d8a7d984d8a8d8afd8a7d98ad8a9-li><input type=checkbox id=m-ar-aeblog20251203d98ad98fd981d8b6d984-d8b9d8afd985-d8a7d8b3d8aad8aed8afd8a7d985-d985d98ad8b2d8a9-esa_page-d981d98a-d8b9d984d98a-d8a8d8a7d8a8d8a7-d983d984d8a7d988d8af-d981d98a-d8a7d984d8a8d8afd8a7d98ad8a9-check>
<label for=m-ar-aeblog20251203d98ad98fd981d8b6d984-d8b9d8afd985-d8a7d8b3d8aad8aed8afd8a7d985-d985d98ad8b2d8a9-esa_page-d981d98a-d8b9d984d98a-d8a8d8a7d8a8d8a7-d983d984d8a7d988d8af-d981d98a-d8a7d984d8a8d8afd8a7d98ad8a9-check><a href=/ar-ae/blog/2025/12/03/%D9%8A%D9%8F%D9%81%D8%B6%D9%84-%D8%B9%D8%AF%D9%85-%D8%A7%D8%B3%D8%AA%D8%AE%D8%AF%D8%A7%D9%85-%D9%85%D9%8A%D8%B2%D8%A9-esa_page-%D9%81%D9%8A-%D8%B9%D9%84%D9%8A-%D8%A8%D8%A7%D8%A8%D8%A7-%D9%83%D9%84%D8%A7%D9%88%D8%AF-%D9%81%D9%8A-%D8%A7%D9%84%D8%A8%D8%AF%D8%A7%D9%8A%D8%A9/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20251203d98ad98fd981d8b6d984-d8b9d8afd985-d8a7d8b3d8aad8aed8afd8a7d985-d985d98ad8b2d8a9-esa_page-d981d98a-d8b9d984d98a-d8a8d8a7d8a8d8a7-d983d984d8a7d988d8af-d981d98a-d8a7d984d8a8d8afd8a7d98ad8a9><span>يُفضل عدم استخدام ميزة ESA_page في علي بابا كلاود في البداية</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20251202d8add981d8b1-d8b9d984d98a-d8a8d8a7d8a8d8a7-esa-d988d8a7d984d980-oss-li><input type=checkbox id=m-ar-aeblog20251202d8add981d8b1-d8b9d984d98a-d8a8d8a7d8a8d8a7-esa-d988d8a7d984d980-oss-check>
<label for=m-ar-aeblog20251202d8add981d8b1-d8b9d984d98a-d8a8d8a7d8a8d8a7-esa-d988d8a7d984d980-oss-check><a href=/ar-ae/blog/2025/12/02/%D8%AD%D9%81%D8%B1-%D8%B9%D9%84%D9%8A-%D8%A8%D8%A7%D8%A8%D8%A7-esa-%D9%88%D8%A7%D9%84%D9%80-oss/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20251202d8add981d8b1-d8b9d984d98a-d8a8d8a7d8a8d8a7-esa-d988d8a7d984d980-oss><span>حفر علي بابا ESA والـ OSS</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20251202d987d984-cloudflare-d985d988d8abd988d982-d8aad985d8a7d985d98bd8a7-li><input type=checkbox id=m-ar-aeblog20251202d987d984-cloudflare-d985d988d8abd988d982-d8aad985d8a7d985d98bd8a7-check>
<label for=m-ar-aeblog20251202d987d984-cloudflare-d985d988d8abd988d982-d8aad985d8a7d985d98bd8a7-check><a href=/ar-ae/blog/2025/12/02/%D9%87%D9%84-cloudflare-%D9%85%D9%88%D8%AB%D9%88%D9%82-%D8%AA%D9%85%D8%A7%D9%85%D9%8B%D8%A7/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20251202d987d984-cloudflare-d985d988d8abd988d982-d8aad985d8a7d985d98bd8a7><span>هل Cloudflare موثوق تمامًا</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-li><input type=checkbox id=m-ar-aeblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-check>
<label for=m-ar-aeblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5-check><a href=/ar-ae/blog/2025/11/29/%E8%AE%B0%E4%B8%80%E6%AC%A1%E9%9D%9E%E5%85%B8%E5%9E%8B%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20251129e8aeb0e4b880e6aca1e99d9ee585b8e59e8be5aeb6e5baade7bd91e7bb9ce997aee9a298e68e92e69fa5><span>سجل لمرة واحدة من استكشاف أعطال شبكة منزلية غير نمطية</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20251127d8a7d984d987d8afd8a7d98ad8a7-d8a7d984d985d8acd8a7d986d98ad8a9-d8a7d984d8aad98a-d98ad985d983d986d983-d8a7d984d8add8b5d988d984-d8b9d984d98ad987d8a7-d985d986-d8a7d985d8aad984d8a7d983-d986d8b7d8a7d982-li><input type=checkbox id=m-ar-aeblog20251127d8a7d984d987d8afd8a7d98ad8a7-d8a7d984d985d8acd8a7d986d98ad8a9-d8a7d984d8aad98a-d98ad985d983d986d983-d8a7d984d8add8b5d988d984-d8b9d984d98ad987d8a7-d985d986-d8a7d985d8aad984d8a7d983-d986d8b7d8a7d982-check>
<label for=m-ar-aeblog20251127d8a7d984d987d8afd8a7d98ad8a7-d8a7d984d985d8acd8a7d986d98ad8a9-d8a7d984d8aad98a-d98ad985d983d986d983-d8a7d984d8add8b5d988d984-d8b9d984d98ad987d8a7-d985d986-d8a7d985d8aad984d8a7d983-d986d8b7d8a7d982-check><a href=/ar-ae/blog/2025/11/27/%D8%A7%D9%84%D9%87%D8%AF%D8%A7%D9%8A%D8%A7-%D8%A7%D9%84%D9%85%D8%AC%D8%A7%D9%86%D9%8A%D8%A9-%D8%A7%D9%84%D8%AA%D9%8A-%D9%8A%D9%85%D9%83%D9%86%D9%83-%D8%A7%D9%84%D8%AD%D8%B5%D9%88%D9%84-%D8%B9%D9%84%D9%8A%D9%87%D8%A7-%D9%85%D9%86-%D8%A7%D9%85%D8%AA%D9%84%D8%A7%D9%83-%D9%86%D8%B7%D8%A7%D9%82/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20251127d8a7d984d987d8afd8a7d98ad8a7-d8a7d984d985d8acd8a7d986d98ad8a9-d8a7d984d8aad98a-d98ad985d983d986d983-d8a7d984d8add8b5d988d984-d8b9d984d98ad987d8a7-d985d986-d8a7d985d8aad984d8a7d983-d986d8b7d8a7d982><span>الهدايا المجانية التي يمكنك الحصول عليها من امتلاك نطاق</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20230506d985d8b4d983d984d8a9-ipv6-d8a3d8abd986d8a7d8a1-d8acd8b3d8b1-windows-li><input type=checkbox id=m-ar-aeblog20230506d985d8b4d983d984d8a9-ipv6-d8a3d8abd986d8a7d8a1-d8acd8b3d8b1-windows-check>
<label for=m-ar-aeblog20230506d985d8b4d983d984d8a9-ipv6-d8a3d8abd986d8a7d8a1-d8acd8b3d8b1-windows-check><a href=/ar-ae/blog/2023/05/06/%D9%85%D8%B4%D9%83%D9%84%D8%A9-ipv6-%D8%A3%D8%AB%D9%86%D8%A7%D8%A1-%D8%AC%D8%B3%D8%B1-windows/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20230506d985d8b4d983d984d8a9-ipv6-d8a3d8abd986d8a7d8a1-d8acd8b3d8b1-windows><span>مشكلة IPv6 أثناء جسر Windows</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20240527d8aad8abd8a8d98ad8aa-d988d8aad981d8b9d98ad984-d986d8b8d8a7d985-windows-li><input type=checkbox id=m-ar-aeblog20240527d8aad8abd8a8d98ad8aa-d988d8aad981d8b9d98ad984-d986d8b8d8a7d985-windows-check>
<label for=m-ar-aeblog20240527d8aad8abd8a8d98ad8aa-d988d8aad981d8b9d98ad984-d986d8b8d8a7d985-windows-check><a href=/ar-ae/blog/2024/05/27/%D8%AA%D8%AB%D8%A8%D9%8A%D8%AA-%D9%88%D8%AA%D9%81%D8%B9%D9%8A%D9%84-%D9%86%D8%B8%D8%A7%D9%85-windows/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20240527d8aad8abd8a8d98ad8aa-d988d8aad981d8b9d98ad984-d986d8b8d8a7d985-windows><span>تثبيت وتفعيل نظام Windows</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-ar-aeblog20240521d8afd984d98ad984-wireguard-d8a7d984d983d8a7d985d984-d984d985d988d8a7d8acd987d8a9-d982d98ad988d8af-qos-d984d980-udp-d984d8afd989-d985d8b2d988d8afd98a-d8a7d984d8aed8afd985d8a9-li><input type=checkbox id=m-ar-aeblog20240521d8afd984d98ad984-wireguard-d8a7d984d983d8a7d985d984-d984d985d988d8a7d8acd987d8a9-d982d98ad988d8af-qos-d984d980-udp-d984d8afd989-d985d8b2d988d8afd98a-d8a7d984d8aed8afd985d8a9-check checked>
<label for=m-ar-aeblog20240521d8afd984d98ad984-wireguard-d8a7d984d983d8a7d985d984-d984d985d988d8a7d8acd987d8a9-d982d98ad988d8af-qos-d984d980-udp-d984d8afd989-d985d8b2d988d8afd98a-d8a7d984d8aed8afd985d8a9-check><a href=/ar-ae/blog/2024/05/21/%D8%AF%D9%84%D9%8A%D9%84-wireguard-%D8%A7%D9%84%D9%83%D8%A7%D9%85%D9%84-%D9%84%D9%85%D9%88%D8%A7%D8%AC%D9%87%D8%A9-%D9%82%D9%8A%D9%88%D8%AF-qos-%D9%84%D9%80-udp-%D9%84%D8%AF%D9%89-%D9%85%D8%B2%D9%88%D8%AF%D9%8A-%D8%A7%D9%84%D8%AE%D8%AF%D9%85%D8%A9/ class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20240521d8afd984d98ad984-wireguard-d8a7d984d983d8a7d985d984-d984d985d988d8a7d8acd987d8a9-d982d98ad988d8af-qos-d984d980-udp-d984d8afd989-d985d8b2d988d8afd98a-d8a7d984d8aed8afd985d8a9><span class=td-sidebar-nav-active-item>دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20240520d8aad982d8b1d98ad8b1-d8b9d8b6d988-d8acd8afd98ad8af-d981d98ae5b091e695b0e6b4be-li><input type=checkbox id=m-ar-aeblog20240520d8aad982d8b1d98ad8b1-d8b9d8b6d988-d8acd8afd98ad8af-d981d98ae5b091e695b0e6b4be-check>
<label for=m-ar-aeblog20240520d8aad982d8b1d98ad8b1-d8b9d8b6d988-d8acd8afd98ad8af-d981d98ae5b091e695b0e6b4be-check><a href=/ar-ae/blog/2024/05/20/%D8%AA%D9%82%D8%B1%D9%8A%D8%B1-%D8%B9%D8%B6%D9%88-%D8%AC%D8%AF%D9%8A%D8%AF-%D9%81%D9%8A%E5%B0%91%E6%95%B0%E6%B4%BE/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20240520d8aad982d8b1d98ad8b1-d8b9d8b6d988-d8acd8afd98ad8af-d981d98ae5b091e695b0e6b4be><span>تقرير عضو جديد في少数派</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20240509d8a7d984d8aad988d8b5d98ad8a7d8aa-d8a7d984d8b4d8aed8b5d98ad8a9-d8a3d8afd8a7d8a9-d985d8b1d98ad8add8a9-d8a3d985-d981d8ae-d8a5d8afd8b1d8a7d983d98a-li><input type=checkbox id=m-ar-aeblog20240509d8a7d984d8aad988d8b5d98ad8a7d8aa-d8a7d984d8b4d8aed8b5d98ad8a9-d8a3d8afd8a7d8a9-d985d8b1d98ad8add8a9-d8a3d985-d981d8ae-d8a5d8afd8b1d8a7d983d98a-check>
<label for=m-ar-aeblog20240509d8a7d984d8aad988d8b5d98ad8a7d8aa-d8a7d984d8b4d8aed8b5d98ad8a9-d8a3d8afd8a7d8a9-d985d8b1d98ad8add8a9-d8a3d985-d981d8ae-d8a5d8afd8b1d8a7d983d98a-check><a href=/ar-ae/blog/2024/05/09/%D8%A7%D9%84%D8%AA%D9%88%D8%B5%D9%8A%D8%A7%D8%AA-%D8%A7%D9%84%D8%B4%D8%AE%D8%B5%D9%8A%D8%A9-%D8%A3%D8%AF%D8%A7%D8%A9-%D9%85%D8%B1%D9%8A%D8%AD%D8%A9-%D8%A3%D9%85-%D9%81%D8%AE-%D8%A5%D8%AF%D8%B1%D8%A7%D9%83%D9%8A/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20240509d8a7d984d8aad988d8b5d98ad8a7d8aa-d8a7d984d8b4d8aed8b5d98ad8a9-d8a3d8afd8a7d8a9-d985d8b1d98ad8add8a9-d8a3d985-d981d8ae-d8a5d8afd8b1d8a7d983d98a><span>التوصيات الشخصية: أداة مريحة أم فخ إدراكي؟</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog20240509d8aad8acd8b1d8a8d8a9-d8a7d984d983d8aad8a7d8a8d8a9-d981d98a-d985d8acd8aad985d8b9-d985d8b7d988d8b1d98a-d8aad98ad986d8b3d986d8aa-d983d984d8a7d988d8af-li><input type=checkbox id=m-ar-aeblog20240509d8aad8acd8b1d8a8d8a9-d8a7d984d983d8aad8a7d8a8d8a9-d981d98a-d985d8acd8aad985d8b9-d985d8b7d988d8b1d98a-d8aad98ad986d8b3d986d8aa-d983d984d8a7d988d8af-check>
<label for=m-ar-aeblog20240509d8aad8acd8b1d8a8d8a9-d8a7d984d983d8aad8a7d8a8d8a9-d981d98a-d985d8acd8aad985d8b9-d985d8b7d988d8b1d98a-d8aad98ad986d8b3d986d8aa-d983d984d8a7d988d8af-check><a href=/ar-ae/blog/2024/05/09/%D8%AA%D8%AC%D8%B1%D8%A8%D8%A9-%D8%A7%D9%84%D9%83%D8%AA%D8%A7%D8%A8%D8%A9-%D9%81%D9%8A-%D9%85%D8%AC%D8%AA%D9%85%D8%B9-%D9%85%D8%B7%D9%88%D8%B1%D9%8A-%D8%AA%D9%8A%D9%86%D8%B3%D9%86%D8%AA-%D9%83%D9%84%D8%A7%D9%88%D8%AF/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog20240509d8aad8acd8b1d8a8d8a9-d8a7d984d983d8aad8a7d8a8d8a9-d981d98a-d985d8acd8aad985d8b9-d985d8b7d988d8b1d98a-d8aad98ad986d8b3d986d8aa-d983d984d8a7d988d8af><span>تجربة الكتابة في مجتمع مطوري تينسنت كلاود</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog10101-li><input type=checkbox id=m-ar-aeblog10101-check>
<label for=m-ar-aeblog10101-check><a href=/ar-ae/blog/1/01/01/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog10101><span></span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ar-aeblog10101-li><input type=checkbox id=m-ar-aeblog10101-check>
<label for=m-ar-aeblog10101-check><a href=/ar-ae/blog/1/01/01/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-ar-aeblog10101><span></span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ms-2 pb-1 pt-2 mb-0"></div><div class=td-toc data-proofer-ignore><div class=td-toc-title><span class=td-toc-title__text></span>
<a class=td-toc-title__link title href=#></a></div><nav id=TableOfContents><ul><li><a href=#تحليل-آليات-qos-لـ-udp-لدى-مزودي-الخدمة>تحليل آليات QoS لـ UDP لدى مزودي الخدمة</a></li><li><a href=#مقارنة-الحلول>مقارنة الحلول</a></li><li><a href=#تكوين-التثبيت-الأساسي>تكوين التثبيت الأساسي</a><ul><li><a href=#تثبيت-الخادم-باستخدام-سكريبت-آلي>تثبيت الخادم (باستخدام سكريبت آلي)</a></li><li><a href=#تكوين-العميل>تكوين العميل</a></li></ul></li><li><a href=#حلول-متقدمة>حلول متقدمة</a><ul><li><a href=#الحل-الأول-wireguard-over-tcp-موصى-به-لبيئة-الإغلاق-الصارمة>الحل الأول: WireGuard over TCP (موصى به لبيئة الإغلاق الصارمة)</a></li><li><a href=#الحل-الثاني-الاستماع-على-منافذ-متعددة--تبديل-ديناميكي-الحل-الموصى-به>الحل الثاني: الاستماع على منافذ متعددة + تبديل ديناميكي (الحل الموصى به)</a></li><li><a href=#الحل-الثالث-انتحال-المنافذ-المتقدم-نفق-icmpudp>الحل الثالث: انتحال المنافذ المتقدم (نفق ICMP/UDP)</a></li></ul></li><li><a href=#اقتراحات-تحسين-الأداء>اقتراحات تحسين الأداء</a></li><li><a href=#الخاتمة-والاقتراحات>الخاتمة والاقتراحات</a></li><li><a href=#المراجع>المراجع</a></li></ul></nav></div><div class="taxonomy taxonomy-terms-cloud taxo-tags"><h5 class=taxonomy-title>Taxonomy Cloud</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/2025/ data-taxonomy-term=2025><span class=taxonomy-label>2025</span><span class=taxonomy-count>5</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/blog/ data-taxonomy-term=blog><span class=taxonomy-label>Blog</span><span class=taxonomy-count>3</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/udp-qos/ data-taxonomy-term=udp-qos><span class=taxonomy-label>UDP QoS</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/vpn/ data-taxonomy-term=vpn><span class=taxonomy-label>VPN</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/wireguard/ data-taxonomy-term=wireguard><span class=taxonomy-label>WireGuard</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A7%D8%AA/ data-taxonomy-term=%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A7%D8%AA><span class=taxonomy-label>الشبكات</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%AA%D8%AD%D8%B3%D9%8A%D9%86-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%AA%D8%AD%D8%B3%D9%8A%D9%86-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>تحسين الشبكة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%AA%D9%82%D9%8A%D9%8A%D9%85/ data-taxonomy-term=%D8%AA%D9%82%D9%8A%D9%8A%D9%85><span class=taxonomy-label>تقييم</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%AF%D8%B1%D9%88%D8%B3-%D8%AA%D8%B9%D9%84%D9%8A%D9%85%D9%8A%D8%A9/ data-taxonomy-term=%D8%AF%D8%B1%D9%88%D8%B3-%D8%AA%D8%B9%D9%84%D9%8A%D9%85%D9%8A%D8%A9><span class=taxonomy-label>دروس تعليمية</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>شبكة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%B5%D9%8A%D8%A7%D9%86%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84/ data-taxonomy-term=%D8%B5%D9%8A%D8%A7%D9%86%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84><span class=taxonomy-label>صيانة التشغيل</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%B9%D9%85%D9%84%D9%8A%D8%A7%D8%AA-%D9%88%D8%B5%D9%8A%D8%A7%D9%86%D8%A9/ data-taxonomy-term=%D8%B9%D9%85%D9%84%D9%8A%D8%A7%D8%AA-%D9%88%D8%B5%D9%8A%D8%A7%D9%86%D8%A9><span class=taxonomy-label>عمليات وصيانة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81/ data-taxonomy-term=%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81><span class=taxonomy-label>غير مصنف</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81%D8%A9/ data-taxonomy-term=%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81%D8%A9><span class=taxonomy-label>غير مصنفة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D9%85%D8%B4%D9%83%D9%84%D8%A7%D8%AA-%D9%85%D8%B9%D9%82%D8%AF%D8%A9-%D9%85%D8%AA%D9%86%D9%88%D8%B9%D8%A9/ data-taxonomy-term=%D9%85%D8%B4%D9%83%D9%84%D8%A7%D8%AA-%D9%85%D8%B9%D9%82%D8%AF%D8%A9-%D9%85%D8%AA%D9%86%D9%88%D8%B9%D8%A9><span class=taxonomy-label>مشكلات معقدة متنوعة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D9%85%D9%86%D8%B5%D8%A9-%D8%A7%D9%84%D9%85%D9%86%D8%B4%D8%A6%D9%8A%D9%86/ data-taxonomy-term=%D9%85%D9%86%D8%B5%D8%A9-%D8%A7%D9%84%D9%85%D9%86%D8%B4%D8%A6%D9%8A%D9%86><span class=taxonomy-label>منصة المنشئين</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D9%86%D8%B8%D8%B1%D9%8A%D8%A9-%D8%A7%D9%84%D8%A3%D9%84%D8%B9%D8%A7%D8%A8/ data-taxonomy-term=%D9%86%D8%B8%D8%B1%D9%8A%D8%A9-%D8%A7%D9%84%D8%A3%D9%84%D8%B9%D8%A7%D8%A8><span class=taxonomy-label>نظرية الألعاب</span><span class=taxonomy-count>1</span></a></li></ul></div><div class="taxonomy taxonomy-terms-cloud taxo-categories"><h5 class=taxonomy-title>Categories</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A7%D8%AA/ data-taxonomy-term=%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A7%D8%AA><span class=taxonomy-label>الشبكات</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%AA%D9%82%D9%86%D9%8A%D8%A7%D8%AA-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%AA%D9%82%D9%86%D9%8A%D8%A7%D8%AA-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>تقنيات الشبكة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%AA%D9%82%D9%8A%D9%8A%D9%85/ data-taxonomy-term=%D8%AA%D9%82%D9%8A%D9%8A%D9%85><span class=taxonomy-label>تقييم</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%AF%D8%B1%D9%88%D8%B3-%D8%AA%D8%B9%D9%84%D9%8A%D9%85%D9%8A%D8%A9/ data-taxonomy-term=%D8%AF%D8%B1%D9%88%D8%B3-%D8%AA%D8%B9%D9%84%D9%8A%D9%85%D9%8A%D8%A9><span class=taxonomy-label>دروس تعليمية</span><span class=taxonomy-count>2</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>شبكة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%B5%D9%8A%D8%A7%D9%86%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84/ data-taxonomy-term=%D8%B5%D9%8A%D8%A7%D9%86%D8%A9-%D8%A7%D9%84%D8%AA%D8%B4%D8%BA%D9%8A%D9%84><span class=taxonomy-label>صيانة التشغيل</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%B9%D9%85%D9%84%D9%8A%D8%A7%D8%AA-%D9%88%D8%B5%D9%8A%D8%A7%D9%86%D8%A9/ data-taxonomy-term=%D8%B9%D9%85%D9%84%D9%8A%D8%A7%D8%AA-%D9%88%D8%B5%D9%8A%D8%A7%D9%86%D8%A9><span class=taxonomy-label>عمليات وصيانة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81/ data-taxonomy-term=%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81><span class=taxonomy-label>غير مصنف</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81%D8%A9/ data-taxonomy-term=%D8%BA%D9%8A%D8%B1-%D9%85%D8%B5%D9%86%D9%81%D8%A9><span class=taxonomy-label>غير مصنفة</span><span class=taxonomy-count>1</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D9%86%D8%B8%D8%B1%D9%8A%D8%A9-%D8%A7%D9%84%D8%A3%D9%84%D8%B9%D8%A7%D8%A8/ data-taxonomy-term=%D9%86%D8%B8%D8%B1%D9%8A%D8%A9-%D8%A7%D9%84%D8%A3%D9%84%D8%B9%D8%A7%D8%A8><span class=taxonomy-label>نظرية الألعاب</span><span class=taxonomy-count>1</span></a></li></ul></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5 pe-md-4" role=main><a class=td-rss-button title=RSS href=/ar-ae/blog/index.xml target=_blank rel=noopener><i class="fa-solid fa-rss" aria-hidden=true></i></a><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/ar-ae/blog/>Blogs</a></li><li class="breadcrumb-item active" aria-current=page>دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة</li></ol></nav><div class=td-content><h1>دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة</h1><div class="td-byline mb-4"><time datetime=2024-05-21 class=text-body-secondary>Tuesday, May 21, 2024</time></div><header class=article-meta><div class="taxonomy taxonomy-terms-article taxo-tags"><h5 class=taxonomy-title>Tags:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/wireguard/ data-taxonomy-term=wireguard><span class=taxonomy-label>WireGuard</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/vpn/ data-taxonomy-term=vpn><span class=taxonomy-label>VPN</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/udp-qos/ data-taxonomy-term=udp-qos><span class=taxonomy-label>UDP QoS</span></a></li><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/tags/%D8%AA%D8%AD%D8%B3%D9%8A%D9%86-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%AA%D8%AD%D8%B3%D9%8A%D9%86-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>تحسين الشبكة</span></a></li></ul></div><div class="taxonomy taxonomy-terms-article taxo-categories"><h5 class=taxonomy-title>Categories:</h5><ul class=taxonomy-terms><li><a class=taxonomy-term href=https://blog.jqknono.com/ar-ae/categories/%D8%AA%D9%82%D9%86%D9%8A%D8%A7%D8%AA-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9/ data-taxonomy-term=%D8%AA%D9%82%D9%86%D9%8A%D8%A7%D8%AA-%D8%A7%D9%84%D8%B4%D8%A8%D9%83%D8%A9><span class=taxonomy-label>تقنيات الشبكة</span></a></li></ul></div></header><h1 id=دليل-wireguard-الكامل-لمواجهة-قيود-qos-لـ-udp-لدى-مزودي-الخدمة>دليل WireGuard الكامل لمواجهة قيود QoS لـ UDP لدى مزودي الخدمة</h1><p>يُعرف WireGuard ببساطته وكفاءته، لكن طريقة الاتصال القائمة على UDP تجعله عرضة لقيود QoS من قبل مزودي الخدمة. سيقوم هذا المقال بتحليل عميق لآليات تقييد UDP لدى مزودي الخدمة، ويقدم حلولاً متعددة تم التحقق منها.</p><h2 id=تحليل-آليات-qos-لـ-udp-لدى-مزودي-الخدمة>تحليل آليات QoS لـ UDP لدى مزودي الخدمة</h2><p>يطبق مزودو الخدمة عادةً سياسات QoS بناءً على خماسي التي (IP المصدر، IP الوجهة، المنفذ المصدر، المنفذ الوجهة، نوع البروتوكول):</p><ol><li><strong>كشف الحزم العميق (DPI)</strong>: التعرف على خصائص حركة مرور VPN</li><li><strong>تقييد السرعة على المنافذ</strong>: تقييد عرض النطاق الترددي على المنافذ UDP غير الشائعة</li><li><strong>تقييد مدة الاتصال</strong>: يتم تقييد الاتصالات UDP الطويلة الأمد</li><li><strong>تشكيل الحركة</strong>: تعديل أولوية حركة مرور أنواع بروتوكولات محددة</li></ol><blockquote><p>بيانات الاختبار الفعلي: في شبكة الاتصالات، بعد نقل حركة UDP مستمرة لمدة 5 دقائق، ينخفض عرض النطاق من 100 ميغابت/ثانية إلى أقل من 10 ميغابت/ثانية</p></blockquote><h2 id=مقارنة-الحلول>مقارنة الحلول</h2><table><thead><tr><th>الحل</th><th>صعوبة التنفيذ</th><th>فقدان الأداء</th><th>قدرة مقاومة الإغلاق</th><th>السيناريو المناسب</th></tr></thead><tbody><tr><td>WireGuard over TCP</td><td>★★☆</td><td>20-30%</td><td>★★☆</td><td>بيئة إغلاق صارمة</td></tr><tr><td>الاستماع على منافذ متعددة</td><td>★☆☆</td><td>&lt;5%</td><td>★★★</td><td>بيئة QoS عادية</td></tr><tr><td>تبديل المنافذ الديناميكي</td><td>★★☆</td><td>&lt;5%</td><td>★★★★</td><td>بيئة QoS ذكية</td></tr><tr><td>انتحال المنافذ (ICMP/UDP)</td><td>★★★</td><td>10-15%</td><td>★★★★</td><td>بيئة إغلاق متقدمة</td></tr></tbody></table><h2 id=تكوين-التثبيت-الأساسي>تكوين التثبيت الأساسي</h2><h3 id=تثبيت-الخادم-باستخدام-سكريبت-آلي>تثبيت الخادم (باستخدام سكريبت آلي)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># استخدام سكريبت التثبيت المُدار من angristan</span>
</span></span><span class=line><span class=cl>curl -O https://raw.githubusercontent.com/angristan/wireguard-install/master/wireguard-install.sh
</span></span><span class=line><span class=cl>chmod +x wireguard-install.sh
</span></span><span class=line><span class=cl>./wireguard-install.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># معلمات التكوين الموصى بها:</span>
</span></span><span class=line><span class=cl><span class=c1># نطاق المنافذ: 51000-52000</span>
</span></span><span class=line><span class=cl><span class=c1># شبكة IPv4: 10.66.66.1/24</span>
</span></span><span class=line><span class=cl><span class=c1># شبكة IPv6: fd42:42:42::1/64</span>
</span></span></code></pre></div><h3 id=تكوين-العميل>تكوين العميل</h3><h4 id=عميل-linux>عميل Linux</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Ubuntu/Debian</span>
</span></span><span class=line><span class=cl>sudo apt install wireguard-tools resolvconf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># نشر ملف التكوين</span>
</span></span><span class=line><span class=cl>sudo cp wg0.conf /etc/wireguard/
</span></span><span class=line><span class=cl>sudo chmod <span class=m>600</span> /etc/wireguard/wg0.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># إدارة الخدمة</span>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now wg-quick@wg0
</span></span><span class=line><span class=cl>sudo wg show  <span class=c1># التحقق من حالة الاتصال</span>
</span></span></code></pre></div><h4 id=عميل-windows>عميل Windows</h4><ol><li>تحميل برنامج التثبيت من<a href=https://www.wireguard.com/install/>الموقع الرسمي</a></li><li>استيراد ملف التكوين <code>wg0.conf</code></li><li>تكوين جدار الحماية (PowerShell كمدير):</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>New-NetFirewallRule</span> <span class=n>-DisplayName</span> <span class=s2>&#34;WireGuard&#34;</span> <span class=n>-Direction</span> <span class=n>Inbound</span> <span class=n>-Protocol</span> <span class=n>UDP</span> <span class=n>-LocalPort</span> <span class=mf>51820</span> <span class=n>-Action</span> <span class=n>Allow</span>
</span></span><span class=line><span class=cl><span class=nb>New-NetFirewallRule</span> <span class=n>-DisplayName</span> <span class=s2>&#34;WireGuard&#34;</span> <span class=n>-Direction</span> <span class=n>Outbound</span> <span class=n>-Protocol</span> <span class=n>UDP</span> <span class=n>-LocalPort</span> <span class=mf>51820</span> <span class=n>-Action</span> <span class=n>Allow</span>
</span></span></code></pre></div><h2 id=حلول-متقدمة>حلول متقدمة</h2><h3 id=الحل-الأول-wireguard-over-tcp-موصى-به-لبيئة-الإغلاق-الصارمة>الحل الأول: WireGuard over TCP (موصى به لبيئة الإغلاق الصارمة)</h3><h4 id=تكوين-الخادم-باستخدام-udptunnel>تكوين الخادم (باستخدام udptunnel)</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install udptunnel
</span></span><span class=line><span class=cl>nohup udptunnel -s <span class=m>443</span> 127.0.0.1/51820 &gt; /var/log/udptunnel.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># تكوين الاستمرارية (خدمة systemd)</span>
</span></span><span class=line><span class=cl>sudo tee /etc/systemd/system/udptunnel.service &gt; /dev/null <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>[Unit]
</span></span></span><span class=line><span class=cl><span class=s>Description=UDP Tunnel for WireGuard
</span></span></span><span class=line><span class=cl><span class=s>After=network.target
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Service]
</span></span></span><span class=line><span class=cl><span class=s>ExecStart=/usr/bin/udptunnel -s 443 127.0.0.1/51820
</span></span></span><span class=line><span class=cl><span class=s>Restart=always
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[Install]
</span></span></span><span class=line><span class=cl><span class=s>WantedBy=multi-user.target
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> --now udptunnel.service
</span></span></code></pre></div><h4 id=تكوين-العميل-1>تكوين العميل</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># عميل Linux</span>
</span></span><span class=line><span class=cl>sudo apt install udptunnel
</span></span><span class=line><span class=cl>sudo udptunnel -c &lt;server_ip&gt; <span class=m>443</span> 127.0.0.1/51830
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># تعديل تكوين WireGuard:</span>
</span></span><span class=line><span class=cl><span class=c1># Endpoint = 127.0.0.1:51830</span>
</span></span></code></pre></div><blockquote><p>اختبار الأداء: التغليف بـ TCP يؤدي إلى انخفاض الإنتاجية بنسبة 25% تقريباً، وزيادة التأخير 15-20 مللي ثانية</p></blockquote><h3 id=الحل-الثاني-الاستماع-على-منافذ-متعددة--تبديل-ديناميكي-الحل-الموصى-به>الحل الثاني: الاستماع على منافذ متعددة + تبديل ديناميكي (الحل الموصى به)</h3><h4 id=تكوين-الخادم-توجيه-nat-بـ-iptables>تكوين الخادم (توجيه NAT بـ iptables)</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># السماح بنطاق المنافذ</span>
</span></span><span class=line><span class=cl>sudo ufw allow 51000:52000/udp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># تكوين توجيه NAT</span>
</span></span><span class=line><span class=cl>sudo iptables -t nat -A PREROUTING -i eth0 -p udp -m multiport --dports 51000:52000 -j REDIRECT --to-port <span class=m>51820</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># حفظ القواعد بشكل دائم</span>
</span></span><span class=line><span class=cl>sudo apt install iptables-persistent
</span></span><span class=line><span class=cl>sudo netfilter-persistent save
</span></span></code></pre></div><h4 id=سكريبت-تبديل-المنافذ-الذكي-للعميل>سكريبت تبديل المنافذ الذكي للعميل</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># حفظ كـ wg-port-rotator.ps1</span>
</span></span><span class=line><span class=cl><span class=k>param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$RangeStart</span> <span class=p>=</span> <span class=mf>51000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$RangeEnd</span> <span class=p>=</span> <span class=mf>52000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$ChangeInterval</span> <span class=p>=</span> <span class=mf>300</span>  <span class=c># تبديل كل 5 دقائق افتراضياً</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># كشف مسار WireGuard تلقائياً</span>
</span></span><span class=line><span class=cl><span class=nv>$wgPath</span> <span class=p>=</span> <span class=k>if</span> <span class=p>(</span><span class=nv>$IsWindows</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;</span><span class=nv>${env:ProgramFiles}</span><span class=s2>\WireGuard\wg.exe&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;/usr/bin/wg&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=p>(</span><span class=nb>Test-Path</span> <span class=nv>$wgPath</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;[ERROR] WireGuard غير مثبت أو مسار غير صحيح&#34;</span> <span class=n>-ForegroundColor</span> <span class=n>Red</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># الحصول على الواجهة النشطة</span>
</span></span><span class=line><span class=cl><span class=nv>$interface</span> <span class=p>=</span> <span class=p>&amp;</span> <span class=nv>$wgPath</span> <span class=n>show</span> <span class=n>interfaces</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=nv>$interface</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;[ERROR] لم يتم العثور على واجهة WireGuard نشطة&#34;</span> <span class=n>-ForegroundColor</span> <span class=n>Red</span>
</span></span><span class=line><span class=cl>    <span class=n>exit</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># الحلقة الرئيسية</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=p>(</span><span class=vm>$true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$peer</span> <span class=p>=</span> <span class=p>&amp;</span> <span class=nv>$wgPath</span> <span class=n>show</span> <span class=nv>$interface</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>            <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span> <span class=o>-match</span> <span class=s1>&#39;peer: &#39;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>            <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>-not</span> <span class=nv>$peer</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=s2>&#34;[ERROR] لم يتم العثور على عقدة مقابلة&#34;</span> <span class=n>-ForegroundColor</span> <span class=n>Red</span>
</span></span><span class=line><span class=cl>        <span class=n>exit</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$peerKey</span> <span class=p>=</span> <span class=nv>$peer</span><span class=p>.</span><span class=py>Split</span><span class=p>()[</span><span class=mf>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=nv>$currentEndpoint</span> <span class=p>=</span> <span class=p>&amp;</span> <span class=nv>$wgPath</span> <span class=n>show</span> <span class=nv>$interface</span> <span class=n>endpoints</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>                      <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span> <span class=o>-match</span> <span class=nv>$peerKey</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>                      <span class=nb>ForEach-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Split</span><span class=p>()[</span><span class=mf>2</span><span class=p>]</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$currentPort</span> <span class=p>=</span> <span class=k>if</span> <span class=p>(</span><span class=nv>$currentEndpoint</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$currentEndpoint</span><span class=p>.</span><span class=py>Split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>)[</span><span class=mf>-1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$RangeStart</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># توليد منفذ عشوائي (استثناء المنفذ الحالي)</span>
</span></span><span class=line><span class=cl>    <span class=nv>$newPort</span> <span class=p>=</span> <span class=nb>Get-Random</span> <span class=n>-Minimum</span> <span class=nv>$RangeStart</span> <span class=n>-Maximum</span> <span class=p>(</span><span class=nv>$RangeEnd</span> <span class=p>+</span> <span class=mf>1</span><span class=p>)</span> <span class=n>-Exclude</span> <span class=nv>$currentPort</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># تحديث النقطة النهائية</span>
</span></span><span class=line><span class=cl>    <span class=p>&amp;</span> <span class=nv>$wgPath</span> <span class=nb>set </span><span class=nv>$interface</span> <span class=n>peer</span> <span class=nv>$peerKey</span> <span class=n>endpoint</span> <span class=s2>&#34;${currentEndpoint.Split(&#39;:&#39;)[0]}:</span><span class=nv>$newPort</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># عرض حالة الاتصال</span>
</span></span><span class=line><span class=cl>    <span class=p>&amp;</span> <span class=nv>$wgPath</span> <span class=n>show</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># الانتظار للتبديل التالي</span>
</span></span><span class=line><span class=cl>    <span class=nb>Start-Sleep</span> <span class=n>-Seconds</span> <span class=nv>$ChangeInterval</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>تعليمات الاستخدام:</strong></p><ol><li>Windows: إنشاء مهمة مجدولة كل 5 دقائق</li><li>Linux: تكوين مؤقت systemd أو مهمة cron</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># تنفيذ كل 5 دقائق</span>
</span></span><span class=line><span class=cl>*/5 * * * * /usr/bin/pwsh -File /path/to/wg-port-rotator.ps1
</span></span></code></pre></div><h3 id=الحل-الثالث-انتحال-المنافذ-المتقدم-نفق-icmpudp>الحل الثالث: انتحال المنافذ المتقدم (نفق ICMP/UDP)</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># استخدام icmptunnel لإنشاء نفق ICMP</span>
</span></span><span class=line><span class=cl>sudo apt install icmptunnel
</span></span><span class=line><span class=cl>sudo sysctl -w net.ipv4.icmp_echo_ignore_all<span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># الخادم</span>
</span></span><span class=line><span class=cl>sudo icmptunnel -s -d 192.168.3.1
</span></span><span class=line><span class=cl><span class=c1># العميل</span>
</span></span><span class=line><span class=cl>sudo icmptunnel -c &lt;server_ip&gt; -d 192.168.3.2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ثم تشغيل WireGuard على واجهة النفق</span>
</span></span></code></pre></div><h2 id=اقتراحات-تحسين-الأداء>اقتراحات تحسين الأداء</h2><ol><li><strong>تعديل MTU</strong>:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=c1># wg0.conf</span>
</span></span><span class=line><span class=cl><span class=k>[Interface]</span>
</span></span><span class=line><span class=cl><span class=na>MTU</span> <span class=o>=</span> <span class=s>1280  # مناسب لسيناريوهات التغليف</span>
</span></span></code></pre></div><ol start=2><li><strong>التشفير متعدد الخيوط</strong>:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install wireguard-dkms
</span></span><span class=line><span class=cl>sudo modprobe wireguard <span class=nv>num_cpus</span><span class=o>=</span><span class=m>4</span>
</span></span></code></pre></div><ol start=3><li><strong>تحسين معلمات النواة</strong>:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/sysctl.conf</span>
</span></span><span class=line><span class=cl>net.core.rmem_max <span class=o>=</span> <span class=m>2500000</span>
</span></span><span class=line><span class=cl>net.core.wmem_max <span class=o>=</span> <span class=m>2500000</span>
</span></span><span class=line><span class=cl>net.ipv4.udp_rmem_min <span class=o>=</span> <span class=m>8192</span>
</span></span><span class=line><span class=cl>net.ipv4.udp_wmem_min <span class=o>=</span> <span class=m>8192</span>
</span></span></code></pre></div><h2 id=الخاتمة-والاقتراحات>الخاتمة والاقتراحات</h2><ol><li><strong>الاستخدام العادي</strong>: حل الاستماع على منافذ متعددة + التبديل الديناميكي يقدم أفضل أداء شامل</li><li><strong>بيئة الإغلاق الصارمة</strong>: حل التغليف بـ TCP أو نفق ICMP</li><li><strong>الشبكات المتنقلة</strong>: يُوصى باستخدام تبديل المنافذ الديناميكي + تقليل فترة التبديل (2-3 دقائق)</li><li><strong>التطبيقات المؤسسية</strong>: النظر في دمج حلول متعددة لتحقيق إرباك الحركة</li></ol><h2 id=المراجع>المراجع</h2><ol><li><a href=https://www.wireguard.com/>وثائق WireGuard الرسمية</a></li><li><a href=https://datatracker.ietf.org/doc/html/rfc2475>ورقة بيضاء حول تقنيات QoS لمزودي الخدمة</a></li><li><a href=https://dl.acm.org/doi/10.1145/3452296.3472926>دراسة أداء أنفاق UDP - ACM SIGCOMM</a></li><li><a href=https://ieeexplore.ieee.org/document/9141311>نظرة عامة على تقنيات انتحال حركة الشبكة</a></li></ol><br><script src=https://giscus.app/client.js data-repo=jqknono/blog data-repo-id=R_kgDONOhENQ data-category=Announcements data-category-id=DIC_kwDONOhENc4CkQDB data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script><br><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/ar-ae/blog/2024/05/20/%D8%AA%D9%82%D8%B1%D9%8A%D8%B1-%D8%B9%D8%B6%D9%88-%D8%AC%D8%AF%D9%8A%D8%AF-%D9%81%D9%8A%E5%B0%91%E6%95%B0%E6%B4%BE/ aria-label="السابق - تقرير عضو جديد في少数派" class="btn btn-primary"><span class=me-1>←</span>السابق</a></li><li><a href=/ar-ae/blog/2024/05/27/%D8%AA%D8%AB%D8%A8%D9%8A%D8%AA-%D9%88%D8%AA%D9%81%D8%B9%D9%8A%D9%84-%D9%86%D8%B8%D8%A7%D9%85-windows/ aria-label="التالي - تثبيت وتفعيل نظام Windows" class="btn btn-primary">التالي<span class=ms-1>→</span></a></li></ul></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/jqknono aria-label="User mailing list"><i class=envelope></i></a></li></ul></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/jqknono aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title="User mailing list" aria-label="User mailing list"><a target=_blank rel=noopener href=https://groups.google.com/forum/#!forum/jqknono aria-label="User mailing list"><i class=envelope></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2015&ndash;2025
<span class=td-footer__authors>jqknono</span></span><span class=td-footer__all_rights_reserved>جميع الحقوق محفوظة</span></div></div></div></footer></div><script src=/js/main.min.d20e761d6aa4d2ace0488e45da0e775a8b17300a8430f32fbcfa016e6c9e6eb6.js integrity="sha256-0g52HWqk0qzgSI5F2g53WosXMAqEMPMvvPoBbmyebrY=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>