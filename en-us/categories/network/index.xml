<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Network on Nono Blogs</title><link>https://blog.jqknono.com/en-us/categories/network/</link><description>Recent content in Network on Nono Blogs</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Thu, 09 Oct 2025 13:16:16 +0800</lastBuildDate><atom:link href="https://blog.jqknono.com/en-us/categories/network/index.xml" rel="self" type="application/rss+xml"/><item><title>Comparison of DNS Encryption Protocols: DoT, DoH, DoQ</title><link>https://blog.jqknono.com/en-us/blog/2025/10/09/comparison-of-dns-encryption-protocols-dot-doh-doq/</link><pubDate>Thu, 09 Oct 2025 13:16:16 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2025/10/09/comparison-of-dns-encryption-protocols-dot-doh-doq/</guid><description>&lt;h2 id="quick-glossary"&gt;Quick Glossary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS: Cleartext DNS, typically uses UDP/53, switching to TCP/53 when necessary (e.g., for truncated responses, zone transfers).&lt;/li&gt;
&lt;li&gt;DoT: DNS over TLS, uses TCP over TLS, default port 853 (RFC 7858/8310).&lt;/li&gt;
&lt;li&gt;DoH: DNS over HTTPS, based on HTTPS (HTTP/2 or HTTP/3), default port 443 (RFC 8484).&lt;/li&gt;
&lt;li&gt;DoQ: DNS over QUIC, based on QUIC + TLS 1.3, default port UDP/853 (RFC 9250, IANA assigned to 853/udp).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="layered-relationship-simplified-tcpip-model"&gt;Layered Relationship (Simplified TCP/IP Model)&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Application Layer: HTTP, HTTPS, DNS (DoH is encapsulated within the HTTPS application layer)&lt;/li&gt;
&lt;li&gt;Security Layer: TLS (provides encryption for TCP or QUIC)&lt;/li&gt;
&lt;li&gt;Transport Layer: TCP, UDP, QUIC&lt;/li&gt;
&lt;li&gt;Network Layer: IP&lt;/li&gt;
&lt;li&gt;Link Layer: Ethernet, etc.&lt;/li&gt;
&lt;li&gt;Physical Layer: Twisted pair/Fiber optic/Wireless, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="key-points"&gt;Key Points&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS operates over UDP/TCP, unencrypted.&lt;/li&gt;
&lt;li&gt;DoT = TCP + TLS + DNS (dedicated port 853).&lt;/li&gt;
&lt;li&gt;DoH = TCP/QUIC + TLS + HTTP(S) + DNS (uses port 443, shared with regular HTTPS).&lt;/li&gt;
&lt;li&gt;DoQ = QUIC + TLS 1.3 + DNS (dedicated port UDP/853).&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TB
 subgraph Application Layer
 A[HTTP]
 A2[HTTPS]
 C[DNS]
 D[DoH DNS over HTTPS]
 end

 subgraph Security Layer
 E[TLS]
 end

 subgraph Transport Layer
 F[TCP]
 G[UDP]
 H[QUIC]
 end

 subgraph Network Layer
 I[IP]
 end

 subgraph Link Layer
 J[Ethernet]
 end

 subgraph Physical Layer
 K[Twisted Pair/Fiber/Wireless]
 end

 A2 --&amp;gt; F
 A2 --&amp;gt; H
 A --&amp;gt; F
 C --&amp;gt; F
 C --&amp;gt; G
 D --&amp;gt; A2
 E --&amp;gt; F
 E --&amp;gt; H
 F --&amp;gt; I
 G --&amp;gt; I
 H --&amp;gt; I
 I --&amp;gt; J
 J --&amp;gt; K

 style D fill:#e1f5fe
 style E fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="basics-and-corrections"&gt;Basics and Corrections&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Plain DNS defaults to UDP/53, switching to TCP/53 for truncated responses (TC bit) or when reliable transport is needed.&lt;/li&gt;
&lt;li&gt;DoT establishes a TLS tunnel over TCP to transmit DNS messages, default port 853; long-lived connections can be reused to reduce handshake overhead.&lt;/li&gt;
&lt;li&gt;DoH treats DNS as a resource within HTTPS (&lt;code&gt;application/dns-message&lt;/code&gt;), typically using HTTP/2 or HTTP/3, port 443, easily mixed with regular HTTPS traffic.&lt;/li&gt;
&lt;li&gt;DoQ directly uses QUIC (based on UDP) to carry DNS, offering low latency and head-of-line blocking avoidance, but ecosystem adoption is still growing.&lt;/li&gt;
&lt;li&gt;Broad statements like &amp;ldquo;QUIC is always X% faster than TCP&amp;rdquo; are inaccurate; actual performance depends on network conditions (packet loss, jitter, RTT), connection reuse capabilities, implementation details, and server deployment.&lt;/li&gt;
&lt;li&gt;DoH is not inherently &amp;ldquo;slower/faster just because DNS is placed in HTTP&amp;rdquo;; performance depends on connection reuse, network quality, and implementation; in many cases, DoH/3 performance is comparable to or even better than DoT.&lt;/li&gt;
&lt;li&gt;DoT can use SNI for certificate hostname verification; DoH relies on standard HTTPS certificate validation and hostname matching.&lt;/li&gt;
&lt;li&gt;Encrypted DNS only prevents eavesdropping and tampering on the link; it does not equal &amp;ldquo;complete anonymity.&amp;rdquo; The resolver may still log queries; choose a trustworthy provider and review their privacy policy.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="mermaid"&gt;graph TD
 subgraph DNS Family
 A[Plain DNS UDP/TCP &amp;#43; DNS]

 subgraph Encrypted DNS
 B[DoT TCP &amp;#43; TLS &amp;#43; DNS]
 C[DoH HTTP/2,3 &amp;#43; TLS &amp;#43; DNS]
 D[DoQ QUIC &amp;#43; TLS 1.3 &amp;#43; DNS]
 end

 subgraph Transport Base
 E[TCP]
 F[UDP]
 G[QUIC]
 end
 end

 A --&amp;gt; B
 A --&amp;gt; C
 A --&amp;gt; D

 B --&amp;gt; E
 C --&amp;gt; E
 C --&amp;gt; G
 D --&amp;gt; G
 A --&amp;gt; F

 style A fill:#f3e5f5
 style B fill:#e8f5e8
 style C fill:#e3f2fd
 style D fill:#fff3e0&lt;/pre&gt;
&lt;h2 id="comparison-overview"&gt;Comparison Overview&lt;/h2&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Protocol&lt;/th&gt;
 &lt;th&gt;Transport Layer&lt;/th&gt;
 &lt;th&gt;Encryption&lt;/th&gt;
 &lt;th&gt;Encapsulation&lt;/th&gt;
 &lt;th&gt;Default Port&lt;/th&gt;
 &lt;th&gt;Typical Characteristics&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Plain DNS&lt;/td&gt;
 &lt;td&gt;UDP/TCP&lt;/td&gt;
 &lt;td&gt;None&lt;/td&gt;
 &lt;td&gt;Native DNS&lt;/td&gt;
 &lt;td&gt;53&lt;/td&gt;
 &lt;td&gt;Simple, efficient, plaintext visible, easily tampered/monitored&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoT&lt;/td&gt;
 &lt;td&gt;TCP&lt;/td&gt;
 &lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
 &lt;td&gt;DNS&lt;/td&gt;
 &lt;td&gt;853&lt;/td&gt;
 &lt;td&gt;Dedicated port, easily blocked by port, good system-level support&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoH&lt;/td&gt;
 &lt;td&gt;TCP/QUIC&lt;/td&gt;
 &lt;td&gt;TLS 1.2/1.3&lt;/td&gt;
 &lt;td&gt;HTTP/2-3 + DNS&lt;/td&gt;
 &lt;td&gt;443&lt;/td&gt;
 &lt;td&gt;Shares port with HTTPS, strong penetration, browser priority support&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;DoQ&lt;/td&gt;
 &lt;td&gt;QUIC&lt;/td&gt;
 &lt;td&gt;TLS 1.3&lt;/td&gt;
 &lt;td&gt;DNS&lt;/td&gt;
 &lt;td&gt;853/UDP&lt;/td&gt;
 &lt;td&gt;Low latency, avoids head-of-line blocking, ecosystem developing&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="performance-and-latency"&gt;Performance and Latency&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Connection Reuse: DoT/DoH/DoQ can all reuse long-lived connections to reduce handshake costs; DoH/2, DoH/3, and DoQ can also multiplex requests within a single connection.&lt;/li&gt;
&lt;li&gt;Head-of-Line Blocking: TCP suffers from application-layer head-of-line blocking; HTTP/2 mitigates this over TCP with multiplexing but is still affected by TCP packet loss. QUIC (DoH/3, DoQ) avoids head-of-line blocking at the transport layer, making it more friendly to high packet loss/mobile networks.&lt;/li&gt;
&lt;li&gt;First Packet Latency: On initial connection, DoT requires TCP+TLS handshake; DoH/2 is similar; DoH/3/DoQ, based on QUIC, offer faster reconnection and migration. Under sustained load, differences depend more on implementation and network conditions.&lt;/li&gt;
&lt;li&gt;Reachability: DoH uses port 443, least likely to be blocked by simple port filtering; DoT uses port 853, often subject to indiscriminate blocking; DoQ uses UDP/853, which may currently be blocked or not permitted.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="client-and-system-support"&gt;Client and System Support&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Browsers: Chromium family and Firefox have built-in DoH by default (can automatically upgrade to DoH-capable resolvers or use built-in provider lists).&lt;/li&gt;
&lt;li&gt;Windows: Windows 11 has native DoH support.&lt;/li&gt;
&lt;li&gt;Android: Android 9+ provides &amp;ldquo;Private DNS&amp;rdquo; (system-level DoT). System-level DoH support depends on version/manufacturer.&lt;/li&gt;
&lt;li&gt;Apple Platforms: iOS 14+/macOS 11+ support DoT and DoH via configuration profiles or NetworkExtension.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="deployment-and-selection-recommendations"&gt;Deployment and Selection Recommendations&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;General/Restricted Networks (e.g., public Wi-Fi, need to bypass simple blocking): Prioritize DoH (port 443), enable HTTP/3 if available.&lt;/li&gt;
&lt;li&gt;System-Wide Outbound (router, gateway, Android Private DNS): Prioritize DoT (853), optionally configure DoH as a fallback if the network allows.&lt;/li&gt;
&lt;li&gt;High Packet Loss/Mobile Networks: Prioritize DoH/3 with QUIC or DoQ (depending on resolver and client support).&lt;/li&gt;
&lt;li&gt;Enterprise/Compliance Scenarios: Choose based on policy (DoH can integrate with existing HTTPS infrastructure; DoT facilitates separation from DNS control plane).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="summary"&gt;Summary&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;First choice: DoH (port 443, strong penetration), enable HTTP/3 if available.&lt;/li&gt;
&lt;li&gt;If system-wide unification is needed: Prioritize DoT (853) + persistent connections, fall back to DoH (443) if necessary.&lt;/li&gt;
&lt;li&gt;If your resolver and clients both support it: Try DoQ (often provides better mobile network experience).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="reference-standards"&gt;Reference Standards&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RFC 7858, RFC 8310 (DNS over TLS)&lt;/li&gt;
&lt;li&gt;RFC 8484 (DNS over HTTPS)&lt;/li&gt;
&lt;li&gt;RFC 9250 (DNS over QUIC)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="recommended-dns-services"&gt;Recommended DNS Services&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;NullPrivate DNS: &lt;a href="https://www.nullprivate.com"&gt;https://www.nullprivate.com&lt;/a&gt; supports DoT, DoH (supports HTTP3), natively supports ad-blocking and traffic splitting.&lt;/li&gt;
&lt;li&gt;Self-hosted version: &lt;a href="https://github.com/NullPrivate/NullPrivate"&gt;https://github.com/NullPrivate/NullPrivate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>WSL Mirrored Network Mode Configuration Guide</title><link>https://blog.jqknono.com/en-us/blog/2025/06/25/wsl-mirrored-network-mode-configuration-guide/</link><pubDate>Wed, 25 Jun 2025 19:09:29 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2025/06/25/wsl-mirrored-network-mode-configuration-guide/</guid><description>&lt;h2 id="version-requirements"&gt;Version Requirements&lt;/h2&gt;
&lt;p&gt;Current version status:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Latest stable: 2.5.9 (known networking issues)&lt;/li&gt;
&lt;li&gt;Recommended version: 2.6.0 preview (full mirrored mode support)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="mode-comparison-analysis"&gt;Mode Comparison Analysis&lt;/h2&gt;
&lt;table&gt;
 &lt;thead&gt;
 &lt;tr&gt;
 &lt;th&gt;Feature&lt;/th&gt;
 &lt;th&gt;bridge mode (deprecated)&lt;/th&gt;
 &lt;th&gt;mirrored mode (recommended)&lt;/th&gt;
 &lt;/tr&gt;
 &lt;/thead&gt;
 &lt;tbody&gt;
 &lt;tr&gt;
 &lt;td&gt;Protocol architecture&lt;/td&gt;
 &lt;td&gt;Dual-stack&lt;/td&gt;
 &lt;td&gt;Shared stack&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;IP address allocation&lt;/td&gt;
 &lt;td&gt;Independent IP (Windows + WSL)&lt;/td&gt;
 &lt;td&gt;Shared host IP&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Port resources&lt;/td&gt;
 &lt;td&gt;Separate&lt;/td&gt;
 &lt;td&gt;Shared ports (conflict-avoidance required)&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Network performance&lt;/td&gt;
 &lt;td&gt;Relatively heavy&lt;/td&gt;
 &lt;td&gt;Lightweight &amp;amp; efficient&lt;/td&gt;
 &lt;/tr&gt;
 &lt;tr&gt;
 &lt;td&gt;Configuration complexity&lt;/td&gt;
 &lt;td&gt;Simple&lt;/td&gt;
 &lt;td&gt;Requires deep firewall policy setup&lt;/td&gt;
 &lt;/tr&gt;
 &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="standard-configuration-steps"&gt;Standard Configuration Steps&lt;/h2&gt;
&lt;h3 id="1-network-mode-settings"&gt;1. Network Mode Settings&lt;/h3&gt;
&lt;p&gt;Configure the base mode via &lt;strong&gt;WSL Settings&lt;/strong&gt; app:&lt;/p&gt;</description></item><item><title>Getting Started with DNS: The Internet's Address Book</title><link>https://blog.jqknono.com/en-us/docs/private-service/dns/</link><pubDate>Sat, 24 May 2025 20:04:34 +0800</pubDate><guid>https://blog.jqknono.com/en-us/docs/private-service/dns/</guid><description>&lt;h2 id="what-is-dns"&gt;What is DNS?&lt;/h2&gt;
&lt;p&gt;Welcome to our DNS series! Before diving into the technical details, let’s start with a simple question: What is DNS?&lt;/p&gt;
&lt;p&gt;Imagine your phone’s contact list. You don’t need to memorize every friend’s phone number—just their names. When you want to call “Zhang San,” you find the name in your contacts and tap to dial. Your phone automatically looks up Zhang San’s phone number and places the call.&lt;/p&gt;</description></item><item><title>Using Common DDNS Subdomains May Cause China Telecom Broadband Service Degradation</title><link>https://blog.jqknono.com/en-us/blog/2025/02/19/using-common-ddns-subdomains-may-cause-china-telecom-broadband-service-degradation/</link><pubDate>Wed, 19 Feb 2025 13:06:08 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2025/02/19/using-common-ddns-subdomains-may-cause-china-telecom-broadband-service-degradation/</guid><description>&lt;p&gt;I have been troubleshooting IPv6 disconnections and hole-punching failures for over three months. I’ve finally identified the root cause; here’s the story.&lt;/p&gt;
&lt;h2 id="my-first-post-asking-for-helpipv6-disconnections"&gt;My First Post Asking for Help—IPv6 Disconnections&lt;/h2&gt;
&lt;!-- https://www.v2ex.com/t/1088217 --&gt;
&lt;p&gt;IPv6 had been working perfectly. Without touching any settings, and even though every device had its own IPv6, it suddenly lost IPv6 connectivity entirely.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;curl 6.ipw.cn&lt;/code&gt; returned nothing, and both &lt;code&gt;ping6&lt;/code&gt; and &lt;code&gt;traceroute6 2400:3200::1&lt;/code&gt; failed.&lt;/p&gt;
&lt;p&gt;My ONT was bridged to the router, and I could still obtain the router’s own IPv6—one that could still reach the IPv6 Internet.&lt;/p&gt;</description></item><item><title>Compliance Discussion of Reverse Proxy in Home Networks</title><link>https://blog.jqknono.com/en-us/blog/2025/02/17/compliance-discussion-of-reverse-proxy-in-home-networks/</link><pubDate>Mon, 17 Feb 2025 15:04:23 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2025/02/17/compliance-discussion-of-reverse-proxy-in-home-networks/</guid><description>&lt;h1 id="background"&gt;Background&lt;/h1&gt;
&lt;p&gt;About 90 days ago, I encountered an IPv6 connectivity issue with China Telecom Hubei. After long-term observation and analysis, here are the findings.&lt;/p&gt;
&lt;h1 id="problem-analysis"&gt;Problem Analysis&lt;/h1&gt;
&lt;p&gt;Two initial suspected causes:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;PCDN usage detection&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;No active use of PCDN&lt;/li&gt;
&lt;li&gt;Only a small amount of BitTorrent downloads&lt;/li&gt;
&lt;li&gt;Upload throttling has been applied, yet the problem persists&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Home server acting as blog origin&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Uses Cloudflare origin rules specifying a port&lt;/li&gt;
&lt;li&gt;May be deemed “commercial behavior” by the ISP&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;After three months of validation, the issue is more likely triggered by exposing HTTP/HTTPS service ports to the public Internet.&lt;/p&gt;</description></item><item><title>How a vendor bypasses DNS blocking</title><link>https://blog.jqknono.com/en-us/blog/2024/12/13/how-a-vendor-bypasses-dns-blocking/</link><pubDate>Fri, 13 Dec 2024 17:19:36 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/12/13/how-a-vendor-bypasses-dns-blocking/</guid><description>&lt;p&gt;Recently I noticed that the DNS public service IP is receiving abnormal traffic—tens of identical requests for the same domain every second, completely ignoring the DNS protocol and the global TTL value.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://img1.techfetch.dev/blog/202412131719062.png" alt="Rapid repeated queries"&gt;&lt;/p&gt;
&lt;!-- `api-access.pangolin-sdk-toutiao-b.com` --&gt;
&lt;p&gt;At first I thought the IP belonged to an attacker, but inspecting the flows revealed it was simply a certain vendor’s App frantically querying DNS. The backend sets &lt;code&gt;TTL=10&lt;/code&gt;, meaning any client that has just received the DNS response should cache it for ten seconds instead of re-querying the DNS server. Yet the App pounds the server with dozens of identical requests every second, proving it never honors the TTL. In our blocking statistics, more than 90 % of intercepted requests are for this single domain.&lt;/p&gt;</description></item><item><title>Network</title><link>https://blog.jqknono.com/en-us/blog/programmer/network/</link><pubDate>Wed, 13 Nov 2024 13:05:00 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/programmer/network/</guid><description>&lt;ul&gt;
&lt;li&gt;&lt;input disabled="" type="checkbox"&gt; Network&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="network"&gt;Network&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Bypass firewall
&lt;ul&gt;
&lt;li&gt;[&lt;a href="wireguard%E5%AF%B9%E6%8A%97%E8%BF%90%E8%90%A5%E5%95%86" title="wireguard对抗运营商"&gt;wireguard对抗运营商&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Network troubleshooting
&lt;ul&gt;
&lt;li&gt;[&lt;a href="linux%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D" title="linux网络问题定位"&gt;linux网络问题定位&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;[&lt;a href="windows%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%AE%9A%E4%BD%8D" title="windows网络问题定位"&gt;windows网络问题定位&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>DoT vs DoH vs DoQ</title><link>https://blog.jqknono.com/en-us/docs/private-service/dns/dot-vs-doh-vs-doq/</link><pubDate>Wed, 13 Nov 2024 11:35:36 +0800</pubDate><guid>https://blog.jqknono.com/en-us/docs/private-service/dns/dot-vs-doh-vs-doq/</guid><description>&lt;h2 id="dot"&gt;DoT&lt;/h2&gt;
&lt;p&gt;DNS over TLS (DoT) is a DNS encryption protocol based on TLS. TLS 1.2 requires at least four round-trips, TLS 1.3 requires at least three round-trips, while DNS requests only need one round-trip.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Timeline
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ↓
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ┌───────────────────────────────────────────────────────────────────────┐
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client Server
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends SYN segment │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ SYN = 1, Seq = x │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server responds with SYN-ACK segment │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ SYN = 1, ACK = 1, Seq = y, Ack = x + 1 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends ACK segment │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ACK = 1, Seq = x + 1, Ack = y + 1 │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ TCP connection established │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends ClientHello │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server responds with ServerHello │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server sends certificate chain │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends key exchange message │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server sends key exchange message │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends Finished │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server sends Finished │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ TLS handshake completed │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Client sends DNS query │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ────────────────────────────────────────────────────────────────────▶│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ ←─────────────────────────────────────────────────────────────────────│
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ Server responds with DNS query │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; │ │
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; └───────────────────────────────────────────────────────────────────────┘
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;TLS 1.2 handshake requires at least two round-trip times (RTT): client sends ClientHello, server replies with ServerHello and certificates, then client sends ClientKeyExchange and ChangeCipherSpec, finally server sends Finished. TLS 1.3 simplifies the handshake to one round-trip (1-RTT). When sending ClientHello, client can include key share information (ClientKeyShare), server also includes key share information in ServerHello response, completing key negotiation and handshake within the first round-trip.&lt;/p&gt;</description></item><item><title>Fastest DNS</title><link>https://blog.jqknono.com/en-us/docs/private-service/dns/fastest-dns/</link><pubDate>Sun, 10 Nov 2024 19:12:42 +0800</pubDate><guid>https://blog.jqknono.com/en-us/docs/private-service/dns/fastest-dns/</guid><description>&lt;p&gt;Ordinary users typically measure ping response speed of plaintext DNS IP addresses, but this rarely reflects actual server connection performance. Modern DNS requires encrypted DNS protocols to ensure service integrity against hijacking.&lt;/p&gt;
&lt;p&gt;From client to destination, traffic usually passes through 5-8 network devices. Any of these can hijack UDP:53 requests through simple commands. Never rely on plaintext DNS, especially in enterprise environments where hijacking is nearly inevitable.&lt;/p&gt;
&lt;p&gt;Example hijacking command:
&lt;code&gt;sudo iptables -t nat -A PREROUTING -p udp --dport 53 -j DNAT --to-destination 1.1.1.1:53&lt;/code&gt;&lt;/p&gt;</description></item><item><title>IPv6 Disconnect Issue on Long-Running Windows Server 2019</title><link>https://blog.jqknono.com/en-us/blog/2024/11/06/ipv6-disconnect-issue-on-long-running-windows-server-2019/</link><pubDate>Wed, 06 Nov 2024 10:56:27 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/11/06/ipv6-disconnect-issue-on-long-running-windows-server-2019/</guid><description>&lt;p&gt;My Windows Server 2019 rarely shuts down; under a China Telecom/Redmi router, every time IPv6 is renewed, the local IPv6 connection shows “No Internet access.” Rebooting the machine or toggling the IPv6 feature fixes it, while Linux doesn’t exhibit this problem.&lt;/p&gt;
&lt;p&gt;&lt;img src="https://img1.techfetch.dev/blog/20241106115547.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;To automate the fix, I use these two commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-ps1" data-lang="ps1"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;Set-NetIPInterface&lt;/span&gt; &lt;span class="n"&gt;-AddressFamily&lt;/span&gt; &lt;span class="n"&gt;IPv6&lt;/span&gt; &lt;span class="n"&gt;-ifAlias&lt;/span&gt; &lt;span class="n"&gt;Ethernet&lt;/span&gt; &lt;span class="n"&gt;-RouterDiscovery&lt;/span&gt; &lt;span class="n"&gt;Disabled&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;Set-NetIPInterface&lt;/span&gt; &lt;span class="n"&gt;-AddressFamily&lt;/span&gt; &lt;span class="n"&gt;IPv6&lt;/span&gt; &lt;span class="n"&gt;-ifAlias&lt;/span&gt; &lt;span class="n"&gt;Ethernet&lt;/span&gt; &lt;span class="n"&gt;-RouterDiscovery&lt;/span&gt; &lt;span class="n"&gt;Enabled&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As you can see, the commands merely force Windows to refresh its route table; it’s unclear why Windows doesn’t do this automatically.&lt;/p&gt;</description></item><item><title>Huawei Trust Concept</title><link>https://blog.jqknono.com/en-us/blog/2024/06/28/huawei-trust-concept/</link><pubDate>Fri, 28 Jun 2024 15:49:02 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/06/28/huawei-trust-concept/</guid><description>&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;input disabled="" type="checkbox"&gt; Huawei Trust Concept&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Security: The product has strong anti-attack capabilities to safeguard the confidentiality, integrity, and availability of services and data.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Resilience: When under attack, the system maintains a defined operational state (including degraded states) and has the ability to recover quickly and evolve continuously.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Privacy: Complying with privacy protection is not only a legal and regulatory requirement but also a reflection of values. Users should be able to appropriately control how their data is used. Data usage policies should be transparent to users. Users should decide when and whether to receive information according to their needs. Privacy data must be safeguarded by robust protection capabilities and mechanisms.&lt;/p&gt;</description></item><item><title>Huawei Intranet Security Analysis</title><link>https://blog.jqknono.com/en-us/blog/2024/06/28/huawei-intranet-security-analysis/</link><pubDate>Fri, 28 Jun 2024 15:48:48 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/06/28/huawei-intranet-security-analysis/</guid><description>&lt;ul&gt;
&lt;li&gt;&lt;input disabled="" type="checkbox"&gt; Huawei Intranet Security Analysis&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Huawei has plenty of excellent internal learning materials, and I have amassed a wealth of knowledge and experience myself; I have long wondered how to import them into my personal knowledge base. I am fully aware that these generic insights are neither confidential nor sensitive, yet the ever-present warning bells of information security make me itchy while keeping well behind the red line. After some testing, I found the company’s network-security protections hard to break. This article provides a sketchy analysis of the R&amp;amp;D yellow zone.&lt;/p&gt;</description></item><item><title>Using DNS to Gracefully Switch Network Services</title><link>https://blog.jqknono.com/en-us/blog/2024/06/12/using-dns-to-gracefully-switch-network-services/</link><pubDate>Wed, 12 Jun 2024 19:00:34 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/06/12/using-dns-to-gracefully-switch-network-services/</guid><description>&lt;p&gt;Assume the service domain name is &lt;code&gt;example.domain&lt;/code&gt;, the original server IP is &lt;code&gt;A&lt;/code&gt;, and the new server IP is &lt;code&gt;B&lt;/code&gt; after migration or IP change. To keep users unaware, we can use DNS to gracefully switch network services.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Original state: &lt;code&gt;example.domain&lt;/code&gt; resolves to IP &lt;code&gt;A&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Transition state: &lt;code&gt;example.domain&lt;/code&gt; resolves to both IP &lt;code&gt;A&lt;/code&gt; and &lt;code&gt;B&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;New state: &lt;code&gt;example.domain&lt;/code&gt; resolves to IP &lt;code&gt;B&lt;/code&gt;; IP &lt;code&gt;A&lt;/code&gt; is removed.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Note: When users receive two resolved addresses, the client picks one to connect to; if that fails, it tries the others, ensuring service availability.&lt;/p&gt;</description></item><item><title>How to Improve Network Experience with a Self-Hosted DNS Service</title><link>https://blog.jqknono.com/en-us/blog/2024/05/18/how-to-improve-network-experience-with-a-self-hosted-dns-service/</link><pubDate>Sat, 18 May 2024 10:46:44 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/05/18/how-to-improve-network-experience-with-a-self-hosted-dns-service/</guid><description>&lt;h2 id="network-quality-vs-network-experience"&gt;Network Quality vs. Network Experience&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Do nothing, and you’ll already enjoy the best network experience.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;First, note that “network quality” and “network experience” are two different concepts. Communication is a process involving many devices. The upload/download performance of a &lt;strong&gt;single device&lt;/strong&gt; can be termed &lt;strong&gt;network quality&lt;/strong&gt;, while the end-to-end behavior of the entire communication path is what we call &lt;strong&gt;network experience&lt;/strong&gt;.&lt;/p&gt;
&lt;h2 id="measuring-network-quality"&gt;Measuring Network Quality&lt;/h2&gt;
&lt;p&gt;Evaluating network quality usually involves several metrics and methods. Common ones include:&lt;/p&gt;</description></item><item><title>Bypassing ChatGPT VPN Detection</title><link>https://blog.jqknono.com/en-us/blog/2024/05/09/bypassing-chatgpt-vpn-detection/</link><pubDate>Thu, 09 May 2024 10:30:29 +0800</pubDate><guid>https://blog.jqknono.com/en-us/blog/2024/05/09/bypassing-chatgpt-vpn-detection/</guid><description>&lt;p&gt;How to handle the ChatGPT error messages&lt;br&gt;
“Unable to load site”&lt;br&gt;
“Please try again later; if you are using a VPN, try turning it off.”&lt;br&gt;
“Check the status page for information on outages.”&lt;/p&gt;
&lt;h2 id="foreword"&gt;Foreword&lt;/h2&gt;
&lt;p&gt;&lt;img src="https://s2.loli.net/2024/05/09/dT4xi1mwFgYRKhq.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;ChatGPT is still the best chatbot in terms of user experience, but in mainland China its use is restricted by the network environment, so we need a proxy (literally a “ladder”) to reach it. ChatGPT is, however, quite strict in detecting proxies, and if it finds one it will simply refuse service. This article explains a way around that detection.&lt;/p&gt;</description></item></channel></rss>